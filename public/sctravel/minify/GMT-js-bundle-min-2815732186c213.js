(function(){var ai=this,ac=ai._,ae={},ar=Array.prototype,ab=Object.prototype,an=Function.prototype,aw=ar.push,ah=ar.slice,au=ar.concat,ak=ab.toString,aq=ab.hasOwnProperty,ad=ar.forEach,ag=ar.map,ao=ar.reduce,aa=ar.reduceRight,at=ar.filter,ap=ar.every,aj=ar.some,X=ar.indexOf,av=ar.lastIndexOf,Y=Array.isArray,ax=Object.keys,am=an.bind,Z=function(a){return a instanceof Z?a:this instanceof Z?(this._wrapped=a,void 0):new Z(a);};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=Z),exports._=Z):ai._=Z,Z.VERSION="1.4.4";var W=Z.each=Z.forEach=function(h,f,g){if(null!=h){if(ad&&h.forEach===ad){h.forEach(f,g);}else{if(h.length===+h.length){for(var c=0,d=h.length;d>c;c++){if(f.call(g,h[c],c,h)===ae){return;}}}else{for(var b in h){if(Z.has(h,b)&&f.call(g,h[b],b,h)===ae){return;}}}}}};Z.map=Z.collect=function(d,a,b){var c=[];return null==d?c:ag&&d.map===ag?d.map(a,b):(W(d,function(g,e,f){c[c.length]=a.call(b,g,e,f);}),c);};var H="Reduce of empty array with no initial value";Z.reduce=Z.foldl=Z.inject=function(f,b,c,d){var a=arguments.length>2;if(null==f&&(f=[]),ao&&f.reduce===ao){return d&&(b=Z.bind(b,d)),a?f.reduce(b,c):f.reduce(b);}if(W(f,function(h,g,e){a?c=b.call(d,c,h,g,e):(c=h,a=!0);}),!a){throw new TypeError(H);}return c;},Z.reduceRight=Z.foldr=function(j,f,g,h){var c=arguments.length>2;if(null==j&&(j=[]),aa&&j.reduceRight===aa){return h&&(f=Z.bind(f,h)),c?j.reduceRight(f,g):j.reduceRight(f);}var d=j.length;if(d!==+d){var b=Z.keys(j);d=b.length;}if(W(j,function(e,i,a){i=b?b[--d]:--d,c?g=f.call(h,g,j[i],i,a):(g=j[i],c=!0);}),!c){throw new TypeError(H);}return g;},Z.find=Z.detect=function(d,a,b){var c;return Q(d,function(g,e,f){return a.call(b,g,e,f)?(c=g,!0):void 0;}),c;},Z.filter=Z.select=function(d,a,b){var c=[];return null==d?c:at&&d.filter===at?d.filter(a,b):(W(d,function(g,e,f){a.call(b,g,e,f)&&(c[c.length]=g);}),c);},Z.reject=function(c,a,b){return Z.filter(c,function(g,f,d){return !a.call(b,g,f,d);},b);},Z.every=Z.all=function(d,b,c){b||(b=Z.identity);var a=!0;return null==d?a:ap&&d.every===ap?d.every(b,c):(W(d,function(g,f,e){return(a=a&&b.call(c,g,f,e))?void 0:ae;}),!!a);};var Q=Z.some=Z.any=function(d,b,c){b||(b=Z.identity);var a=!1;return null==d?a:aj&&d.some===aj?d.some(b,c):(W(d,function(g,f,e){return a||(a=b.call(c,g,f,e))?ae:void 0;}),!!a);};Z.contains=Z.include=function(b,a){return null==b?!1:X&&b.indexOf===X?b.indexOf(a)!=-1:Q(b,function(c){return c===a;});},Z.invoke=function(d,a){var b=ah.call(arguments,2),c=Z.isFunction(a);return Z.map(d,function(e){return(c?a:e[a]).apply(e,b);});},Z.pluck=function(b,a){return Z.map(b,function(c){return c[a];});},Z.where=function(c,a,b){return Z.isEmpty(a)?b?null:[]:Z[b?"find":"filter"](c,function(e){for(var d in a){if(a[d]!==e[d]){return !1;}}return !0;});},Z.findWhere=function(b,a){return Z.where(b,a,!0);},Z.max=function(d,a,b){if(!a&&Z.isArray(d)&&d[0]===+d[0]&&65535>d.length){return Math.max.apply(Math,d);}if(!a&&Z.isEmpty(d)){return -1/0;}var c={computed:-1/0,value:-1/0};return W(d,function(h,f,g){var e=a?a.call(b,h,f,g):h;e>=c.computed&&(c={value:h,computed:e});}),c.value;},Z.min=function(d,a,b){if(!a&&Z.isArray(d)&&d[0]===+d[0]&&65535>d.length){return Math.min.apply(Math,d);}if(!a&&Z.isEmpty(d)){return 1/0;}var c={computed:1/0,value:1/0};return W(d,function(h,f,g){var e=a?a.call(b,h,f,g):h;c.computed>e&&(c={value:h,computed:e});}),c.value;},Z.shuffle=function(d){var a,b=0,c=[];return W(d,function(e){a=Z.random(b++),c[b-1]=c[a],c[a]=e;}),c;};var al=function(a){return Z.isFunction(a)?a:function(b){return b[a];};};Z.sortBy=function(d,a,b){var c=al(a);return Z.pluck(Z.map(d,function(g,f,e){return{value:g,index:f,criteria:c.call(b,g,f,e)};}).sort(function(i,f){var g=i.criteria,h=f.criteria;if(g!==h){if(g>h||g===void 0){return 1;}if(h>g||h===void 0){return -1;}}return i.index<f.index?-1:1;}),"value");};var P=function(g,c,d,f){var a={},b=al(c||Z.identity);return W(g,function(h,e){var i=b.call(d,h,e,g);f(a,i,h);}),a;};Z.groupBy=function(c,a,b){return P(c,a,b,function(f,d,e){(Z.has(f,d)?f[d]:f[d]=[]).push(e);});},Z.countBy=function(c,a,b){return P(c,a,b,function(e,d){Z.has(e,d)||(e[d]=0),e[d]++;});},Z.sortedIndex=function(k,f,g,h){g=null==g?Z.identity:al(g);for(var c=g.call(h,f),d=0,b=k.length;b>d;){var j=d+b>>>1;c>g.call(h,k[j])?d=j+1:b=j;}return d;},Z.toArray=function(a){return a?Z.isArray(a)?ah.call(a):a.length===+a.length?Z.map(a,Z.identity):Z.values(a):[];},Z.size=function(a){return null==a?0:a.length===+a.length?a.length:Z.keys(a).length;},Z.first=Z.head=Z.take=function(c,a,b){return null==c?void 0:null==a||b?c[0]:ah.call(c,0,a);},Z.initial=function(c,a,b){return ah.call(c,0,c.length-(null==a||b?1:a));},Z.last=function(c,a,b){return null==c?void 0:null==a||b?c[c.length-1]:ah.call(c,Math.max(c.length-a,0));},Z.rest=Z.tail=Z.drop=function(c,a,b){return ah.call(c,null==a||b?1:a);},Z.compact=function(a){return Z.filter(a,Z.identity);};var G=function(c,a,b){return W(c,function(d){Z.isArray(d)?a?aw.apply(b,d):G(d,a,b):b.push(d);}),b;};Z.flatten=function(b,a){return G(b,a,[]);},Z.without=function(a){return Z.difference(a,ah.call(arguments,1));},Z.uniq=Z.unique=function(j,f,g,h){Z.isFunction(f)&&(h=g,g=f,f=!1);var c=g?Z.map(j,g,h):j,d=[],b=[];return W(c,function(a,i){(f?i&&b[b.length-1]===a:Z.contains(b,a))||(b.push(a),d.push(j[i]));}),d;},Z.union=function(){return Z.uniq(au.apply(ar,arguments));},Z.intersection=function(b){var a=ah.call(arguments,1);return Z.filter(Z.uniq(b),function(c){return Z.every(a,function(d){return Z.indexOf(d,c)>=0;});});},Z.difference=function(b){var a=au.apply(ar,ah.call(arguments,1));return Z.filter(b,function(c){return !Z.contains(a,c);});},Z.zip=function(){for(var d=ah.call(arguments),a=Z.max(Z.pluck(d,"length")),b=Array(a),c=0;a>c;c++){b[c]=Z.pluck(d,""+c);}return b;},Z.object=function(f,b){if(null==f){return{};}for(var c={},d=0,a=f.length;a>d;d++){b?c[f[d]]=b[d]:c[f[d][0]]=f[d][1];}return c;},Z.indexOf=function(f,b,c){if(null==f){return -1;}var d=0,a=f.length;if(c){if("number"!=typeof c){return d=Z.sortedIndex(f,b),f[d]===b?d:-1;}d=0>c?Math.max(0,a+c):c;}if(X&&f.indexOf===X){return f.indexOf(b,c);}for(;a>d;d++){if(f[d]===b){return d;}}return -1;},Z.lastIndexOf=function(f,b,c){if(null==f){return -1;}var d=null!=c;if(av&&f.lastIndexOf===av){return d?f.lastIndexOf(b,c):f.lastIndexOf(b);}for(var a=d?c:f.length;a--;){if(f[a]===b){return a;}}return -1;},Z.range=function(g,c,d){1>=arguments.length&&(c=g||0,g=0),d=arguments[2]||1;for(var f=Math.max(Math.ceil((c-g)/d),0),a=0,b=Array(f);f>a;){b[a++]=g,g+=d;}return b;},Z.bind=function(c,a){if(c.bind===am&&am){return am.apply(c,ah.call(arguments,1));}var b=ah.call(arguments,2);return function(){return c.apply(a,b.concat(ah.call(arguments)));};},Z.partial=function(b){var a=ah.call(arguments,1);return function(){return b.apply(this,a.concat(ah.call(arguments)));};},Z.bindAll=function(b){var a=ah.call(arguments,1);return 0===a.length&&(a=Z.functions(b)),W(a,function(c){b[c]=Z.bind(b[c],b);}),b;},Z.memoize=function(c,a){var b={};return a||(a=Z.identity),function(){var d=a.apply(this,arguments);return Z.has(b,d)?b[d]:b[d]=c.apply(this,arguments);};},Z.delay=function(c,a){var b=ah.call(arguments,2);return setTimeout(function(){return c.apply(null,b);},a);},Z.defer=function(a){return Z.delay.apply(Z,[a,1].concat(ah.call(arguments,1)));},Z.throttle=function(k,f){var g,h,c,d,b=0,j=function(){b=new Date,c=null,d=k.apply(g,h);};return function(){var e=new Date,a=f-(e-b);return g=this,h=arguments,0>=a?(clearTimeout(c),c=null,b=e,d=k.apply(g,h)):c||(c=setTimeout(j,a)),d;};},Z.debounce=function(f,b,c){var d,a;return function(){var g=this,e=arguments,h=function(){d=null,c||(a=f.apply(g,e));},j=c&&!d;return clearTimeout(d),d=setTimeout(h,b),j&&(a=f.apply(g,e)),a;};},Z.once=function(c){var a,b=!1;return function(){return b?a:(b=!0,a=c.apply(this,arguments),c=null,a);};},Z.wrap=function(b,a){return function(){var c=[b];return aw.apply(c,arguments),a.apply(this,c);};},Z.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;
c>=0;c--){b=[a[c].apply(this,b)];}return b[0];};},Z.after=function(b,a){return 0>=b?a():function(){return 1>--b?a.apply(this,arguments):void 0;};},Z.keys=ax||function(c){if(c!==Object(c)){throw new TypeError("Invalid object");}var a=[];for(var b in c){Z.has(c,b)&&(a[a.length]=b);}return a;},Z.values=function(c){var a=[];for(var b in c){Z.has(c,b)&&a.push(c[b]);}return a;},Z.pairs=function(c){var a=[];for(var b in c){Z.has(c,b)&&a.push([b,c[b]]);}return a;},Z.invert=function(c){var a={};for(var b in c){Z.has(c,b)&&(a[c[b]]=b);}return a;},Z.functions=Z.methods=function(c){var a=[];for(var b in c){Z.isFunction(c[b])&&a.push(b);}return a.sort();},Z.extend=function(a){return W(ah.call(arguments,1),function(b){if(b){for(var c in b){a[c]=b[c];}}}),a;},Z.pick=function(c){var a={},b=au.apply(ar,ah.call(arguments,1));return W(b,function(d){d in c&&(a[d]=c[d]);}),a;},Z.omit=function(d){var b={},c=au.apply(ar,ah.call(arguments,1));for(var a in d){Z.contains(c,a)||(b[a]=d[a]);}return b;},Z.defaults=function(a){return W(ah.call(arguments,1),function(b){if(b){for(var c in b){null==a[c]&&(a[c]=b[c]);}}}),a;},Z.clone=function(a){return Z.isObject(a)?Z.isArray(a)?a.slice():Z.extend({},a):a;},Z.tap=function(b,a){return a(b),b;};var L=function(g,q,b,k){if(g===q){return 0!==g||1/g==1/q;}if(null==g||null==q){return g===q;}g instanceof Z&&(g=g._wrapped),q instanceof Z&&(q=q._wrapped);var p=ak.call(g);if(p!=ak.call(q)){return !1;}switch(p){case"[object String]":return g==q+"";case"[object Number]":return g!=+g?q!=+q:0==g?1/g==1/q:g==+q;case"[object Date]":case"[object Boolean]":return +g==+q;case"[object RegExp]":return g.source==q.source&&g.global==q.global&&g.multiline==q.multiline&&g.ignoreCase==q.ignoreCase;}if("object"!=typeof g||"object"!=typeof q){return !1;}for(var h=b.length;h--;){if(b[h]==g){return k[h]==q;}}b.push(g),k.push(q);var m=0,d=!0;if("[object Array]"==p){if(m=g.length,d=m==q.length){for(;m--&&(d=L(g[m],q[m],b,k));){}}}else{var l=g.constructor,j=q.constructor;if(l!==j&&!(Z.isFunction(l)&&l instanceof l&&Z.isFunction(j)&&j instanceof j)){return !1;}for(var v in g){if(Z.has(g,v)&&(m++,!(d=Z.has(q,v)&&L(g[v],q[v],b,k)))){break;}}if(d){for(v in q){if(Z.has(q,v)&&!m--){break;}}d=!m;}}return b.pop(),k.pop(),d;};Z.isEqual=function(b,a){return L(b,a,[],[]);},Z.isEmpty=function(b){if(null==b){return !0;}if(Z.isArray(b)||Z.isString(b)){return 0===b.length;}for(var a in b){if(Z.has(b,a)){return !1;}}return !0;},Z.isElement=function(a){return !(!a||1!==a.nodeType);},Z.isArray=Y||function(a){return"[object Array]"==ak.call(a);},Z.isObject=function(a){return a===Object(a);},W(["Arguments","Function","String","Number","Date","RegExp"],function(a){Z["is"+a]=function(b){return ak.call(b)=="[object "+a+"]";};}),Z.isArguments(arguments)||(Z.isArguments=function(a){return !(!a||!Z.has(a,"callee"));}),"function"!=typeof/./&&(Z.isFunction=function(a){return"function"==typeof a;}),Z.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a));},Z.isNaN=function(a){return Z.isNumber(a)&&a!=+a;},Z.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"==ak.call(a);},Z.isNull=function(a){return null===a;},Z.isUndefined=function(a){return a===void 0;},Z.has=function(b,a){return aq.call(b,a);},Z.noConflict=function(){return ai._=ac,this;},Z.identity=function(a){return a;},Z.times=function(f,b,c){for(var d=Array(f),a=0;f>a;a++){d[a]=b.call(c,a);}return d;},Z.random=function(b,a){return null==a&&(a=b,b=0),b+Math.floor(Math.random()*(a-b+1));};var K={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};K.unescape=Z.invert(K.escape);var C={escape:RegExp("["+Z.keys(K.escape).join("")+"]","g"),unescape:RegExp("("+Z.keys(K.unescape).join("|")+")","g")};Z.each(["escape","unescape"],function(a){Z[a]=function(b){return null==b?"":(""+b).replace(C[a],function(c){return K[a][c];});};}),Z.result=function(c,a){if(null==c){return null;}var b=c[a];return Z.isFunction(b)?b.call(c):b;},Z.mixin=function(a){W(Z.functions(a),function(b){var c=Z[b]=a[b];Z.prototype[b]=function(){var d=[this._wrapped];return aw.apply(d,arguments),U.call(this,c.apply(Z,d));};});};var J=0;Z.uniqueId=function(b){var a=++J+"";return b?b+a:a;},Z.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var z=/(.)^/,af={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},V=/\\|'|\r|\n|\t|\u2028|\u2029/g;Z.template=function(f,m,b){var h;b=Z.defaults({},b,Z.templateSettings);var l=RegExp([(b.escape||z).source,(b.interpolate||z).source,(b.evaluate||z).source].join("|")+"|$","g"),g=0,k="__p+='";f.replace(l,function(c,i,n,a,p){return k+=f.slice(g,p).replace(V,function(e){return"\\"+af[e];}),i&&(k+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),n&&(k+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),a&&(k+="';\n"+a+"\n__p+='"),g=p+c.length,c;}),k+="';\n",b.variable||(k="with(obj||{}){\n"+k+"}\n"),k="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+k+"return __p;\n";try{h=Function(b.variable||"obj","_",k);}catch(d){throw d.source=k,d;}if(m){return h(m,Z);}var j=function(a){return h.call(this,a,Z);};return j.source="function("+(b.variable||"obj")+"){\n"+k+"}",j;},Z.chain=function(a){return Z(a).chain();};var U=function(a){return this._chain?Z(a).chain():a;};Z.mixin(Z),W(["pop","push","reverse","shift","sort","splice","unshift"],function(b){var a=ar[b];Z.prototype[b]=function(){var c=this._wrapped;return a.apply(c,arguments),"shift"!=b&&"splice"!=b||0!==c.length||delete c[0],U.call(this,c);};}),W(["concat","join","slice"],function(b){var a=ar[b];Z.prototype[b]=function(){return U.call(this,a.apply(this._wrapped,arguments));};}),Z.extend(Z.prototype,{chain:function(){return this._chain=!0,this;},value:function(){return this._wrapped;}});}).call(this);(function(){var u=this;var B=u.Backbone;var g=[];var D=g.push;var n=g.slice;var t=g.splice;var z;if(typeof exports!=="undefined"){z=exports;}else{z=u.Backbone={};}z.VERSION="1.0.0";var L=u._;if(!L&&(typeof require!=="undefined")){L=require("underscore");}z.$=u.jQuery||u.Zepto||u.ender||u.$;z.noConflict=function(){u.Backbone=B;return this;};z.emulateHTTP=false;z.emulateJSON=false;var J=z.Events={on:function(M,P,O){if(!x(this,"on",M,[P,O])||!P){return this;}this._events||(this._events={});var N=this._events[M]||(this._events[M]=[]);N.push({callback:P,context:O,ctx:O||this});return this;},once:function(N,Q,O){if(!x(this,"once",N,[Q,O])||!Q){return this;}var M=this;var P=L.once(function(){M.off(N,P);Q.apply(this,arguments);});P._callback=Q;return this.on(N,P,O);},off:function(M,V,N){var T,U,W,S,R,O,Q,P;if(!this._events||!x(this,"off",M,[V,N])){return this;}if(!M&&!V&&!N){this._events={};return this;}S=M?[M]:L.keys(this._events);for(R=0,O=S.length;R<O;R++){M=S[R];if(W=this._events[M]){this._events[M]=T=[];if(V||N){for(Q=0,P=W.length;Q<P;Q++){U=W[Q];if((V&&V!==U.callback&&V!==U.callback._callback)||(N&&N!==U.context)){T.push(U);}}}if(!T.length){delete this._events[M];}}}return this;},trigger:function(O){if(!this._events){return this;}var N=n.call(arguments,1);if(!x(this,"trigger",O,N)){return this;}var P=this._events[O];var M=this._events.all;if(P){b(P,N);}if(M){b(M,arguments);}return this;},stopListening:function(P,M,R){var N=this._listeners;if(!N){return this;}var O=!M&&!R;if(typeof M==="object"){R=this;}if(P){(N={})[P._listenerId]=P;}for(var Q in N){N[Q].off(M,R,this);if(O){delete this._listeners[Q];}}return this;}};var w=/\s+/;var x=function(T,R,N,Q){if(!N){return true;}if(typeof N==="object"){for(var P in N){T[R].apply(T,[P,N[P]].concat(Q));}return false;}if(w.test(N)){var S=N.split(w);for(var O=0,M=S.length;O<M;O++){T[R].apply(T,[S[O]].concat(Q));}return false;}return true;};var b=function(R,P){var S,Q=-1,O=R.length,N=P[0],M=P[1],T=P[2];switch(P.length){case 0:while(++Q<O){(S=R[Q]).callback.call(S.ctx);}return;case 1:while(++Q<O){(S=R[Q]).callback.call(S.ctx,N);}return;case 2:while(++Q<O){(S=R[Q]).callback.call(S.ctx,N,M);}return;case 3:while(++Q<O){(S=R[Q]).callback.call(S.ctx,N,M,T);
}return;default:while(++Q<O){(S=R[Q]).callback.apply(S.ctx,P);}}};var C={listenTo:"on",listenToOnce:"once"};L.each(C,function(M,N){J[N]=function(Q,O,S){var P=this._listeners||(this._listeners={});var R=Q._listenerId||(Q._listenerId=L.uniqueId("l"));P[R]=Q;if(typeof O==="object"){S=this;}Q[M](O,S,this);return this;};});J.bind=J.on;J.unbind=J.off;L.extend(z,J);var E=z.Model=function(M,O){var P;var N=M||{};O||(O={});this.cid=L.uniqueId("c");this.attributes={};L.extend(this,L.pick(O,F));if(O.parse){N=this.parse(N,O)||{};}if(P=L.result(this,"defaults")){N=L.defaults({},N,P);}this.set(N,O);this.changed={};this.initialize.apply(this,arguments);};var F=["url","urlRoot","collection"];L.extend(E.prototype,J,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(M){return L.clone(this.attributes);},sync:function(){return z.sync.apply(this,arguments);},get:function(M){return this.attributes[M];},escape:function(M){return L.escape(this.get(M));},has:function(M){return this.get(M)!=null;},set:function(U,M,Y){var S,V,W,T,R,X,O,Q;if(U==null){return this;}if(typeof U==="object"){V=U;Y=M;}else{(V={})[U]=M;}Y||(Y={});if(!this._validate(V,Y)){return false;}W=Y.unset;R=Y.silent;T=[];X=this._changing;this._changing=true;if(!X){this._previousAttributes=L.clone(this.attributes);this.changed={};}Q=this.attributes,O=this._previousAttributes;if(this.idAttribute in V){this.id=V[this.idAttribute];}for(S in V){M=V[S];if(!L.isEqual(Q[S],M)){T.push(S);}if(!L.isEqual(O[S],M)){this.changed[S]=M;}else{delete this.changed[S];}W?delete Q[S]:Q[S]=M;}if(!R){if(T.length){this._pending=true;}for(var P=0,N=T.length;P<N;P++){this.trigger("change:"+T[P],this,Q[T[P]],Y);}}if(X){return this;}if(!R){while(this._pending){this._pending=false;this.trigger("change",this,Y);}}this._pending=false;this._changing=false;return this;},unset:function(M,N){return this.set(M,void 0,L.extend({},N,{unset:true}));},clear:function(N){var M={};for(var O in this.attributes){M[O]=void 0;}return this.set(M,L.extend({},N,{unset:true}));},hasChanged:function(M){if(M==null){return !L.isEmpty(this.changed);}return L.has(this.changed,M);},changedAttributes:function(O){if(!O){return this.hasChanged()?L.clone(this.changed):false;}var Q,P=false;var N=this._changing?this._previousAttributes:this.attributes;for(var M in O){if(L.isEqual(N[M],(Q=O[M]))){continue;}(P||(P={}))[M]=Q;}return P;},previous:function(M){if(M==null||!this._previousAttributes){return null;}return this._previousAttributes[M];},previousAttributes:function(){return L.clone(this._previousAttributes);},fetch:function(N){N=N?L.clone(N):{};if(N.parse===void 0){N.parse=true;}var M=this;var O=N.success;N.success=function(P){if(!M.set(M.parse(P,N),N)){return false;}if(O){O(M,P,N);}M.trigger("sync",M,P,N);};H(this,N);return this.sync("read",this,N);},save:function(Q,N,U){var R,M,T,O=this.attributes;if(Q==null||typeof Q==="object"){R=Q;U=N;}else{(R={})[Q]=N;}if(R&&(!U||!U.wait)&&!this.set(R,U)){return false;}U=L.extend({validate:true},U);if(!this._validate(R,U)){return false;}if(R&&U.wait){this.attributes=L.extend({},O,R);}if(U.parse===void 0){U.parse=true;}var P=this;var S=U.success;U.success=function(W){P.attributes=O;var V=P.parse(W,U);if(U.wait){V=L.extend(R||{},V);}if(L.isObject(V)&&!P.set(V,U)){return false;}if(S){S(P,W,U);}P.trigger("sync",P,W,U);};H(this,U);M=this.isNew()?"create":(U.patch?"patch":"update");if(M==="patch"){U.attrs=R;}T=this.sync(M,this,U);if(R&&U.wait){this.attributes=O;}return T;},destroy:function(N){N=N?L.clone(N):{};var M=this;var Q=N.success;var O=function(){M.trigger("destroy",M,M.collection,N);};N.success=function(R){if(N.wait||M.isNew()){O();}if(Q){Q(M,R,N);}if(!M.isNew()){M.trigger("sync",M,R,N);}};if(this.isNew()){N.success();return false;}H(this,N);var P=this.sync("delete",this,N);if(!N.wait){O();}return P;},url:function(){var M=L.result(this,"urlRoot")||L.result(this.collection,"url")||r();if(this.isNew()){return M;}return M+(M.charAt(M.length-1)==="/"?"":"/")+encodeURIComponent(this.id);},parse:function(N,M){return N;},clone:function(){return new this.constructor(this.attributes);},isNew:function(){return this.id==null;},isValid:function(M){return this._validate({},L.extend(M||{},{validate:true}));},_validate:function(O,N){if(!N.validate||!this.validate){return true;}O=L.extend({},this.attributes,O);var M=this.validationError=this.validate(O,N)||null;if(!M){return true;}this.trigger("invalid",this,M,L.extend(N||{},{validationError:M}));return false;}});var a=["keys","values","pairs","invert","pick","omit"];L.each(a,function(M){E.prototype[M]=function(){var N=n.call(arguments);N.unshift(this.attributes);return L[M].apply(L,N);};});var c=z.Collection=function(N,M){M||(M={});if(M.url){this.url=M.url;}if(M.model){this.model=M.model;}if(M.comparator!==void 0){this.comparator=M.comparator;}this._reset();this.initialize.apply(this,arguments);if(N){this.reset(N,L.extend({silent:true},M));}};var o={add:true,remove:true,merge:true};var K={add:true,merge:false,remove:false};L.extend(c.prototype,J,{model:E,initialize:function(){},toJSON:function(M){return this.map(function(N){return N.toJSON(M);});},sync:function(){return z.sync.apply(this,arguments);},add:function(N,M){return this.set(N,L.defaults(M||{},K));},remove:function(R,P){R=L.isArray(R)?R.slice():[R];P||(P={});var Q,M,O,N;for(Q=0,M=R.length;Q<M;Q++){N=this.get(R[Q]);if(!N){continue;}delete this._byId[N.id];delete this._byId[N.cid];O=this.indexOf(N);this.models.splice(O,1);this.length--;if(!P.silent){P.index=O;N.trigger("remove",N,this,P);}this._removeReference(N);}return this;},set:function(N,Z){Z=L.defaults(Z||{},o);if(Z.parse){N=this.parse(N,Z);}if(!L.isArray(N)){N=N?[N]:[];}var U,Q,W,X,O,V;var P=Z.at;var T=this.comparator&&(P==null)&&Z.sort!==false;var R=L.isString(this.comparator)?this.comparator:null;var Y=[],M=[],S={};for(U=0,Q=N.length;U<Q;U++){if(!(W=this._prepareModel(N[U],Z))){continue;}if(O=this.get(W)){if(Z.remove){S[O.cid]=true;}if(Z.merge){O.set(W.attributes,Z);if(T&&!V&&O.hasChanged(R)){V=true;}}}else{if(Z.add){Y.push(W);W.on("all",this._onModelEvent,this);this._byId[W.cid]=W;if(W.id!=null){this._byId[W.id]=W;}}}}if(Z.remove){for(U=0,Q=this.length;U<Q;++U){if(!S[(W=this.models[U]).cid]){M.push(W);}}if(M.length){this.remove(M,Z);}}if(Y.length){if(T){V=true;}this.length+=Y.length;if(P!=null){t.apply(this.models,[P,0].concat(Y));}else{D.apply(this.models,Y);}}if(V){this.sort({silent:true});}if(Z.silent){return this;}for(U=0,Q=Y.length;U<Q;U++){(W=Y[U]).trigger("add",W,this,Z);}if(V){this.trigger("sort",this,Z);}return this;},reset:function(P,N){N||(N={});for(var O=0,M=this.models.length;O<M;O++){this._removeReference(this.models[O]);}N.previousModels=this.models;this._reset();this.add(P,L.extend({silent:true},N));if(!N.silent){this.trigger("reset",this,N);}return this;},push:function(N,M){N=this._prepareModel(N,M);this.add(N,L.extend({at:this.length},M));return N;},pop:function(N){var M=this.at(this.length-1);this.remove(M,N);return M;},unshift:function(N,M){N=this._prepareModel(N,M);this.add(N,L.extend({at:0},M));return N;},shift:function(N){var M=this.at(0);this.remove(M,N);return M;},slice:function(N,M){return this.models.slice(N,M);},get:function(M){if(M==null){return void 0;}return this._byId[M.id!=null?M.id:M.cid||M];},at:function(M){return this.models[M];},where:function(M,N){if(L.isEmpty(M)){return N?void 0:[];}return this[N?"find":"filter"](function(O){for(var P in M){if(M[P]!==O.get(P)){return false;}}return true;});},findWhere:function(M){return this.where(M,true);},sort:function(M){if(!this.comparator){throw new Error("Cannot sort a set without a comparator");}M||(M={});if(L.isString(this.comparator)||this.comparator.length===1){this.models=this.sortBy(this.comparator,this);}else{this.models.sort(L.bind(this.comparator,this));}if(!M.silent){this.trigger("sort",this,M);}return this;},sortedIndex:function(M,P,N){P||(P=this.comparator);var O=L.isFunction(P)?P:function(Q){return Q.get(P);};return L.sortedIndex(this.models,M,O,N);
},pluck:function(M){return L.invoke(this.models,"get",M);},fetch:function(M){M=M?L.clone(M):{};if(M.parse===void 0){M.parse=true;}var O=M.success;var N=this;M.success=function(P){var Q=M.reset?"reset":"set";N[Q](P,M);if(O){O(N,P,M);}N.trigger("sync",N,P,M);};H(this,M);return this.sync("read",this,M);},create:function(N,M){M=M?L.clone(M):{};if(!(N=this._prepareModel(N,M))){return false;}if(!M.wait){this.add(N,M);}var P=this;var O=M.success;M.success=function(Q){if(M.wait){P.add(N,M);}if(O){O(N,Q,M);}};N.save(null,M);return N;},parse:function(N,M){return N;},clone:function(){return new this.constructor(this.models);},_reset:function(){this.length=0;this.models=[];this._byId={};},_prepareModel:function(O,N){if(O instanceof E){if(!O.collection){O.collection=this;}return O;}N||(N={});N.collection=this;var M=new this.model(O,N);if(!M._validate(O,N)){this.trigger("invalid",this,O,N);return false;}return M;},_removeReference:function(M){if(this===M.collection){delete M.collection;}M.off("all",this._onModelEvent,this);},_onModelEvent:function(O,N,P,M){if((O==="add"||O==="remove")&&P!==this){return;}if(O==="destroy"){this.remove(N,M);}if(N&&O==="change:"+N.idAttribute){delete this._byId[N.previous(N.idAttribute)];if(N.id!=null){this._byId[N.id]=N;}}this.trigger.apply(this,arguments);}});var y=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];L.each(y,function(M){c.prototype[M]=function(){var N=n.call(arguments);N.unshift(this.models);return L[M].apply(L,N);};});var k=["groupBy","countBy","sortBy"];L.each(k,function(M){c.prototype[M]=function(P,N){var O=L.isFunction(P)?P:function(Q){return Q.get(P);};return L[M](this.models,O,N);};});var G=z.View=function(M){this.cid=L.uniqueId("view");this._configure(M||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents();};var v=/^(\S+)\s*(.*)$/;var e=["model","collection","el","id","attributes","className","tagName","events"];L.extend(G.prototype,J,{tagName:"div",$:function(M){return this.$el.find(M);},initialize:function(){},render:function(){return this;},remove:function(){this.$el.remove();this.stopListening();return this;},setElement:function(M,N){if(this.$el){this.undelegateEvents();}this.$el=M instanceof z.$?M:z.$(M);this.el=this.$el[0];if(N!==false){this.delegateEvents();}return this;},delegateEvents:function(Q){if(!(Q||(Q=L.result(this,"events")))){return this;}this.undelegateEvents();for(var P in Q){var R=Q[P];if(!L.isFunction(R)){R=this[Q[P]];}if(!R){continue;}var O=P.match(v);var N=O[1],M=O[2];R=L.bind(R,this);N+=".delegateEvents"+this.cid;if(M===""){this.$el.on(N,R);}else{this.$el.on(N,M,R);}}return this;},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid);return this;},_configure:function(M){if(this.options){M=L.extend({},L.result(this,"options"),M);}L.extend(this,L.pick(M,e));this.options=M;},_ensureElement:function(){if(!this.el){var M=L.extend({},L.result(this,"attributes"));if(this.id){M.id=L.result(this,"id");}if(this.className){M["class"]=L.result(this,"className");}var N=z.$("<"+L.result(this,"tagName")+">").attr(M);this.setElement(N,false);}else{this.setElement(L.result(this,"el"),false);}}});z.sync=function(S,N,M){var P=j[S];L.defaults(M||(M={}),{emulateHTTP:z.emulateHTTP,emulateJSON:z.emulateJSON});var R={type:P,dataType:"json"};if(!M.url){R.url=L.result(N,"url")||r();}if(M.data==null&&N&&(S==="create"||S==="update"||S==="patch")){R.contentType="application/json";R.data=JSON.stringify(M.attrs||N.toJSON(M));}if(M.emulateJSON){R.contentType="application/x-www-form-urlencoded";R.data=R.data?{model:R.data}:{};}if(M.emulateHTTP&&(P==="PUT"||P==="DELETE"||P==="PATCH")){R.type="POST";if(M.emulateJSON){R.data._method=P;}var O=M.beforeSend;M.beforeSend=function(T){T.setRequestHeader("X-HTTP-Method-Override",P);if(O){return O.apply(this,arguments);}};}if(R.type!=="GET"&&!M.emulateJSON){R.processData=false;}if(R.type==="PATCH"&&window.ActiveXObject&&!(window.external&&window.external.msActiveXFilteringEnabled)){R.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP");};}var Q=M.xhr=z.ajax(L.extend(R,M));N.trigger("request",N,Q,M);return Q;};var j={"create":"POST","update":"PUT","patch":"PATCH","delete":"DELETE","read":"GET"};z.ajax=function(){return z.$.ajax.apply(z.$,arguments);};var p=z.Router=function(M){M||(M={});if(M.routes){this.routes=M.routes;}this._bindRoutes();this.initialize.apply(this,arguments);};var q=/\((.*?)\)/g;var s=/(\(\?)?:\w+/g;var d=/\*\w+/g;var h=/[\-{}\[\]+?.,\\\^$|#\s]/g;L.extend(p.prototype,J,{initialize:function(){},route:function(N,O,P){if(!L.isRegExp(N)){N=this._routeToRegExp(N);}if(L.isFunction(O)){P=O;O="";}if(!P){P=this[O];}var M=this;z.history.route(N,function(R){var Q=M._extractParameters(N,R);P&&P.apply(M,Q);M.trigger.apply(M,["route:"+O].concat(Q));M.trigger("route",O,Q);z.history.trigger("route",M,O,Q);});return this;},navigate:function(N,M){z.history.navigate(N,M);return this;},_bindRoutes:function(){if(!this.routes){return;}this.routes=L.result(this,"routes");var N,M=L.keys(this.routes);while((N=M.pop())!=null){this.route(N,this.routes[N]);}},_routeToRegExp:function(M){M=M.replace(h,"\\$&").replace(q,"(?:$1)?").replace(s,function(O,N){return N?O:"([^/]+)";}).replace(d,"(.*?)");return new RegExp("^"+M+"$");},_extractParameters:function(M,N){var O=M.exec(N).slice(1);return L.map(O,function(P){return P?decodeURIComponent(P):null;});}});var i=z.History=function(){this.handlers=[];L.bindAll(this,"checkUrl");if(typeof window!=="undefined"){this.location=window.location;this.history=window.history;}};var A=/^[#\/]|\s+$/g;var f=/^\/+|\/+$/g;var I=/msie [\w.]+/;var m=/\/$/;i.started=false;L.extend(i.prototype,J,{interval:50,getHash:function(N){var M=(N||this).location.href.match(/#(.*)$/);return M?M[1]:"";},getFragment:function(O,N){if(O==null){if(this._hasPushState||!this._wantsHashChange||N){O=this.location.pathname;var M=this.root.replace(m,"");if(!O.indexOf(M)){O=O.substr(M.length);}}else{O=this.getHash();}}return O.replace(A,"");},start:function(O){if(i.started){throw new Error("Backbone.history has already been started");}i.started=true;this.options=L.extend({},{root:"/"},this.options,O);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==false;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var N=this.getFragment();var M=document.documentMode;var Q=(I.exec(navigator.userAgent.toLowerCase())&&(!M||M<=7));this.root=("/"+this.root+"/").replace(f,"/");if(Q&&this._wantsHashChange){this.iframe=z.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;this.navigate(N);}if(this._hasPushState){z.$(window).on("popstate",this.checkUrl);}else{if(this._wantsHashChange&&("onhashchange" in window)&&!Q){z.$(window).on("hashchange",this.checkUrl);}else{if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval);}}}this.fragment=N;var R=this.location;var P=R.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!P){this.fragment=this.getFragment(null,true);this.location.replace(this.root+this.location.search+"#"+this.fragment);return true;}else{if(this._wantsPushState&&this._hasPushState&&P&&R.hash){this.fragment=this.getHash().replace(A,"");this.history.replaceState({},document.title,this.root+this.fragment+R.search);}}if(!this.options.silent){return this.loadUrl();}},stop:function(){z.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);i.started=false;},route:function(M,N){this.handlers.unshift({route:M,callback:N});},checkUrl:function(N){var M=this.getFragment();if(M===this.fragment&&this.iframe){M=this.getFragment(this.getHash(this.iframe));
}if(M===this.fragment){return false;}if(this.iframe){this.navigate(M);}this.loadUrl()||this.loadUrl(this.getHash());},loadUrl:function(O){var N=this.fragment=this.getFragment(O);var M=L.any(this.handlers,function(P){if(P.route.test(N)){P.callback(N);return true;}});return M;},navigate:function(O,N){if(!i.started){return false;}if(!N||N===true){N={trigger:N};}O=this.getFragment(O||"");if(this.fragment===O){return;}this.fragment=O;var M=this.root+O;if(this._hasPushState){this.history[N.replace?"replaceState":"pushState"]({},document.title,M);}else{if(this._wantsHashChange){this._updateHash(this.location,O,N.replace);if(this.iframe&&(O!==this.getFragment(this.getHash(this.iframe)))){if(!N.replace){this.iframe.document.open().close();}this._updateHash(this.iframe.location,O,N.replace);}}else{return this.location.assign(M);}}if(N.trigger){this.loadUrl(O);}},_updateHash:function(M,O,P){if(P){var N=M.href.replace(/(javascript:|#).*$/,"");M.replace(N+"#"+O);}else{M.hash="#"+O;}}});z.history=new i;var l=function(M,O){var N=this;var Q;if(M&&L.has(M,"constructor")){Q=M.constructor;}else{Q=function(){return N.apply(this,arguments);};}L.extend(Q,N,O);var P=function(){this.constructor=Q;};P.prototype=N.prototype;Q.prototype=new P;if(M){L.extend(Q.prototype,M);}Q.__super__=N.prototype;return Q;};E.extend=c.extend=p.extend=G.extend=i.extend=l;var r=function(){throw new Error('A "url" property or function must be specified');};var H=function(O,N){var M=N.error;N.error=function(P){if(M){M(O,P,N);}O.trigger("error",O,P,N);};};}).call(this);(function(){var e,a,g,c,d,b,f=[].slice;g=function(j){var i,h;if(!_.isObject(j)||_.isFunction(j)){return j;}if(j instanceof Backbone.Collection||j instanceof Backbone.Model){return j;}if(_.isDate(j)){return new Date(j.getTime());}if(_.isRegExp(j)){return new RegExp(j.source,j.toString().replace(/.*\//,""));}h=_.isArray(j||_.isArguments(j));i=function(k,m,l){if(h){k.push(g(m));}else{k[l]=g(m);}return k;};return _.reduce(j,i,h?[]:{});};b=function(h){if(h==null){return false;}return(h.prototype==={}.prototype||h.prototype===Object.prototype)&&_.isObject(h)&&!_.isArray(h)&&!_.isFunction(h)&&!_.isDate(h)&&!_.isRegExp(h)&&!_.isArguments(h);};a=function(h){return _.filter(_.keys(h),function(i){return b(h[i]);});};e=function(h){return _.filter(_.keys(h),function(i){return _.isArray(h[i]);});};d=function(p,h,k){var r,i,s,n,o,t,m,l,q,j;if(k==null){k=20;}if(k<=0){console.warn("_.deepExtend(): Maximum depth of recursion hit.");return _.extend(p,h);}t=_.intersection(a(p),a(h));i=function(u){return h[u]=d(p[u],h[u],k-1);};for(m=0,q=t.length;m<q;m++){o=t[m];i(o);}n=_.intersection(e(p),e(h));r=function(u){return h[u]=_.union(p[u],h[u]);};for(l=0,j=n.length;l<j;l++){s=n[l];r(s);}return _.extend(p,h);};c=function(){var h,k,j,i;j=2<=arguments.length?f.call(arguments,0,i=arguments.length-1):(i=0,[]),k=arguments[i++];if(!_.isNumber(k)){j.push(k);k=20;}if(j.length<=1){return j[0];}if(k<=0){return _.extend.apply(this,j);}h=j.shift();while(j.length>0){h=d(h,g(j.shift()),k);}return h;};_.mixin({deepClone:g,isBasicObject:b,basicObjects:a,arrays:e,deepExtend:c});}).call(this);(function(a){if(typeof define==="function"&&define.amd){define(["underscore","backbone"],a);}else{a(_,Backbone);}}(function(c,g){function e(n){var h={},m=b.keyPathSeparator;for(var i in n){var o=n[i];if(o&&o.constructor===Object&&!c.isEmpty(o)){var l=e(o);for(var j in l){var k=l[j];h[i+m+j]=k;}}else{h[i]=o;}}return h;}function f(p,o,l){var m=b.keyPathSeparator;var j=o.split(m);var h=p;l||(l===false);for(var k=0,q=j.length;k<q;k++){if(l&&!c.has(h,j[k])){return false;}h=h[j[k]];if(h==null&&k<q-1){h={};}if(typeof h==="undefined"){if(l){return true;}return h;}}if(l){return true;}return h;}function a(k,q,j,r){r=r||{};var m=b.keyPathSeparator;var o=q.split(m);var s=k;for(var l=0,h=o.length;l<h&&s!==undefined;l++){var p=o[l];if(l===h-1){r.unset?delete s[p]:s[p]=j;}else{if(typeof s[p]==="undefined"||!c.isObject(s[p])){s[p]={};}s=s[p];}}}function d(i,h){a(i,h,null,{unset:true});}var b=g.Model.extend({constructor:function(h,j){var k;var i=h||{};this.cid=c.uniqueId("c");this.attributes={};if(j&&j.collection){this.collection=j.collection;}if(j&&j.parse){i=this.parse(i,j)||{};}if(k=c.result(this,"defaults")){i=c.deepExtend({},k,i);}this.set(i,j);this.changed={};this.initialize.apply(this,arguments);},toJSON:function(h){return c.deepClone(this.attributes);},get:function(h){return f(this.attributes,h);},set:function(A,B,m){var u,r,j,z,y,k,p,s;if(A==null){return this;}if(typeof A==="object"){r=A;m=B||{};}else{(r={})[A]=B;}m||(m={});if(!this._validate(r,m)){return false;}j=m.unset;y=m.silent;z=[];k=this._changing;this._changing=true;if(!k){this._previousAttributes=c.deepClone(this.attributes);this.changed={};}s=this.attributes,p=this._previousAttributes;if(this.idAttribute in r){this.id=r[this.idAttribute];}r=e(r);for(u in r){B=r[u];if(!c.isEqual(f(s,u),B)){z.push(u);}if(!c.isEqual(f(p,u),B)){a(this.changed,u,B);}else{d(this.changed,u);}j?d(s,u):a(s,u,B);}if(!y){if(z.length){this._pending=true;}var o=b.keyPathSeparator;for(var x=0,v=z.length;x<v;x++){var A=z[x];this.trigger("change:"+A,this,f(s,A),m);var q=A.split(o);for(var t=q.length-1;t>0;t--){var w=c.first(q,t).join(o),h=w+o+"*";this.trigger("change:"+h,this,f(s,w),m);}}}if(k){return this;}if(!y){while(this._pending){this._pending=false;this.trigger("change",this,m);}}this._pending=false;this._changing=false;return this;},clear:function(i){var h={};var k=e(this.attributes);for(var j in k){h[j]=void 0;}return this.set(h,c.extend({},i,{unset:true}));},hasChanged:function(h){if(h==null){return !c.isEmpty(this.changed);}return f(this.changed,h)!==undefined;},changedAttributes:function(j){if(!j){return this.hasChanged()?e(this.changed):false;}var i=this._changing?this._previousAttributes:this.attributes;j=e(j);i=e(i);var l,k=false;for(var h in j){if(c.isEqual(i[h],(l=j[h]))){continue;}(k||(k={}))[h]=l;}return k;},previous:function(h){if(h==null||!this._previousAttributes){return null;}return f(this._previousAttributes,h);},previousAttributes:function(){return c.deepClone(this._previousAttributes);}});b.keyPathSeparator=".";g.DeepModel=b;if(typeof module!="undefined"){module.exports=b;}return g;}));var GlobalUtils=function(){var b=this;var a,c;if(window.isMobilePhone){$(window).on("orientationchange",function(){clearTimeout(a);a=setTimeout(function(){uitk.publish("windowOrientationchange");},400);});}else{$(window).on("resize",function(){clearTimeout(a);a=setTimeout(function(){uitk.publish("windowResize");},400);});}$(window).on("scroll",function(){clearTimeout(c);c=setTimeout(function(){uitk.publish("windowScroll");},500);});b.scrollToDeals=function(){var d=$(".site-content").offset();d=Math.floor(d.top),currentScrollPos=$(window).scrollTop();if(currentScrollPos>d){$(window).scrollTop(d);}};b.locale=(function(){var f=document.getElementsByTagName("body"),e=f[0].className,g=/[a-z]{2}_[A-Z]{2}/,d=e.match(g);return d[0];})();b.siteid=(function(){var f=document.getElementsByTagName("body"),e=f[0].className,g=/siteid[0-9]{1,}/,d=e.match(g);if(typeof d!=="undefined"){d=d[0].replace("siteid","");}return d;})();b.equalHeights=function(d,f){if(!window.isMobilePhone){var d=$(d),h=d.find(".tile-details:visible"),h=h.not(".hotel-only-price"),e=0,g=0;h.height("auto");h.each(function(j){if(j==0){g=parseInt($(this).css("padding-bottom"));g=g+parseInt($(this).css("padding-top"));}e=(parseInt($(this).height())>e)?parseInt($(this).height()):e;});h.css("height",(e+g)/17+"em");return false;}};b.makeElementSticky=function(){var e=false,d=$("#stickyAncher");if(d.length){var f=$("#offerTabs").length?d.offset().top+$(".tabs").outerHeight():d.offset().top;uitk.subscribe("windowScroll",function(){var i=$(window).scrollTop(),g=$(".addon-container:visible"),h=i>f;if(h&&!e){g.addClass("sticky");e=true;}else{if(!h&&e){g.removeClass("sticky");e=false;}}});}},Handlebars.registerHelper("list",function(g,h){var e="",f,d;for(f=0,d=g.length;f<d;f++){e=e+h.fn(g[f]);}return e;});Handlebars.registerHelper("unescape",function(d){return unescape(d);
});Handlebars.registerHelper("ifCond",function(g,d,f,e){if(typeof g==="function"){g=g();}switch(d){case"==":return(g==f)?e.fn(this):e.inverse(this);case"===":return(g===f)?e.fn(this):e.inverse(this);case"<":return(g<f)?e.fn(this):e.inverse(this);case"<=":return(g<=f)?e.fn(this):e.inverse(this);case">":return(g>f)?e.fn(this):e.inverse(this);case">=":return(g>=f)?e.fn(this):e.inverse(this);default:return e.inverse(this);}});Handlebars.registerHelper("showHotelDiscount",function(h,f,e){var g=parseInt(e.fn(this)),d="<strong class='hotel-discount'>"+h+" "+g+"%</strong>";if(g>0&&g>=parseInt(f)){return d;}});Handlebars.registerHelper("showPackageDiscount",function(h,f,e){var g=parseInt(e.fn(this)),d="<strong class='hotel-discount'>"+h+" "+b.formatPrice(g)+"</strong>";if(g>0&&g>=parseInt(f)){return d;}});Handlebars.registerHelper("showHotelDiscountRed",function(h,f,e){var g=parseInt(e.fn(this)),d="<strong class='hotel-discount-red'>"+h+" "+g+"%</strong>";if(g>0&&g>=parseInt(f)){return d;}});Handlebars.registerHelper("showPackageDiscountRed",function(h,f,e){var g=parseInt(e.fn(this)),d="<strong class='hotel-discount-red'>"+h+" "+b.formatPrice(g)+"</strong>";if(g>0&&g>=parseInt(f)){return d;}});Handlebars.registerHelper("showHotelDiscountSizeIncreased",function(h,f,e){var g=parseInt(e.fn(this)),d="<strong class='hotel-discount-big'>"+h+"<br/>"+g+"%</strong>";if(g>0&&g>=parseInt(f)){return d;}});Handlebars.registerHelper("showPackageDiscountSizeIncreased",function(h,f,e){var g=parseInt(e.fn(this)),d="<strong class='hotel-discount-big'>"+h+"<br/>"+b.formatPrice(g)+"</strong>";if(g>0&&g>=parseInt(f)){return d;}});Handlebars.registerHelper("showNumOfPeopleViewing",function(g,e){var f=e.fn(this),d=f+" "+g;if(f>0){return d;}});Handlebars.registerHelper("showCrossOutPrice",function(e){var f=e.fn(this),g=this.getPrice(),h=this.getAveragePrice(),d=b.formatPrice(f);if(f>0){return d;}else{return false;}});Handlebars.registerHelper("showGuestRating",function(g,f,e){var h=e.fn(this),d;if(b.locale==="da_DK"||b.locale==="de_DE"){h=h.replace(".",",");}d='<p class="secondary tile-guestRate">'+g+" "+h+" "+f+"</p>";if(parseInt(h)>0){return d;}});Handlebars.registerHelper("formatPrice",function(d){return b.formatPrice(d.fn(this),this.lob);});Handlebars.registerHelper("formatDate",function(d){return b.formatDate(d.fn(this),"prettyDate");});Handlebars.registerHelper("constructDealsRfrr",function(e,h,d,g){var f=(typeof this.getCity=="function")?this.getCity():"",f=(typeof f=="string")?f.replace(/ /g,""):"",e=(g=="withDest")?e+"."+f+"."+h:e+"."+(h+1);if(d=="deeplink"){return"&rfrr="+e;}else{return"&rfrr="+e+"."+d;}});Handlebars.registerHelper("processTripType",function(e){var d=this.getTripType();e=e.fn(this);e=e.split("|");if(d=="ROUND_TRIP"&&typeof e[0]=="string"){return e[0];}else{if(d!="ROUND_TRIP"&&typeof e[1]=="string"){return e[1];}else{return false;}}});};GlobalUtils.prototype.formatPrice=function(c){var b=this,d,a;if(typeof c!="undefined"){c=Math.round(c);c=c.toString();if(c.length>3){d=c.toString().slice(0,-3);a=c.toString().slice(-3);}switch(b.locale){case"en_US":if(b.siteid==="28"){if(c.length>3){c=d+","+a;}return"&#36;"+c;}else{if(c.length>3){c=d+","+a;}return"&#36;"+c;}break;case"en_CA":if(c.length>3){c=d+","+a;}return"C&#36;"+c;break;case"fr_CA":if(c.length>3){c=d+"&nbsp;"+a;}return c+'<span class="currencySign">&nbsp;&#36;C</span>';break;case"es_MX":if(c.length>3){c=d+","+a;}return'<small>MXN&nbsp;</small><span class="currencySign">&#36;</span>'+c;break;case"pt_BR":if(c.length>3){c=d+"."+a;}return'<small>R&nbsp;</small><span class="currencySign">&#36;</span>'+c;break;case"es_AR":if(c.length>3){c=d+"."+a;}return'<small>AR&nbsp;</small><span class="currencySign">&#36;</span>'+c;break;case"en_AU":return"&#36;"+c;break;case"en_IE":if(c.length>3){c=d+","+a;}return'<span class="currencySign">&euro;</span>'+c;break;case"fr_FR":if(c.length>3){c=d+"&nbsp;"+a;}return c+'<span class="currencySign">&nbsp;&euro;</span>';break;case"fr_BE":if(c.length>3){c=d+"&nbsp;"+a;}return c+'<span class="currencySign">&nbsp;&euro;</span>';break;case"nl_BE":if(c.length>3){c=d+"."+a;}return'<span class="currencySign">&euro;&nbsp;</span>'+c;break;case"nl_NL":if(c.length>3){c=d+"."+a;}return'<span class="currencySign">&euro;&nbsp;</span>'+c;break;case"it_IT":if(c.length>3){c=d+"."+a;}return'<span class="currencySign">&euro;&nbsp;</span>'+c;break;case"es_ES":if(c.length>3){c=d+"."+a;}return c+'<span class="currencySign">&nbsp;&euro;</span>';break;case"de_DE":if(c.length>3){c=d+"."+a;}return'<span class="currencySign">&euro;</span>'+c;break;case"fi_FI":if(c.length>3){c=d+"&nbsp;"+a;}return c+'<span class="currencySign">&nbsp;&euro;</span>';break;case"da_DK":if(c.length>3){c=d+"."+a;}return'<span class="currencySign">DKK&nbsp;</span>'+c;break;case"nb_NO":if(c.length>3){c=d+"&nbsp;"+a;}return c+'<span class="currencySign">&nbsp;kr</span>';break;case"sv_SE":if(c.length>3){c=d+"&nbsp;"+a;}return c+'<span class="currencySign">&nbsp;kr</span>';break;case"en_GB":if(b.siteid==="27"){if(c.length>3){c=d+","+a;}return"Rs."+c;}else{if(b.siteid==="17"){if(c.length>3){c=d+","+a;}return"&#3647;"+c;}else{if(b.siteid==="61"){if(c.length>6){valC=c.toString().slice(-(c.lengh),-6);d=c.toString().slice(-6,-3);a=c.toString().slice(-3);c=valC+"."+d+"."+a;}else{if(c.length>3){c=d+"."+a;}}return"Rp"+c;}else{if(b.siteid==="1255"){if(c.length>6){valC=c.toString().slice(-(c.lengh),-6);d=c.toString().slice(-6,-3);a=c.toString().slice(-3);c=valC+"."+d+"."+a;}else{if(c.length>3){c=d+"."+a;}}return"Rp"+c;}else{if(c.length>3){c=d+","+a;}return"&#163;"+c;}}}}break;case"en_MY":if(c.length>3){c=d+","+a;}return"RM"+c;break;case"ms_MY":if(c.length>3){c=d+","+a;}return"RM"+c;break;case"en_SG":if(c.length>3){c=d+","+a;}return"S&#36;"+c;break;case"ko_KR":if(c.length>3){c=d+","+a;}return"&#65510;"+c;break;case"th_TH":if(c.length>3){c=d+","+a;}return"&#3647;"+c;break;case"en_HK":if(c.length>3){c=d+","+a;}return"HK&#36;"+c;break;case"zh_CN":if(c.length>3){c=d+","+a;}return"HK&#36;"+c;break;case"zh_HK":if(c.length>3){c=d+","+a;}return"HK&#36;"+c;break;case"ja_JP":if(c.length>3){c=d+","+a;}return"&#65509;"+c;break;case"zh_TW":if(c.length>3){c=d+","+a;}return"NT&#36;"+c;break;case"id_ID":if(c.length>6){valC=c.toString().slice(-(c.length),-6);d=c.toString().slice(-6,-3);a=c.toString().slice(-3);c=valC+"."+d+"."+a;}else{if(c.length>3){c=d+"."+a;}}return"Rp"+c;break;default:return c;}}else{return false;}};GlobalUtils.prototype.formatDate=function(e,a){var i=this,b,f,g,j=e.toString(),j=j.replace(/[,\.]/g,"/"),h=Date.parse(j),c=new Date(h);if(typeof c!="undefined"||typeof c!="NaN"){switch(i.locale){case"en_US":if(i.siteid==="28"){b=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];f=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];j=f[c.getDay()]+" "+b[c.getMonth()]+" "+c.getDate();g=(parseInt(c.getMonth(),10)+1)+"/"+c.getDate()+"/"+c.getFullYear();}else{b=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];f=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];j=f[c.getDay()]+" "+b[c.getMonth()]+" "+c.getDate();g=(parseInt(c.getMonth(),10)+1)+"/"+c.getDate()+"/"+c.getFullYear();}break;case"en_CA":b=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];f=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];j=f[c.getDay()]+" "+c.getDate()+" "+b[c.getMonth()];g=c.getDate()+"/"+(parseInt(c.getMonth(),10)+1)+"/"+c.getFullYear();break;case"fr_CA":b=["janv","f&eacute;vr","mars","avril","mai","juin","juil","ao&ucirc;t","sept","oct","nov","d&eacute;c"];f=["dim","lun","mar","mer","jeu","ven","sam"];j=f[c.getDay()]+" "+c.getDate()+" "+b[c.getMonth()];g=c.getDate()+"/"+(parseInt(c.getMonth(),10)+1)+"/"+c.getFullYear();break;case"es_MX":b=["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"];f=["dom","lun","mar","mi&eacute;","jue","vie","s&aacute;b"];j=f[c.getDay()]+" "+c.getDate()+" "+b[c.getMonth()];g=c.getDate()+"/"+(parseInt(c.getMonth(),10)+1)+"/"+c.getFullYear();break;case"pt_BR":b=["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"];
f=["Dom","Seg","Ter","Qua","Qui","Sex","S&aacuteb"];j=f[c.getDay()]+" "+c.getDate()+" "+b[c.getMonth()];g=c.getDate()+"/"+(parseInt(c.getMonth(),10)+1)+"/"+c.getFullYear();break;case"es_AR":b=["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"];f=["dom","lun","mar","mi&eacute;","jue","vie","s&aacute;b"];j=f[c.getDay()]+" "+c.getDate()+" "+b[c.getMonth()];g=c.getDate()+"/"+(parseInt(c.getMonth(),10)+1)+"/"+c.getFullYear();break;case"en_AU":b=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];f=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];j=f[c.getDay()]+" "+b[c.getMonth()]+" "+c.getDate();g=c.getDate()+"/"+(parseInt(c.getMonth(),10)+1)+"/"+c.getFullYear();break;case"en_IE":b=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];f=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];j=f[c.getDay()]+" "+c.getDate()+" "+b[c.getMonth()];g=c.getDate()+"/"+(parseInt(c.getMonth(),10)+1)+"/"+c.getFullYear();break;case"fr_FR":b=["janv","f&eacute;vr","mars","avril","mai","juin","juil","ao&ucirc;t","sept","oct","nov","d&eacute;c"];f=["dim","lun","mar","mer","jeu","ven","sam"];j=f[c.getDay()]+" "+c.getDate()+" "+b[c.getMonth()];g=c.getDate()+"/"+(parseInt(c.getMonth(),10)+1)+"/"+c.getFullYear();break;case"fr_BE":b=["janv","f&eacute;vr","mars","avril","mai","juin","juil","ao&ucirc;t","sept","oct","nov","d&eacute;c"];f=["dim","lun","mar","mer","jeu","ven","sam"];j=f[c.getDay()]+" "+c.getDate()+" "+b[c.getMonth()];g=c.getDate()+"/"+(parseInt(c.getMonth(),10)+1)+"/"+c.getFullYear();break;case"nl_BE":b=["jan","feb","mrt","apr","mei","jun","jul","aug","sep","okt","nov","dec"];f=["zo","ma","di","wo","do","vr","za"];j=f[c.getDay()]+" "+c.getDate()+" "+b[c.getMonth()];g=c.getDate()+"-"+(parseInt(c.getMonth(),10)+1)+"-"+c.getFullYear();break;case"nl_NL":b=["jan","feb","mrt","apr","mei","jun","jul","aug","sep","okt","nov","dec"];f=["zo","ma","di","wo","do","vr","za"];j=f[c.getDay()]+" "+c.getDate()+" "+b[c.getMonth()];g=c.getDate()+"-"+(parseInt(c.getMonth(),10)+1)+"-"+c.getFullYear();break;case"it_IT":b=["gen","feb","mar","apr","mag","giu","lug","ago","set","ott","nov","dic"];f=["dom","lun","mar","mer","gio","ven","sab"];j=f[c.getDay()]+" "+c.getDate()+" "+b[c.getMonth()];g=c.getDate()+"/"+(parseInt(c.getMonth(),10)+1)+"/"+c.getFullYear();break;case"es_ES":b=["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"];f=["dom","lun","mar","mi&eacute;","jue","vie","s&aacute;b"];j=f[c.getDay()]+" "+c.getDate()+" "+b[c.getMonth()];g=c.getDate()+"/"+(parseInt(c.getMonth(),10)+1)+"/"+c.getFullYear();break;case"de_DE":b=["Jan","Feb","M&auml;r","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"];f=["So","Mo","Di","Mi","Do","Fr","Sa"];j=f[c.getDay()]+" "+c.getDate()+". "+b[c.getMonth()];g=c.getDate()+"."+(parseInt(c.getMonth(),10)+1)+"."+c.getFullYear();break;case"fi_FI":b=["tammikuu","helmikuu","maaliskuu","huhtikuu","toukokuu","kes&#xE4;kuu","hein&#xE4;kuu","elokuu","syyskuu","lokakuu","marraskuu","joulukuu"];f=["su","ma","ti","ke","to","pe","la"];j=f[c.getDay()]+" "+c.getDate()+"."+(c.getMonth()+1)+".";g=c.getDate()+"."+(parseInt(c.getMonth(),10)+1)+"."+c.getFullYear();break;case"da_DK":b=["jan","feb","mar","apr","maj","jun","jul","aug","sep","okt","nov","dec"];f=["s&oslash;n","man","tir","ons","tor","fre","l&oslash;r"];j=f[c.getDay()]+". "+c.getDate()+". "+b[c.getMonth()]+".";g=c.getDate()+"."+(parseInt(c.getMonth(),10)+1)+"."+c.getFullYear();break;case"nb_NO":b=["jan","feb","mar","apr","mai","jun","jul","aug","sep","okt","nov","des"];f=["s&oslash;n","man","tir","ons","tor","fre","l&oslash;r"];j=f[c.getDay()]+". "+c.getDate()+". "+b[c.getMonth()]+".";g=c.getDate()+"."+(parseInt(c.getMonth(),10)+1)+"."+c.getFullYear();break;case"sv_SE":b=["jan","feb","mar","apr","maj","jun","jul","aug","sep","okt","nov","dec"];f=["s&ouml;n","m&aring;n","tis","ons","tor","fre","l&ouml;r"];j=f[c.getDay()]+" "+c.getDate()+" "+b[c.getMonth()];g=c.getDate()+"-"+(parseInt(c.getMonth(),10)+1)+"-"+c.getFullYear();break;case"en_GB":if(i.siteid==="27"){b=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];f=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];j=f[c.getDay()]+" "+c.getDate()+" "+b[c.getMonth()];g=c.getDate()+"/"+(parseInt(c.getMonth(),10)+1)+"/"+c.getFullYear();}else{b=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];f=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];j=f[c.getDay()]+" "+c.getDate()+" "+b[c.getMonth()];g=c.getDate()+"/"+(parseInt(c.getMonth(),10)+1)+"/"+c.getFullYear();}break;case"en_SG":b=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];f=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];j=f[c.getDay()]+" "+c.getDate()+" "+b[c.getMonth()];g=c.getDate()+"/"+(parseInt(c.getMonth(),10)+1)+"/"+c.getFullYear();break;case"en_HK":b=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];f=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];j=b[c.getMonth()]+c.getDate()+" ("+f[c.getDay()]+")";g=c.getDate()+"/"+(parseInt(c.getMonth(),10)+1)+"/"+c.getFullYear();break;case"ja_JP":b=["1&#26376;","2&#26376;","3&#26376;","4&#26376;","5&#26376;","6&#26376;","7&#26376;","8&#26376;","9&#26376;","10&#26376;","11&#26376;","12&#26376;"];f=["&#26085;","&#26376;","&#28779;","&#27700;","&#26408;","&#37329;","&#22303;"];j=b[c.getMonth()]+" "+c.getDate()+"&#26085;";g=c.getDate()+"/"+(parseInt(c.getMonth(),10)+1)+"/"+c.getFullYear();break;case"ko_KR":b=["1&#50900;","2&#50900;","3&#50900;","4&#50900;","5&#50900;","6&#50900;","7&#50900;","8ì›”","9&#50900;","10&#50900;","11&#50900;","12&#50900;"];f=["&#51068;","&#50900;","&#54868;","&#49688;","&#47785;","&#44552;","&#53664;"];j=b[c.getMonth()]+c.getDate()+"&#51068; "+" ("+f[c.getDay()]+")";g=c.getDate()+"/"+(parseInt(c.getMonth(),10)+1)+"/"+c.getFullYear();break;case"th_TH":b=["&#3617;.&#3588;.","&#3585;.&#3614;.","&#3617;&#3637;.&#3588;.","&#3648;&#3617;.&#3618;.","&#3614;.&#3588;.","&#3617;&#3636;.&#3618;.","&#3585;.&#3588;.","&#3626;.&#3588;.","&#3585;.&#3618;.","&#3605;.&#3588;.","&#3614;.&#3618;.","&#3608;.&#3588;."];f=["&#3629;&#3634;&#3607;&#3636;&#3605;&#3618;&#3660;","&#3592;&#3633;&#3609;&#3607;&#3619;&#3660;","&#3629;&#3633;&#3591;&#3588;&#3634;&#3619;","&#3614;&#3640;&#3608;","&#3614;&#3620;&#3627;&#3633;&#3626;&#3610;&#3604;&#3637;","&#3624;&#3640;&#3585;&#3619;&#3660;","&#3648;&#3626;&#3634;&#3619;&#3660;"];j=c.getDate()+" "+b[c.getMonth()]+"("+f[c.getDay()]+")";g=c.getDate()+"/"+(parseInt(c.getMonth(),10)+1)+"/"+c.getFullYear();break;case"zh_HK":b=["1&#26376;","2&#26376;","3&#26376;","4&#26376;","5&#26376;","6&#26376;","7&#26376;","8&#26376;","9&#26376;","10&#26376;","11&#26376;","12&#26376;"];f=["&#26085;","&#19968;","&#20108;","&#19977;","&#22235;","&#20116;","&#20845;"];j=b[c.getMonth()]+c.getDate()+"&#26085; "+" (&#26143;&#26399;"+f[c.getDay()]+")";g=c.getDate()+"/"+(parseInt(c.getMonth(),10)+1)+"/"+c.getFullYear();break;case"zh_CN":b=["1&#26376;","2&#26376;","3&#26376;","4&#26376;","5&#26376;","6&#26376;","7&#26376;","8&#26376;","9&#26376;","10&#26376;","11&#26376;","12&#26376;"];f=["&#26085;","&#19968;","&#20108;","&#19977;","&#22235;","&#20116;","&#20845;"];j=b[c.getMonth()]+c.getDate()+"&#26085; "+" (&#26143;&#26399;"+f[c.getDay()]+")";g=c.getDate()+"/"+(parseInt(c.getMonth(),10)+1)+"/"+c.getFullYear();break;default:var b=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],f=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];j=f[c.getDay()]+" "+b[c.getMonth()]+" "+c.getDate();g=c.getDate()+"/"+(parseInt(c.getMonth(),10)+1)+"/"+c.getFullYear();}if(a=="prettyDate"){return j;}else{return g;}}};var globalUtils=new GlobalUtils();(function(a){var b=a({});a.each({trigger:"publish",on:"subscribe",off:"unsubscribe"},function(c,d){jQuery[d]=function(){b[c].apply(b,arguments);};});})(jQuery);var OfferServiceAdapter=(function(){var e=function(g,f){var h=[];if(!$.isEmptyObject(g.offers)){if(g.offers.hasOwnProperty("Hotel")&&g.offers.Hotel.length>0){h=d(g,f);}else{if(g.offers.hasOwnProperty("Package")&&g.offers.Package.length>0){h=a(g);
}else{if(g.offers.hasOwnProperty("Flight")&&g.offers.Flight.length>0){h=b(g);}else{if(g.offers.hasOwnProperty("ThirdPartyPackage")&&g.offers.ThirdPartyPackage.length>0){h=c(g);}else{return false;}}}}}return h;},d=function(i,h){var k=[],f=0,g=h.useAveragePrice,j=h.minOfferThreshold;$.each(i.offers.Hotel,function(m,n){var l=n.destination;$.each(n.hotelOffers,function(q,o){var p={index:f,startDate:o.offerDateRange.travelStartDate,endDate:o.offerDateRange.travelEndDate,hotelName:o.hotelInfo.localizedHotelName?decodeURIComponent(o.hotelInfo.localizedHotelName):o.hotelInfo.hotelName,hotelId:o.hotelInfo.hotelId,starRating:o.hotelInfo.hotelStarRating,guestRating:o.hotelInfo.hotelGuestReviewRating,reviewTotal:o.hotelInfo.hotelReviewTotal,imageUrl:o.hotelInfo.hotelImageUrl,numberViewing:o.hasOwnProperty("hotelUrgencyInfo")?o.hotelUrgencyInfo.numberOfPeopleViewing:"",totalPrice:o.hotelPricingInfo.totalPriceValue,averagePrice:o.hotelPricingInfo.averagePriceValue,crossOutPrice:o.hotelPricingInfo.crossOutPriceValue,percentSavings:o.hotelPricingInfo.percentSavings,city:l.city,hotelCity:o.hotelInfo.hotelCity,shortName:l.shortName,tla:l.tla,province:l.province,country:l.country,hotelSearchResultUrl:o.hotelUrls.hotelSearchResultUrl,hotelInfositeUrl:o.hotelUrls.hotelInfositeUrl,promotionDescription:o.hotelInfo.promotionDescription};p.price=g?p.averagePrice:p.totalPrice;if(typeof p.percentSavings=="undefined"&&p.crossOutPrice>0){if(g&&typeof p.averagePrice!=="undefined"){p.percentSavings=Math.round((p.crossOutPrice-p.averagePrice)/p.crossOutPrice*100);}else{p.percentSavings=Math.round((p.crossOutPrice-p.totalPrice)/p.crossOutPrice*100);}}if((g&&p.crossOutPrice==p.averagePrice)||(!g&&p.crossOutPrice==p.totalPrice)){p.crossOutPrice=0;}if(typeof p.percentSavings==="undefined"||p.percentSavings>=j){f++;k.push(p);}});});return k;},a=function(g){var h=[],f=0;$.each(g.offers.Package,function(l,m){var k=m.destination,j=m.origin;$.each(m.packageOffers,function(o,i){var n={index:f,originTla:j.tla,originCity:j.city,originCountry:j.country,originProvince:j.province,destTla:k.tla,destCity:k.city,destCountry:k.country,destProvince:k.province,destCountry:k.country,hotelName:i.hotelInfo.localizedHotelName?i.hotelInfo.localizedHotelName:i.hotelInfo.hotelName,hotelCity:i.hotelInfo.hotelCity,hotelDestination:i.hotelInfo.hotelDestination,hotelProvince:i.hotelInfo.hotelProvince,perPsgrPackagePrice:i.packagePricingInfo.perPsgrPackagePrice,hotelTotalRate:i.hotelPricingInfo.hotelTotalRate,flightSearchUrl:i.packageUrls.flightDeeplinks.flightSearchUrl,hotelInfositeUrl:i.packageUrls.hotelDeeplinks.hotelInfositeUrl,packageSearchUrl:i.packageUrls.packageSearchUrl,imageUrl:i.hotelInfo.hotelImageUrl,lengthOfStay:i.flightInfo.lengthOfStay,perPsgrSavings:i.packagePricingInfo.perPsgrSavings,starRating:i.hotelInfo.hotelStarRating,guestRating:i.hotelInfo.hotelGuestReviewRating,reviewTotal:i.hotelInfo.hotelReviewTotal,startDate:i.offerDateRange.travelStartDate,endDate:i.offerDateRange.travelEndDate,hotelPromotionDescription:i.hotelInfo.promotionDescription,packagePromotionDescription:i.packageInfo.promotionDescription};f++;h.push(n);});});return h;},b=function(g){var h=[],f=0;$.each(g.offers.Flight,function(m,j){var l=j.destination,k=j.origin;$.each(j.flightOffers,function(o,i){var n={index:f,originTla:k.tla,originCity:k.city,destTla:l.tla,destCity:l.city,flightPerPsgrBaseFarePlusTax:i.flightPricingInfo.flightPerPsgrBaseFarePlusTax,flightPerPsgrTotalPrice:i.flightPricingInfo.flightPerPsgrTotalPrice,tripType:i.flightInfo.tripType,flightDealCarrier:i.flightInfo.flightDealCarrier,flightSearchUrl:i.flightUrls.flightSearchUrl,startDate:i.offerDateRange.travelStartDate,endDate:i.offerDateRange.travelEndDate,flightDealCarrier:i.flightInfo.flightDealCarrier};f++;h.push(n);});});return h;},c=function(g){var h=[],f=0;$.each(g.offers.ThirdPartyPackage,function(l,m){var k=m.destination,j=m.origin;$.each(m.thirdPartyPackageOffers,function(o,i){var n={index:f,originTla:j.tla,originCity:j.city,originCountry:j.country,originProvince:j.province,destTla:k.tla,destCity:k.city,destCountry:k.country,destProvince:k.province,destCountry:k.country,hotelName:i.hotelInfo.localizedHotelName?i.hotelInfo.localizedHotelName:i.hotelInfo.hotelName,hotelCity:i.hotelInfo.hotelCity,hotelDestination:i.hotelInfo.hotelDestination,hotelProvince:i.hotelInfo.hotelProvince,perPsgrPackagePrice:i.packagePricingInfo.perPsgrPackagePrice,hotelTotalRate:i.hotelPricingInfo.hotelTotalRate,flightSearchUrl:i.packageUrls.flightDeeplinks.flightSearchUrl,hotelInfositeUrl:i.packageUrls.hotelDeeplinks.hotelInfositeUrl,packageSearchUrl:i.packageUrls.packageSearchUrl,imageUrl:typeof i.hotelInfo.hotelImageUrl=="string"?i.hotelInfo.hotelImageUrl.replace("booking_thumbs","booking_thumbs_w_gr"):"",lengthOfStay:i.flightInfo.lengthOfStay,perPsgrSavings:i.packagePricingInfo.perPsgrSavings,starRating:i.hotelInfo.hotelStarRating,guestRating:i.hotelInfo.hotelGuestReviewRating,reviewTotal:i.hotelInfo.hotelReviewTotal,startDate:i.offerDateRange.travelStartDate,endDate:i.offerDateRange.travelEndDate,is3PP:true};f++;h.push(n);});});return h;};return{parse:e};})();var GMTHotelModel=Backbone.Model.extend({initialize:function(){_.bindAll(this);},getIndex:function(){return this.get("index");},getDealDeepLink:function(){return unescape(this.get("hotelInfositeUrl"));},getSimilarDeepLink:function(){return unescape(this.get("hotelSearchResultUrl"));},getHotelId:function(){return this.get("hotelId");},getHotelName:function(){return this.get("hotelName");},getTruncatedHotelName:function(){var a=this.get("hotelName");if(a.length>35){a=a.substring(0,35).split(" ").slice(0,-1).join(" ")+"...";}return a;},getCheckInDate:function(){return this.get("startDate");},getCheckOutDate:function(){return this.get("endDate");},getTla:function(){return this.get("tla");},getCity:function(){if(typeof this.get("city")!="undefined"){return this.get("city");}if(typeof this.get("shortName")!="undefined"){return this.get("shortName");}},getHotelCity:function(){return this.get("hotelCity");},getProvince:function(){return this.get("province");},getCountry:function(){return this.get("country");},getImageUrl:function(){var a=this.get("imageUrl");if(a&&a.indexOf("_t.jpg")!=-1){a=a.replace("_t.jpg","_l.jpg");}return a;},getDestinationImageUrl:function(){var b="http://media.expedia.com/media/content/expuk/Images/deals/destinations/w456/",c="http://media.expedia.com/media/content/expuk/Images/deals/destinations/w456/default.jpg",a=this.getHotelCity();if(typeof a=="string"&&a!=""){a=a.replace(/ /g,"");a=a.toLowerCase();return b+a+".jpg";}else{return c;}},getThumbnailUrl:function(){return this.get("imageUrl");},getStarRating:function(){return this.get("starRating");},getStarRatingClass:function(){var a=this.get("starRating");if(a>0){return a.replace(".","-");}},getGuestRating:function(){var a=this.get("guestRating");if(a>0){return a.toFixed(1);}},getReviewTotal:function(){return this.get("reviewTotal");},getTotalPrice:function(){return Math.round(this.get("totalPrice"));},getAveragePrice:function(){return Math.round(this.get("averagePrice"));},getPrice:function(){return Math.round(this.get("price"));},getCrossOutPrice:function(){return this.get("crossOutPrice");},getPercentSavings:function(){return this.get("percentSavings");},getNumberOfPeopleViewing:function(){return this.get("numberViewing");},getPromotionDescription:function(){return this.get("promotionDescription");}});var GMTPackageModel=Backbone.Model.extend({initialize:function(){_.bindAll(this);},getIndex:function(){return this.get("index");},getDestinationTla:function(){return this.get("destTla");},getDestinationCity:function(){if(typeof this.get("destCity")==="string"){return this.get("destCity")+" ";}else{return"";}},getDestinationCountry:function(){return this.get("destCountry");},getDestinationProvince:function(){return this.get("destProvince");},getOriginTla:function(){return this.get("originTla");},getOriginCity:function(){if(typeof this.get("originCity")==="string"){return this.get("originCity")+" ";
}else{return"";}},getOriginCountry:function(){return this.get("originCountry");},getOriginProvince:function(){return this.get("originProvince");},getHotelCity:function(){return this.get("hotelCity");},getHotelDestination:function(){return this.get("hotelDestination");},getHotelProvince:function(){return this.get("hotelProvince");},getPrice:function(){return Math.round(this.get("perPsgrPackagePrice"));},getHotelOnlyPrice:function(){return Math.round(this.get("hotelTotalRate"));},getFlightDeepLink:function(){return unescape(this.get("flightSearchUrl"));},getHotelDeepLink:function(){return unescape(this.get("hotelInfositeUrl"));},getDealDeepLink:function(){return unescape(this.get("packageSearchUrl")+"&stop_mobi=yes");},getSimilarDeepLink:function(){return unescape(this.get("packageSearchResultUrl"));},getHotelName:function(){return this.get("hotelName");},getTruncatedHotelName:function(b){var a=this.get("hotelName");if(a.length>35){a=a.substring(0,35).split(" ").slice(0,-1).join(" ")+"...";}return a;},getImageUrl:function(b){var a=this.get("imageUrl");if(a&&a.indexOf("_t.jpg")!=-1){a=a.replace("_t.jpg","_l.jpg");}return a;},getDestinationImageUrl:function(){var b="http://media.expedia.com/media/content/expuk/Images/deals/destinations/w456/",c="http://media.expedia.com/media/content/expuk/Images/deals/destinations/w456/default.jpg",a=this.getHotelCity();if(typeof a=="string"&&a!=""){a=a.replace(/ /g,"");a=a.toLowerCase();return b+a+".jpg";}else{return c;}},getImageUrl_t:function(){return this.get("hotelImageUrl");},getLengthOfStay:function(){return this.get("lengthOfStay");},getPackageSavings:function(){return Math.round(this.get("perPsgrSavings"));},getStarRating:function(){return this.get("starRating");},getStarRatingClass:function(){var a=this.get("starRating");if(a>0){return a.replace(".","-");}},getGuestRating:function(){var a=this.get("guestRating");if(a>0){return a.toFixed(1);}},getReviewTotal:function(){return this.get("reviewTotal");},getCheckInDate:function(){return this.get("startDate");},getCheckOutDate:function(){return this.get("endDate");},getHotelPromotionDescription:function(){return this.get("hotelPromotionDescription");},getPackagePromotionDescription:function(){return this.get("packagePromotionDescription");}});var GMTFlightModel=Backbone.Model.extend({initialize:function(){_.bindAll(this);},getIndex:function(){return this.get("index");},getOriginCity:function(){return this.get("originCity");},getDestinationCity:function(){return this.get("destCity");},getPrice:function(){return Math.round(this.get("flightPerPsgrBaseFarePlusTax"));},getTotalPrice:function(){return Math.round(this.get("flightPerPsgrTotalPrice"));},getTripType:function(){return this.get("tripType");},getDealDeepLink:function(){return unescape(this.get("flightSearchUrl"));},getDepartureAirport:function(){return this.get("originTla");},getDestinationAirport:function(){return this.get("destTla");},getCheckInDate:function(){return this.get("startDate");},getCheckOutDate:function(){return this.get("endDate");},getFlightDealCarrier:function(){var a=this.get("flightDealCarrier");if(typeof a=="string"&&a!=""){a=a.toUpperCase();a=a.replace(/ /g,"");if(a.indexOf(",")!=-1){return"/static/default/default/images/flight/multiple_airlines_logo.png";}else{return"http://media.expedia.com/media/content/expus/graphics/static_content/fusion/v0.1b/images/airlines/"+a+".gif";}}else{return"/static/default/default/images/flight/multiple_airlines_logo.png";}}});var LmdModule=(function(){var j=[],e=[],g=[],h=$(".promo-deals-module")||[],f=Backbone.Collection.extend({initialize:function(s,r){r.obj?this.obj=r.obj:null;},model:function(s,r){switch(r.lob){case"hotel":return new GMTHotelModel(s,r);break;case"package":return new GMTPackageModel(s,r);break;case"flight":return new GMTFlightModel(s,r);break;case"thirdpartypackage":return new GMTPackageModel(s,r);break;}},comparator:function(r){if(this.obj.sortDealsByPrice=="1"){return r.getPrice();}else{return false;}}}),d=Backbone.View.extend({initialize:function(r){r.obj?this.obj=r.obj:{};_.bindAll(this);},template:function(r){if(this.obj.lob=="thirdpartypackage"){return this.obj.tpls["packageslideandtiletpl"](r);}else{return this.obj.tpls[this.obj.lob+"slideandtiletpl"](r);}},render:function(){var r=this,v=r.collection,t=r.template,s=r.obj,u=[];o(v,s);if(v.length>0){u.push(t(v));$(u.join("")).appendTo(s.el);uitk.publish("gmt.contentLoaded",s);}}}),o=function(u,s){var t=[],r;$.each(u.models,function(w,v){if(s.lob=="hotel"){t.push(Math.round(parseFloat(v.attributes.price)));v.attributes.packageSearchResultUrl=n(v,"package");v.attributes.hotelSearchResultUrl=n(v,"hotel");}else{if(s.lob=="package"){t.push(Math.round(parseFloat(v.attributes.perPsgrPackagePrice)));v.attributes.packageSearchResultUrl=n(v,"package");v.attributes.hotelSearchResultUrl=n(v,"hotel");}else{if(s.lob=="thirdpartypackage"){t.push(Math.round(parseFloat(v.attributes.perPsgrPackagePrice)));}else{if(s.lob=="flight"){t.push(Math.round(parseFloat(v.attributes.flightPerPsgrBaseFarePlusTax)));}}}}v.dealsRfrr=s.dealsRfrr;v.groupIndex=s.groupIndex;v.sliderIndex=s.sliderIndex;v.index=w;if(w==u.length-1){r=q(t,s);p(r,s);v.isLast="true";}});return u;},n=function(t,y){var s="",x=t.attributes.hasOwnProperty("city")?t.attributes.city.replace(/,/g,", "):t.attributes.destCity.replace(/,/g,", "),v=t.attributes.hasOwnProperty("tla")?t.attributes.tla:t.attributes.destTla,u=t.attributes.hasOwnProperty("originTla")?t.attributes.originTla:"",r=globalUtils.formatDate(t.attributes.startDate),w=globalUtils.formatDate(t.attributes.endDate);switch(y){case"package":s="/packagesearch?ttla="+v+"&ftla="+u+"&destination="+x+"&fromDate="+r+"&toDate="+w+"&NumRoom=1&NumAdult=2&SortBy=10&HotelClass=30";return s;break;case"hotel":s="/go?type=Hotel-Search&destination="+x+"&startDate="+r+"&endDate="+w+"&adults=2&sort=price&star=30";return s;break;case"thirdpartypackage":var r=r.replace(/\//g,"."),w=w.replace(/\//g,".");s="http://booking.expedia.de/booking/exp/ibe/index.php?"+"GOTO=TTPauschalreisen&lnkloc=lmn_1&lnkcid=100&tab=lmn&showresult=1&StrWizTag=TT_HolidayHome&frbuch=&"+"KID=360010&"+"agent=&org_tla=&formular=2&sortierung=&detail=zielgebiet&rliste=2&zfilter=&backon=1&hostexp=&wzdf=&wzid=&"+"termin="+encodeURI(r)+"&ruecktermin="+encodeURI(w)+"&dauer="+encodeURI(t.attributes.lengthOfStay)+"&zimmer=-1&erwachsene="+encodeURI("25;25")+"&alter1="+"&alter2="+"&alter3="+"&alter4=-1&alter5=-1&alter6=-1&alter7=-1&alter8=-1&hbfges=0&hbfanz=0&hbfempf=0&kategorie=-1&shotel=&typ=-1&preis=-1&verpflegung=-1&sportangebot=-1&marke=-1&"+"wizardSubmit.x=23&wizardSubmit.y=4"+"&lcfilter="+encodeURI("513;0");return s;break;default:return"";}},q=function(t,r){var s=function(v,u){return(v-u);};t.sort(s);t[0]=globalUtils.formatPrice(t[0]);return t[0];},p=function(s,r){if(r.DOMC.sliderTitle.length>0){var t=r.DOMC.sliderTitle.html();t=t.replace("###",s);r.DOMC.sliderTitle.html("").html(t);}else{return false;}},m=function(r){$(r).hide();},b=function(r,s){if(s=="start"){}else{$(r).removeClass("loading");}},i=function(r){$(r).children(".promo-deals-module-title-wrapper").show();},k=function(){uitk.subscribe("gmt.failedResponse",function(s,r){m(r.el);});uitk.subscribe("gmt.contentLoaded",function(s,r){b(r.el,"stop");i(r.el);r.getDOMC(function(){r.DOMC.contentSlider.uitk_contentSlider();globalUtils.equalHeights($(r.el).find(".tile-grid"));});});},a=function(r,s){$.ajax({url:r,dataType:"jsonp",success:s});},l=function(){k();if(h.length>0){$.each(h,function(s,r){j[s]=new c({el:r,groupIndex:parseInt($(r).attr("data-group-index")),sliderIndex:parseInt($(r).attr("data-slider-index")),dealsRfrr:$(r).attr("data-deals-rfrr"),lob:$(r).attr("data-lob"),locale:$(r).attr("data-locale"),url:$(r).attr("data-url"),sortDealsByPrice:$(r).attr("data-sortDealsByPrice"),useAveragePrice:$(r).attr("data-use-average-price")==="true"?true:false,minOfferThreshold:$(r).attr("data-min-offer-threshold-percentage")});});}},c=function(r){var s=this;s.debug=(r.jsDebug=="true")?true:false;
s.oldIE=$("html").hasClass("lt-ie9")?true:false;s.host=window.location.host;s.DOMC={};s.tpls={};s.el=r.el;s.groupIndex=r.groupIndex;s.sliderIndex=r.sliderIndex;s.dealsRfrr=r.dealsRfrr;s.lob=r.lob.toLowerCase();s.locale=r.locale;s.sortDealsByPrice=r.sortDealsByPrice;s.useAveragePrice=r.useAveragePrice;s.minOfferThreshold=(r.minOfferThreshold!="")?r.minOfferThreshold:0;s.url=r.url;s.getDOMC();s.bindEvents();s.getModuleTemplates();a(s.url,function(v){var t={},w={},u=OfferServiceAdapter.parse(v,{useAveragePrice:s.useAveragePrice,minOfferThreshold:s.minOfferThreshold});if(u.length>0){w=new f(u,{lob:s.lob,obj:s}),t=new d({el:s.el,collection:w,obj:s});t.render();e.push(w);g.push(t);}else{uitk.publish("gmt.failedResponse",s);}});};c.prototype.getDOMC=function(s){var r=this;r.DOMC={tpls:$(".promo-deals-module-tpl"),contentSliders:$(".content-slider"),contentSlider:$(r.el).children(".content-slider"),contentSliderMask:$(r.el).find(".content-slider-mask"),contentSliderTileGrid:$(r.el).find(".tile-grid"),contentSliderTiles:$(r.el).find(".tile-content"),contentSliderTileFooters:$(r.el).find(".tile-footer"),loader:$(r.el).children(".loader"),headerWrapper:$(".header-wrapper"),toTopLink:$("#toTop"),sliderTitleWrapper:$("#promo-deals-module-"+r.groupIndex+"-"+r.sliderIndex+"-title-wrapper"),sliderTitle:$("#promo-deals-module-"+r.groupIndex+"-"+r.sliderIndex+"-title"),offersWrapper:$("#offers-wrapper")};if(typeof s=="function"){s();}};c.prototype.updateTracking=function(z,B){var t=this,s=Math.floor(t.DOMC.contentSliderMask.width()/$(z[0]).width()),A=1,u=1;if(t.debug){console.info("promo-deals-module - "+t.sliderIndex+": updateing tracking ids | calculating no. of tiles on current page | mask width = "+t.DOMC.contentSliderMask.width()," tile width = "+$(z[0]).width()," No. of tiles on page = "+Math.floor(t.DOMC.contentSliderMask.width()/$(z[0]).width()));}$.each(z,function(C){if(C>0&&C%s==0){u=1;A++;}$.each($(this).children("a"),function(E){var D="",G="",F=y($(this).attr("href"),"rfrr");if(typeof F=="string"&&F!=""){G=F.lastIndexOf(".");D=F.substring(G+1);D=(isNaN(parseInt(D)))?D:"";}if($(this).attr("href").indexOf(t.dealsRfrr)==-1){v($(this),D);}else{x($(this),D);}});u++;});function w(C,H){var F=C.split("?"),G,E,D;if(F.length>=2){G=encodeURIComponent(H)+"=";E=F[1].split(/[&;]/g);for(D=E.length-1;D>0;D--){if(E[D].lastIndexOf(G,0)!==-1){E.splice(D,1);C=F[0]+"?"+E.join("&");}}}return C;}function y(D,J){if(D.indexOf(J)!=-1){var C="",F="",I="";if(D.indexOf("?")!=-1){C=D.split("?");F=C[0];C=C[1];}var G=C.split("&");for(var E=0;E<G.length;E++){var H=G[E].split("=");if(H[0]==J&&H[1]!=""){return H[1];}}}}function r(C,H,G){if(G.indexOf(C)!=-1){var I="",J,L=[],K;if(G.indexOf("?")!=-1){I=G.split("?");K=I[0];I=I[1];}var D=I.split("&");for(var F=0;F<D.length;F++){var E=D[F].split("=");if(E[0]==C&&H!=null){if(H==""){J="";}else{J=E[0]+"="+H;L.push(J);}}else{L.push(E.join("="));}}return K+"?"+L.join("&");}else{return G;}}function v(E,D){var C="",F=E.attr("href");C="."+A+"."+u;if(D!=""){F=F+"&rfrr="+t.dealsRfrr+C+"."+D;}else{F=F+"&rfrr="+t.dealsRfrr+C;}E.attr("href",F);}function x(D,C){var E=r("rfrr","",D.attr("href"));D.attr("href",E);v(D,C);}};c.prototype.getModuleTemplates=function(){var r=this;$.each(r.DOMC.tpls,function(){var t=$(this).attr("id"),s=$(this).html();r.tpls[t.replace(/-/g,"")]=Handlebars.compile(s);});};c.prototype.bindEvents=function(){var r=this;r.DOMC.toTopLink.on("click touchend",function(v){var u;if(!r.clicked){r.clicked=true;v.preventDefault();var s=r.DOMC.headerWrapper.offset();$(document).scrollTop(s.top);$(this).blur();}else{return false;}u=setTimeout(function(){r.clicked=false;},600);});uitk.subscribe("windowOrientationchange",function(){if($(r.el).is(":visible")){globalUtils.equalHeights(r.DOMC.tileGrid);}});uitk.subscribe("windowResize",function(){if($(r.el).is(":visible")){globalUtils.equalHeights(r.DOMC.tileGrid);}});uitk.subscribe("windowScroll",function(){var u=$(this),t=u.scrollTop(),s=r.DOMC.headerWrapper.offset();if(t>s.top){r.DOMC.toTopLink.css({"right":"10px","position":"fixed"});}else{r.DOMC.toTopLink.css({"right":"10000px","position":"absolute"});}});$(r.el).find(".content-slider-controls button").live("click",function(u){var s=$(this),t=parseInt(s.parents(".content-slider").attr("data-current-page"));if(typeof dctk!="undefined"&&dctk.hasOwnProperty("omtr")){if(s.hasClass("next")){dctk.trackAction(r.dealsRfrr+"controls.next",this,{});}else{if(s.hasClass("prev")){dctk.trackAction(r.dealsRfrr+"controls.prev",this,{});}else{dctk.trackAction(r.dealsRfrr+"controls.paging",this,{});}}}else{if(typeof window.s_exp_trackClick!="undefined"){if(s.hasClass("next")){s_exp_trackClick(this,"a",r.dealsRfrr+"controls.next");}else{if(s.hasClass("prev")){s_exp_trackClick(this,"a",r.dealsRfrr+"controls.prev");}else{s_exp_trackClick(this,"a",r.dealsRfrr+"controls.paging");}}}}});uitk.subscribe("countdown.finished",function(s,v){var y=$(v.countdown),x=y.attr("data-sale-ended-content"),w=y.attr("data-has-started");if(w=="false"){var u=setTimeout(function(){window.location.reload();clearTimout(u);},5000);}else{if(x!=""){uitk.publish("gmt.failedResponse",r);if($("#offerEndContent").length==0){x=unescape(x);var z='<div id="offerEndContent" class="col">'+x+"</div>";$(z).appendTo($(".offer-grp",r.DOMC.offersWrapper).eq(0));}}else{uitk.publish("gmt.failedResponse",r);}}});uitk.subscribe("contentSlider.pageChange",function(t,v,s){var u=v.parent();if(u.hasClass("promo-deals-module")){r.updateTracking(r.DOMC.contentSliderTiles);if(r.DOMC.contentSliderTileFooters.length>0){r.updateTracking(r.DOMC.contentSliderTileFooters);}}});};return{init:l,moduleInstances:j,collections:e};})();$(function(){var s=$("#countdown"),m=s.attr("data-test")=="true"?100:1000,u=$("#countdown .mask"),f=$(".ended",u),h=$(".secs .d",u),l=$(".mins .d",u),z=$(".hrs .d",u),j=$(".days .d",u),x=$(".lbl",u),d=$(".cta",u),i=h.html(),o,r=l.html(),k=z.html(),q=j.html(),e=$(".lblDays",u),y=$(".lblDay",u),B=$(".lblHrs",u),b=$(".lblHr",u),g=$(".lblMins",u),w=$(".lblMin",u),c=$(".lblSecs",u),A=$(".lblSec",u),p=true;function n(C){if(C.toString().length===1){C="0"+C;}return C;}function t(D,C,E){if(E==="01"){D.addClass("hidden");C.removeClass("hidden");}else{C.addClass("hidden");D.removeClass("hidden");}}function a(){$(".secs",u).hide();$(".mins",u).hide();$(".hrs",u).hide();$(".days",u).hide();x.hide();d.hide();f.css("display","block");p=false;uitk.publish("countdown.finished",{countdown:s});}function v(){if(p){var C=setTimeout(function(){i=parseInt(i,10);if(i!==0){o=i--;o=n(i);if(i===0){r=parseInt(r,10);if(r!==0){r--;if(r===0){k=parseInt(k,10);if(k!==0){k--;if(k===0){q=isNaN(q)?0:q;q=parseInt(q,10);if(q!==0){q--;if(q===0||isNaN(q)){j.hide();k=23;}else{k=0;}}r=59;q=n(q);j.html(q);t(e,y,q);}}else{o=i=59;}k=n(k);z.html(k);t(B,b,k);}r=n(r);}else{if((k==="00"||k===0)&&(j.length==0||q==="00")){a(C);}else{q=isNaN(q)?0:q;q=parseInt(q,10);k=parseInt(k,10);if(q!==0){if(k===0){q--;}if(q===0||isNaN(q)){j.hide();}}if((q===0||isNaN(q))&&k>0){k--;}else{k=23;}r=59;q=n(q);j.html(q);k=n(k);z.html(k);t(e,y,q);}}r=n(r);l.html(r);t(g,w,r);}}else{o=i=59;}h.html(o);t(c,A,o);v();},m);}}v();});var OffersPagination=(function(){var b={length:0},c=$(".promo-deals-module").length,d=function(e){if(typeof e=="object"){b[e.i]=new a(e);b.length++;}},a=function(e){var f=this;f.tpls=f.DOMC=f.options={};f.paginationHtml=[];f.paginationDone=false;f.options=e;f.getDOMC();f.getTemplate(f.DOMC.tplTag);if(!f.paginationDone){f.render();f.paginationDone=true;}};a.prototype.getDOMC=function(f){var e=this;e.DOMC={tplTag:$(".gmt-pagination-tpl"),paginationWrapper:$("#pagination-wrapper-"+e.options.i)};if(typeof f=="function"){f();}};a.prototype.getTemplate=function(e){var g=this,h=e.attr("id"),f=e.html();g.tpls[h.replace(/-/g,"")]=Handlebars.compile(f);};a.prototype.render=function(){var e=this;e.paginationHtml.push(e.tpls.paginationtpl(e.options));$(e.paginationHtml.join("")).appendTo(e.DOMC.paginationWrapper);$("#"+e.options.paginationId).uitk_pagination();if(b.length==(c-1)){uitk.publish("gmt.history.init");
}e.DOMC.paginationWrapper.children(".pagination").on(uitk.clickEvent,function(l){if($(this).is(":visible")){var k=l.target,f=$(l.target),j=k.nodeName.toLowerCase(),g=$(this).attr("data-tracking-rfrr");switch(true){case (j=="span"):if(typeof dctk!="undefined"&&dctk.hasOwnProperty("omtr")){dctk.trackAction(g+".Pagination."+f.text(),k,{});}else{if(typeof window.s_exp_trackClick!="undefined"){s_exp_trackClick(k,"a",g+".Pagination."+f.text());}}break;case (j=="button"||j=="abbr"):var i=(function(){if(j=="abbr"){f=f.parent("button");}if(f.hasClass("pagination-next")){return"Next";}else{if(f.hasClass("pagination-prev")){return"Prev";}}})();if(typeof dctk!="undefined"&&dctk.hasOwnProperty("omtr")){dctk.trackAction(g+".Pagination"+i,k,{});}else{if(typeof window.s_exp_trackClick!="undefined"){s_exp_trackClick(k,"a",g+".Pagination."+i);}}break;case (j=="a"):var h=(function(){if(f.hasClass("backToTop")){return true;}else{return false;}})();if(h){if(typeof dctk!="undefined"&&dctk.hasOwnProperty("omtr")){dctk.trackAction(g+".Pagination.Top",k,{});}else{if(typeof window.s_exp_trackClick!="undefined"){s_exp_trackClick(k,"a",g+".Pagination.Top");}}}break;}}});};uitk.subscribe("gmt.pagination.init",function(h,f){var g=b[f.i];if(typeof g!="object"){d(f);}});return{init:d,paginationModules:b};})();var GmtHistory=(function(){var b=[],a=function(){b.push(new _moduleConstructor());};_moduleConstructor=function(c){var d=this;d.firstLoad=true;d.deeplinkedTabIndex="";d.previousPath="";d.currentPath="";d.router=new d.Router({obj:d});Backbone.history.start();};_moduleConstructor.prototype.Router=Backbone.Router.extend({initialize:function(c){this.obj=c.obj;},routes:{"":"handleQuery","*path":"handleQuery"},handleQuery:function(s){var k=this.obj,h=/(&|\?)tab=/;if(k.firstLoad){var d=window.location.href,m=[],j="";if(d.indexOf("#")){m=d.split("#");d=m[0];}if(d.indexOf("?")&&h.test(d)){m=d.split("?");k.deeplinkedTabIndex=l(m[1],"tab");}}var o=$(".offerTabs .tab"),e=o.length>0?(parseInt(o.find("a.on").parent().index())):0,g=o.length,c=(function(){if(k.firstLoad&&k.deeplinkedTabIndex!=""&&l(s,"offertab")==false){return k.deeplinkedTabIndex;}else{if(typeof s=="undefined"){if(k.deeplinkedTabIndex!=""){return k.deeplinkedTabIndex;}else{return 0;}}else{if(l(s,"offertab")!=false){return parseInt(l(s,"offertab"));}else{return 0;}}}})(),r=[],q=$("#pagination-wrapper-"+(c)+" .pagination"),i=q.find("li label.selected input").val(),n=parseInt(q.attr("data-total-pages")),f=(typeof s=="undefined")?0:parseInt(l(s,"page")),p=[];if(o.length>0&&c!="undefined"&&e!=c&&c<=g&&c>0){r=$(".offerTabs .tab a").eq(c);if(r.length>0){r.trigger(uitk.clickEvent+".uitk_tabs");e=c;}}if(q.length>0&&f!="undefined"&&i!=f&&f<=n&&f>0){q.find("li label input").each(function(){if($(this).val()==f){p=$(this).siblings(".pagination-label");}});if(p.length>0){p.trigger(uitk.clickEvent);}else{if(f<=n){p=$('<li><label class="check"><input type="radio" value="'+f+'" name="page" class="masked"><span class="pagination-label">'+f+"</span></label></li>");p.appendTo(q.find("ul"));q.find("li label input").each(function(){if($(this).val()==f){p=$(this).siblings(".pagination-label");}});p.trigger(uitk.clickEvent);}}}uitk.subscribe("filter.contentReady",function(){if(typeof s!="undefined"){var t;if(s.indexOf("country")>-1){t=l(s,"country");if(t!="-1"){$("#select-country-tab-"+e).val(t).trigger("change");}}if(s.indexOf("city")>-1){t=l(s,"city");if(t!="-1"){$("#select-city-tab-"+e).val(t).trigger("change");}}if(s.indexOf("destCity")>-1){t=l(s,"destCity");if(t!="-1"){$("#select-destCity-tab-"+e).val(t).trigger("change");}}if(s.indexOf("originCity")>-1){t=l(s,"originCity");if(t!="-1"){$("#select-originCity-tab-"+e).val(t).trigger("change");}}}});function l(x,t){var v=new RegExp("&?"+t+"=");if(v.test(x)){var y=[],w=[];if(x.indexOf("&")==-1){w.push(x);}else{w=x.split("&");}for(var u=0;u<w.length;u++){var y=w[u].split("=");if(y[0]==t&&y[1]!=null){return y[1];}}}else{return false;}}}});uitk.subscribe("gmt.history.init",function(d,c){if(b.length==0){a(c);}else{return false;}});uitk.subscribe("tab.selected",function(c,d){if(typeof b[0]=="object"){if(d.index()>=0){b[0].previousPath=window.location.hash;if(b[0].firstLoad){b[0].router.navigate("offertab="+(d.index())+"&page=1");}b[0].firstLoad=false;if(!b[0].firstLoad&&b[0].previousPath!=""){b[0].router.navigate("offertab="+(d.index())+"&page=1");}b[0].currentPath=window.location.hash;if(b[0].previousPath==""&&b[0].currentPath==""){b[0].firstLoad=true;}}}});uitk.subscribe("pagination.pageChanged",function(f,d){if(typeof b[0]=="object"){var c=parseInt($(".pagination:visible").attr("data-tab-index"));if(d.pageNumber>=1){b[0].previousPath=window.location.hash;if(b[0].firstLoad){b[0].router.navigate("offertab="+c+"&page="+d.pageNumber);}b[0].firstLoad=false;if(!b[0].firstLoad&&b[0].previousPath!=""){b[0].router.navigate("offertab="+c+"&page="+d.pageNumber);}b[0].currentPath=window.location.hash;if(b[0].previousPath==""&&b[0].currentPath==""){b[0].firstLoad=true;}}}});uitk.subscribe("filter.history.init",function(h,f){var i=f.filters,d=f.filterBy,g=f.el;if(typeof b[0]=="object"){var c=parseInt(g.attr("data-tab-index"));b[0].previousPath=window.location.hash;if(b[0].firstLoad){b[0].router.navigate("offertab="+c+"&"+d+"="+i[d]);}b[0].firstLoad=false;if(!b[0].firstLoad&&b[0].previousPath!=""){b[0].router.navigate("offertab="+c+"&"+d+"="+i[d]);}b[0].currentPath=window.location.hash;if(b[0].previousPath==""&&b[0].currentPath==""){b[0].firstLoad=true;}}});return{init:a,historyModule:b};})();var OffersSorting=(function(){var b={length:0},c=$(".promo-deals-module").length,d=function(e){if(typeof e=="object"){b[e.i]=new a(e);b.length++;}},a=function(e){var f=this;f.tpls=f.DOMC=f.options={};f.sortingHtml=[];f.sortingDone=false;f.options=e;f.getDOMC();f.getTemplate(f.DOMC.tplTag);if(!f.sortingDone){f.render();f.sortingDone=true;}f.bindEvents();globalUtils.makeElementSticky($(".addon-container"));};a.prototype.getDOMC=function(f){var e=this;e.DOMC={tplTag:$(".gmt-sorting-tpl"),addonContainer:$("#addon-container-"+e.options.i),sortingContainer:$("#sorting-container-tab-"+e.options.i),sortingSelect:$("#sorting-select-tab-"+e.options.i)};if(typeof f=="function"){f();}};a.prototype.getTemplate=function(e){var g=this,h=e.attr("id"),f=e.html();g.tpls[h.replace(/-/g,"")]=Handlebars.compile(f);};a.prototype.render=function(){var e=this;e.sortingHtml.push(e.tpls.sortingtpl(e.options));$(e.sortingHtml.join("")).appendTo(e.DOMC.addonContainer);e.getDOMC(function(){e.tplConfig=(function(){var g=e.DOMC.sortingContainer.attr("data-tpl-config"),h=[],i,f={};if(typeof g!="undefined"){if(g.indexOf("|")!=-1){h=g.split("|");}else{h=[g];}}if(h.length>0){$.each(h,function(j){i=[];i=h[j].split(":");f[i[0]]=i[1];});}return f;})();});};a.prototype.bindEvents=function(){var e=this;e.DOMC.sortingSelect.on("change",function(){uitk.publish("gmt.sorting.change",{defaultSorting:$(this).val()});var f=$(this).children(":selected").text().replace(/:/g,"").replace(/[ \-]/g,".").toLowerCase();if(typeof dctk!="undefined"&&dctk.hasOwnProperty("omtr")){dctk.trackAction(document.getElementById("pageId").value+".Sort."+f,this,{});}else{if(typeof window.s_exp_trackClick!="undefined"){window.s_exp_trackClick(this,"a",document.getElementById("pageId").value+".Sort."+f);}}});uitk.subscribe("filter.done",function(g,f){if(f.filteredCollection.length<2){e.DOMC.sortingContainer.addClass("hidden");}else{e.DOMC.sortingContainer.removeClass("hidden");}});};uitk.subscribe("gmt.sorting.init",function(h,f){var g=b[f.i];if(typeof g!="object"){d(f);}});return{init:d,sortingModules:b};})();
/*!  generated on 2014-06-06 01:05:31.469 PDT(-0700) in 31 ms  */

/*!  served in 16 ms  */
