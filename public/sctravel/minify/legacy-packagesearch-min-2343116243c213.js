var _interstitial=null;var formController=null;var timerState=null;var TIMER_INTERVAL=1500;var UNAVAILABLE_PAGE="/503-Service-Unavailable";var AJAX_TIMEOUT=60000;var firstReq=null;var currentSavedState=null;var rendered=false;var domReady=false;var ajaxError=false;var savedState=null;var visibleAreas=10;var totalResultsCount=0;var DX_COOKIE_NAME="DXPreferred";var getPackagesToken=null;var ajaxRequestType="";var originalstate="";var getPackagesURI="/getpackages/v1";var jsonVersionSuffix="_V1";var unpricedTravelAdHotels=[];var featuredDealState="";var trackABTests=[];var urgencyTime;var destinationUrgencyTime;var destinationViewCount;var destinationUrgencyCity;var destinationUrgencyReady;var staticDestinationUrgency=false;var allInclusiveBannerDismissed=false;uitk.subscribe("getPackages",pkg.page.updateTemplates);uitk.subscribe("templates",pkg.page.resultsInterstitial);function preProcessGetPackagesResponse(h,c,e){var m=0;var j=0;if(h&&h.packageResult&&h.packageResult.packageOfferModels&&h.packageResult.packageOfferModels.length){var f=h.packageResult;for(var d=0;d<f.packageOfferModels.length;d++){preProcessOffer(f,f.packageOfferModels[d],d,h.pageData.hotelNoPhotoURL);if(f.packageOfferModels[d].price&&f.packageOfferModels[d].price.packageTotalPrice){if(f.packageOfferModels[d].price.hotelPrice){j++;}else{m++;}}}if(f.currentSelectedOffer){preProcessOffer(f,f.currentSelectedOffer,0,null);}if(f.travelAdPackageOfferModels){if(c){unpricedTravelAdHotels=[];}for(d=0;d<f.travelAdPackageOfferModels.length;d++){preProcessTravelAdOffer(f,f.travelAdPackageOfferModels[d],d,h.pageData.hotelNoPhotoURL,c);}}if(f.packageOfferModels[0].hotel.walkabilityScore){h.pageData.walkabilityTreatment=f.packageOfferModels[0].hotel.walkabilityScore.treatment;}if(h.pageData&&h.pageState){var a=h.pageData.hotelAmenityList;var b=h.pageState.selectedAmenities;if(a){a.accessibilityOptionList=setSelectedAmenityOptions(a.accessibilityOptionList,b);a.amenityOptionList=setSelectedAmenityOptions(a.amenityOptionList,b);}}h.packagePageInput.filteredDestination=getFilteredRegionName(h);}if(h&&h.pageData&&h.siteAnalyticsModel&&h.siteAnalyticsModel.travelHookModel){var g=h.siteAnalyticsModel.travelHookModel.travelHookURL;h.siteAnalyticsModel.travelHookModel.travelHookURL="ads=0&"+g;}if(h&&h.pageData&&h.siteAnalyticsModel&&h.siteAnalyticsModel.omnitureModel){if(h.siteAnalyticsModel.omnitureModel.omnitureMap){var l=h.siteAnalyticsModel.omnitureModel.omnitureMap.prop61;var k=e?"Initial":"Non-initial";k+=":NoHotelRef:"+m+":HasHotelRef:"+j;if(l){if(l.indexOf("|",l.length-1)!=-1){l=l+k;}else{l=l+"|"+k;}}else{l=k;}h.siteAnalyticsModel.omnitureModel.omnitureMap.prop61=l;}}}function preProcessTravelAdOffer(c,d,b,a,e){preProcessOffer(c,d,b,a);if(d.incompleteOffer&&e){unpricedTravelAdHotels.push({"hotelId":d.hotelId,"originalOfferIndex":d.offerIndex});}}function preProcessOffer(e,f,c,b){f.offerIndex=c;if(e.hotels&&f.hotel){f.hotel=e.hotels[f.hotel];if(f.hotel.hotelStarRating){if(f.hotel.hotelStarRating.indexOf(".")<0){f.hotel.hotelStarRating+=".0";}f.hotel.hotelStarRatingWithDash=f.hotel.hotelStarRating.replace(".","-");}if(f.hotel.overallReview){f.hotel.overallReviewWithDash=f.hotel.overallReview.toString();if(f.hotel.overallReviewWithDash.indexOf(".")<0){f.hotel.overallReviewWithDash+=".0";}f.hotel.overallReviewWithDash=f.hotel.overallReviewWithDash.replace(".","-");}if(f.hotel.thumbnailURL){if(f.hotel.thumbnailURL.indexOf("_e.")>0){f.hotel.smallThumbnailURL=f.hotel.thumbnailURL.replace("_e.","_t.");}else{if(f.hotel.thumbnailURL.indexOf("_l.")>0){f.hotel.smallThumbnailURL=f.hotel.thumbnailURL.replace("_l.","_t.");}}}else{f.hotel.smallThumbnailURL="";}f.hotel.noPhotoURL=b;if(f.hotel.ratePlanAmenities){for(var d=0;d<f.hotel.ratePlanAmenities.length;d++){if(f.hotel.ratePlanAmenities.id==512){f.hotel.isSelectedAllInclusive=true;f.isSelectedAllInclusive=true;}}}}else{f.hotel=null;}if(e.flights&&f.flight){f.flight=e.flights[f.flight];if(f.flight.flightLegs&&f.flight.flightLegs.length>0){f.flight.flightLegs[f.flight.flightLegs.length-1].isLastRow=true;f.flight.airBookingProviderCode=f.flight.flightLegs[0].airBookingProviderCode;f.flight.flightFareTypeString=f.flight.flightLegs[0].flightFareTypeString;if(f.price){var a=false;for(var d=0;d<f.flight.flightLegs.length;d++){if(f.flight.flightLegs[d].freeFlightPromotion){a=true;break;}}f.price.freeFlightPromotion=a;}}}else{f.flight=null;}if(e.cars&&f.car){f.car=e.cars[f.car];}else{f.car=null;}}function getFilteredRegionName(d){var c=d.pageState.selectedRegionId;var a=d.pageData.regionList;if(a){for(var b in a){var e=a[b];if(e.id==c){return e.name;}}}else{return d.packagePageInput.destination;}}function setSelectedAmenityOptions(a,d){for(var b in a){var c=a[b];c.isSelected=($.inArray(c.id,d)>-1);}return a;}function trackTests(a,b){trackABTests.push(a+"."+b);}function trackInFrameTests(){var b=document.querySelectorAll(".in-frame-evar");for(var a=0;a<b.length;a++){trackABTests.push(b[a].value);}}function getPackages(){var c=$("#hasErrors").val();var f={};var b=null;if($("#originWasSniffed")&&$("#originWasSniffed").val()){b=$("#originWasSniffed").val();}if(c=="true"){return;}pkg.page.init();var h=jQuery.param.querystring();if(!h){h=$("#"+formController.getWizardFormId.call(formController)).serialize();}if(h.indexOf("originId=")<0){h+="&originId="+formController.getOriginId();}if(h.indexOf("destinationId=")<0){h+="&destinationId="+formController.getDestinationId();}if(h.indexOf("ftla=")<0){h+="&ftla="+formController.getFtla();}if(h.indexOf("ttla=")<0){h+="&ttla="+formController.getTtla();}if(h.indexOf("originSniffed=")<0&&b){h+="&originSniffed="+b;}var e=window.location.pathname.toLowerCase().indexOf("changehotel")>=0;var g=getPackagesURI+"?"+h;if(e&&g.indexOf("pageType=")<0){g=g+"&pageType=CHANGE_HOTEL";}var d=jQuery.bbq.getState();if(d&&!jQuery.isEmptyObject(d)){var a=formController.getSavedResponse.call(formController);if(a){savedState=d;formController.jsonData=a.data;uitk.publish("getPackages","complete");return;}}else{if(!e){$.removeCookie(DX_COOKIE_NAME,{path:"/"});}}firstReq=$.getJSON(g,function(k){formController.saveResponse(k);formController.jsonData=k;if(domReady){updatePage(k,true);clientLogDomLoaded(k);rendered=true;$("#interstitial").css("display","none");var j=$("#siteid")?$("#siteid").val():"";updateReferrerImpressionTracking(k);omniturePostTracking(k);if(k.siteAnalyticsModel){doubleClickTracking(k.siteAnalyticsModel.doubleClickModel);if(k.siteAnalyticsModel.travelHookModel){_initTravelHook(k.siteAnalyticsModel.travelHookModel);}}}}).error(function(j,m,l){if(m=="abort"){return;}ajaxError=true;var k={};k.errors=createAjaxError(j);formController.jsonData=k;if(domReady){$("#interstitial").css("display","none");updateErrorPanel(k,true);rendered=true;}}).complete(function(){firstReq=null;});uitk.publish("getPackages","complete");}function getAllPackages(d){var g=jQuery.param.querystring();if(!g){g=$("#"+formController.getWizardFormId.call(formController)).serialize();}if(g.indexOf("originId=")<0){g+="&originId="+formController.getOriginId();}if(g.indexOf("destinationId=")<0){g+="&destinationId="+formController.getDestinationId();}if(g.indexOf("ftla=")<0){g+="&ftla="+formController.getFtla();}if(g.indexOf("ttla=")<0){g+="&ttla="+formController.getTtla();}if(d.pageData.fsoCall&&g.indexOf("fsoCall=")<0){g+="&fsoCall=1";}var b=getQueryHashFromString(g);b["totalResultsCount"]=d.packageResult.resultCount;if(d.pageData.singleUseToken){b["gapTkn"]=d.pageData.singleUseToken.getAllPackagesToken;}var a=d.pageReferrerId;var g=getQueryStringFromHash(b);var f="/getallpackages?"+g;var e="";var c=d.pageData.poiFilterOptions;if(d.pageState){e=d.pageState.selectedPoiId;}$.ajax({url:f}).done(function(h){getUpdatedTravelAdPrices(g,a);if(c&&c.length>0){getUpdatedPOIData(g,a,e);}}).fail(function(h,j){updateTravelAds(undefined);});}function getUpdatedPOIData(f,a,d){if(a&&f.indexOf("pageType=")<0){if(a=="SR"){f=f+"&pageType=PACKAGE_SEARCH";}else{if(a=="CH"){f=f+"&pageType=CHANGE_HOTEL";
}}}var c=$("#"+formController.getFilterFormId()).serializeArray();for(var b=c.length-1;b>=0;b--){if(!c[b].value||c[b].name=="action"){c.splice(b,1);}}c.push({"name":"action","value":"getPoiData"});var e=getPackagesURI+"?"+f;$.ajax({url:e,traditional:true,data:c}).done(function(k){var j=$("#morePoiFilters");var h=j&&j.is(":visible");var g=0;var l=$("a.poi.selected");if(l.attr("id")){g=l.attr("id").substring(3);}if(g>0){d=g;}renderPoiBCols(k,a,d,h);});}function getUpdatedTravelAdPrices(e,a){if(unpricedTravelAdHotels.length==0){return;}var b=[];for(var c=0;c<unpricedTravelAdHotels.length;c++){b.push(unpricedTravelAdHotels[c].hotelId);}if(a&&e.indexOf("pageType=")<0){if(a=="SR"){e=e+"&pageType=PACKAGE_SEARCH";}else{if(a=="CH"){e=e+"&pageType=CHANGE_HOTEL";}}}var d=getPackagesURI+"?"+e;$.ajax({url:d,traditional:true,data:{action:"getPackagePrice",unpricedAdHotelIds:b}}).done(function(f){updateTravelAds(f);}).fail(function(f,g){updateTravelAds(undefined);});}function updateTravelAds(f){preProcessGetPackagesResponse(f,false,false);var a={};var e;if($("#updateContentListing").length){trackTests("3899",$("#updateContentListing").val());if($("#updateContentListing").val()=="1"){f.pageData["updateContentListingTest"]=true;}}if(f){var g=f.packageResult;if(g&&g.travelAdPackageOfferModels){var b=g.travelAdPackageOfferModels;for(i=0;i<b.length;i++){e=b[i];var d=e.hotelId;a[d]=e;}}}for(i=0;i<unpricedTravelAdHotels.length;i++){var c=unpricedTravelAdHotels[i].hotelId;e=a[c];if(e){e.offerIndex=unpricedTravelAdHotels[i].originalOfferIndex;$("#travelad_offer_"+c).html($("#travelAdOfferTemplate").render(e,{pageData:f.pageData,pageState:f.pageState,pageInput:f.packagePageInput,pageReferrerId:f.pageReferrerId,rank:e.offerIndex+1}));if(e.price&&e.price.packageTotalPrice){$("#flight-info-"+c).css("visibility","visible");}}else{$("#pricePanel_travelAd_"+c).html("");}}}function showInterstitial(){$("#interstitial").css("display","block");}function createAjaxError(b){var a="pkg_ajax_error_"+b.status;var c=[];c.push(a);return c;}$(document).ready(function(){domReady=true;var a=$("#hasErrors").val();if(a=="true"){uitk.unsubscribe("firstCall",pkg.page.updateFirstForms);return;}});function clientLogDomLoaded(b){if(window.performance&&(!b.errors||b.errors.length==0)){var c=(new Date()).getTime()-window.performance.timing.navigationStart;var a="PSR_firstLoadResults";if(b.pageData&&b.pageData.hlrSearch){a=a+"_HLRS";}else{a=a+"_Regular";}if(b.pageState&&b.pageState.readFromCache){a=a+"_Cache";}else{a=a+"_PSS";}a=a+jsonVersionSuffix;expClientLoggingAdapter.logTrxEvent(a,["clEventName01="+a,"clEventTime01="+c]);}}function doubleClickTracking(a){if(typeof(a)!="undefined"){if("undefined"!=typeof(ProductSiteAnalyticsLogger)&&"undefined"!=typeof(ProductSiteAnalyticsLogger.updateDoubleClick)){ProductSiteAnalyticsLogger.updateDoubleClick(a.doubleClickOPMQueryURL,a.doubleClickMSQueryURL);}}}function omnitureTracking(e){var g=$("#eapid").val();var f=$("#tpid").val();var c="expedia"+f;var a="expedia"+f+"-"+g;s_BrandEAPIDTable=new Object();s_BrandEAPIDTable["expedia30035-327"]="327";s_BrandEAPIDTable["expedia30036-392"]="392";s_BrandEAPIDTable["expedia30009-314"]="314";s_BrandEAPIDTable["expedia6-10122"]="10122";s_BrandEAPIDTable["expedia30007-711"]="711";s_BrandEAPIDTable["expedia30007-712"]="712";var d="";if("undefined"!=typeof(s_BrandEAPIDTable["${brandEAPID}"])){d=s_BrandEAPIDTable["${brandEAPID}"];}var b=$("#omnitureAccountPostfix").val();if(!b){b="";}if(d.length>0){d+=b;}else{c+=b;}s_exp_isTest=b.length>0;window.s_account=c;$.getScript("/static/default/default/scripts/siteAnalytics.js").done(function(){if(e){omniturePostTracking(e);}});}function omniturePostTracking(b){if("undefined"!=typeof(ProductSiteAnalyticsLogger)&&"undefined"!=typeof(ProductSiteAnalyticsLogger.updateOmniture)&&"undefined"!=typeof(s_exp)){if(b.siteAnalyticsModel){for(i=0;i<trackABTests.length;i++){var a=trackABTests[i].split(".");b.siteAnalyticsModel.omnitureModel.abTests[a[0]]=a[1];}addMultiBrandedDealImpressions(b);addAllInclusiveTrackingReferrer(b);ProductSiteAnalyticsLogger.updateOmniture(s_exp,b.siteAnalyticsModel.omnitureModel.omnitureMap,b.siteAnalyticsModel.omnitureModel.abTests);}}if("undefined"!=typeof(Vsca)&&"undefined"!=typeof(vsca_pageTag)){vsca_pageTag.contexte=s_exp;window.Vsca.audience.tag_page_async({"id":vsca_pageTag.config.pageId,"vsca_pageTag":vsca_pageTag});}}function addMultiBrandedDealImpressions(f){if(hasOffers(f)){var m="";var n="";var a=0;var o=0;var b=0;var c=0;var j=f.packageResult.packageOfferModels;var l="BDDisplay-";var d=false;var g=j.length;for(var e=0;e<g;e++){var k=j[e];if(k.brandedDealData){var h=k.brandedDealData.dealVariation;if(h=="FreeHotel"){a++;if(k.featuredDeal){l+=e+".H|";d=true;}}else{if(h=="FreeFlight"){o++;if(k.featuredDeal){l+=e+".F|";d=true;}}else{if(h=="FreeOneNightHotel"){c++;if(k.featuredDeal){l+=e+".N|";d=true;}}else{if(h=="HotelDeal"){b++;if(k.featuredDeal){l+=e+".P|";d=true;}}}}}}}if(d){m=l.substring(0,l.length-1);}n="BDCount-T."+g+"|H."+a+"|F."+o+"|P."+b+"|N."+c;f.siteAnalyticsModel.omnitureModel.omnitureMap.prop59=m;f.siteAnalyticsModel.omnitureModel.omnitureMap.prop61=n;}}function addAllInclusiveTrackingReferrer(b){if(b.pageData&&b.pageData.allInclusiveProminanceTreatment>1){var a="PKG.SR.AllInclusiveBannerShown";b.siteAnalyticsModel.omnitureModel.omnitureMap.eVar28=a;b.siteAnalyticsModel.omnitureModel.omnitureMap.prop16=a;}}function _initTravelHook(c){try{var b="";var h=c.travelHookURL;if($("#disableTravelHookAds")[0]){b="TID=12";h=c.travelHookURL.replace("&tid=1","");}else{b="";}var a=trimUnusedTravelHookParams(h);var d=(("https:"==document.location.protocol)?"https://":"http://");var g=document.createElement("script");g.src=d+c.directCallURL+a+b;g.type="text/javascript";g.id="TH_SR_SC";document.getElementsByTagName("head")[0].appendChild(g);}catch(f){}}function trimUnusedTravelHookParams(b){var a=b.replace(/(&to=.*?&)/g,"&");a=a.replace(/(&ppp=.*?&)/g,"&");a=a.replace(/(&tp=.*?&)/g,"&");a=a.replace(/(&str=.*?&)/g,"&");a=a.replace(/00\.00/g,"0");return a;}function _updateTravelHook(a){if(typeof(UpdateTHInsertions)!="undefined"){UpdateTHInsertions(a.travelHookURL);}}function updateErrorPanel(b,a){if(b.errors&&b.errors.length>0){if(a){document.getElementById("interstitial").style.display="none";$("#pfilters").hide();$("#pageTitle").hide();$("#sortbar").hide();$("#travelAds").hide();$("#packageSearchResults").hide();$("#pagination").hide();$("#endOfListingTravelAds").hide();$("#ads-dcol").hide();$("#fromBarCollapsed").hide();$("#hotel-summary").hide();$("#fromBar").removeClass("hide");$("#hotel-details").removeClass("hide");$("#ccFeeDisclaimer").addClass("hide");if(($("#collapseWizard").length>0)&&$("#collapseWizard").val()=="3661.1"){$("aside > #packagewizardM  .content").html($("#searchWizardModal"));$("#searchWizardModal").removeClass("packages-modal");$("aside > #packagewizardM").css("display","block");$("aside > #packagewizardM .content .btn-close").css("display","none");}}$("#jsonErrorPanel").html($("#errorPanelTemplate").render(b));if(b.pageData&&b.pageData.packageAlternateDates){if(b.packagePageInput){b.pageData.packageAlternateDates.directFlight=b.packagePageInput.directFlight;b.pageData.packageAlternateDates.destinationName=b.packagePageInput.destination;}$("#alternateDatesContent").html($("#alternateDatesTemplate").render(b.pageData.packageAlternateDates));}}else{$("#jsonErrorPanel").html("");}}function updateSearchResults(d,e){if($("#boardTypeFilterContainer")){$("#boardTypeFilterContainer").removeClass("hide");}if($("#ccFeeDisclaimer")){$("#ccFeeDisclaimer").removeClass("hide");}$("#travelAds").html($("#contentPaneTravelAds").render(d,{firstLoad:e}));$("#packageSearchResults").html($("#psrResultTemplate").render({packageOfferModels:d.packageResult.packageOfferModels,travelAdPackageOfferModels:d.packageResult.travelAdPackageOfferModels,pageData:d.pageData,pageInput:d.packagePageInput,pageState:d.pageState,pageReferrerId:d.pageReferrerId,hotels:d.packageResult.hotels,firstLoad:e}));
$("#endOfListingTravelAds").html($("#endOfListingTravelAdsTemplate").render(d,{firstLoad:e}));setMinPkgPrice(d.packageResult.packageOfferModels);try{evarList=d.siteAnalyticsModel.omnitureModel.evar39List;prop57List=d.siteAnalyticsModel.omnitureModel.prop57List;}catch(b){}if(d.packageResult.travelAdPackageOfferModels){for(var a=0;a<d.packageResult.travelAdPackageOfferModels.length;a++){var c=d.packageResult.travelAdPackageOfferModels[a];$.ajax({url:c.impressionTrackingUrl,dataType:"jsonp"}).error(function(f,h,g){if(h=="abort"){return;}expClientLoggingAdapter.logTrxEvent("AjaxError",["clEventName01=AjaxError","clEventTime01=0","clEventName02=TravelAdImpressionTrackingFailed","clEventTime02=0"]);});}}}function renderPoiBCols(e,b,c,a){$("#poiBCols").html('<div class="poiBCol clearfix">'+$("#poiBColTemplate").render(e,{pageReferrerId:b,selectedPoiId:c,expandPoi:a})+"</div>");$("#poiBC").show();if($("a.poi4.selected").length||$("a.poi5.selected").length||$("a.poi6.selected").length||$("a.poi7.selected").length){var d=$("#morePoiFiltersLink");if(d&&d.is(":visible")){seeMoreAttractions(d[0]);}}$("#poiId").attr("value",c);$(".poiTitle > p").trunk8({lines:2});}function poiBColFilter(d,e){$("#sortBarTable").find(".poiDistance").show();var c=$("a.poi.selected");var j=0;var f=$(d);var b=f.data("poiid");var h="";if(c){j=c.data("poiid");}if(j>0){c.removeClass("selected");h+=buildPropForPoi59(c[0],"deselect");}if(j==b){$("#poiId").attr("value","");}else{$("#poiId").attr("value",b);f.addClass("selected");h+=buildPropForPoi59(f[0],"select");}var g="";var a=$("input[name='regionFilter']:not(:first):checked");if(a.length){g="PKG."+e+".Refine.Area.DeselectedViaPOIFilter";}else{g="PKG."+e+".Refine.Poi";}a.removeAttr("checked");sendProp59Omniture(h,g);processAJAXRequest({"pageIndex":0,"trackingReferrer":g,"requestType":"poifilter"});}function sendProp59Omniture(b,a){var d=[];d["prop59"]=b;d["eVar28"]=a;d["prop16"]=a;var c={siteAnalyticsModel:{omnitureModel:{omnitureMap:d,abTests:{}}}};ajaxCalledOmnitureTracking(c,formController.getAJAXEvents());}function buildPropForPoi59(b,c){var d=$(b);if(d.length){var a=(d.data("hotelcount")<0)?"NA":d.data("hotelcount");return(d.data("poiindex")+1)+"-"+d.data("poiid")+"-"+a+"-"+c+";";}return"";}function buildPoiProp59Impressions(){var a="";$("a.poi:visible").each(function(b,c){a+=buildPropForPoi59(c,$(c).hasClass("selected")?"selected":"unselected");});return a;}function buildProp59Impressions(a){var b="";b+=buildPoiProp59Impressions();return b;}function updateProp59(a){if(a&&a.siteAnalyticsModel&&a.siteAnalyticsModel.omnitureModel&&a.siteAnalyticsModel.omnitureModel.omnitureMap){var b=buildProp59Impressions(a);a.siteAnalyticsModel.omnitureModel.omnitureMap["prop59"]=b;}}function neighborhoodFilter(b,d){var a="PKG."+b+".Refine.";var c="";var e=$("a.poi.selected");if(d==0){c=a+"Area.Deselected";}else{if(e.length){e.removeClass("selected");$("#poiId").attr("value","");c=a+"POI.DeselectedViaAreaFilter|"+a+"Area";}else{c=a+"Area";}}processAJAXRequest({"pageIndex":0,"trackingReferrer":c,"requestType":"hotelfilter"});}function seeMoreAttractions(a,b){$(a).hide();$("#morePoiFilters").show();sendProp59Omniture(buildProp59Impressions(),b);$(".poiTitle > p").trunk8({lines:2});}function setMinPkgPrice(c){var e=null;for(var d=0;d<c.length;d++){if(c[d].price&&c[d].price.packageTotalPrice){var a=c[d].price.pricePerPerson.amount;if(e==null||a<e){e=a;}}}var b=document.getElementById("minPkgPrice");if(b){b.value=e;}}function updatePageTitle(c){var b=$("#morePoiFilters");var a=b&&b.is(":visible");$("#pageTitle").html($("#pageTitleTemplate").render(c,{allInclusiveBannerDismissed:allInclusiveBannerDismissed}));if(c.pageData.poiFilterOptions&&c.pageData.poiFilterOptions.length>0){renderPoiBCols(c.pageData.poiFilterOptions,c.pageReferrerId,c.pageState.selectedPoiId,a);}}function updateSortBar(a){if(a.pageData.walkabilityTreatment===1){$("#locationScore").show();$("#locationScoreExplanation").show();}else{if(a.pageData.walkabilityTreatment===2){$("#exploreScore").show();$("#exploreScoreExplanation").show();}else{if(a.pageData.walkabilityTreatment===0){$("#footFriendlyScore").show();$("#footFriendlyScoreExplanation").show();}}}$("#sortBarTable").html($("#sortBarTemplate").render(a));if(a.pageState&&a.pageState.selectedSortOrder>=0){document.getElementById(formController.filterFormId).sortOrder.value=a.pageState.selectedSortOrder;}}function updatePagination(a){if(a.pageState.pagination){$("#pagination").html($("#paginationTemplate").render(a));}}function updateAmenityFilter(a){$("#amenityPanel").html($("#amenityFilterTemplate").render(a));}function updateBoardTypeFilter(a){$("#boardTypeFilterContainer").html($("#boardTypeFilterTemplate").render(a));}function updateHotelStarRatingFilter(a){$("#hotelStarRatingFilterPanel").html($("#hotelStarRatingFilterTemplate").render(a));}function updateHotelNeighborhoodFilter(d){if(d.pageData){$("#hotelNeighborhoodFilterPanel").html($("#neighborhoodFilterTemplate").render(d));if(d.pageData.hlrSearch){var c=$("ul#acolNeighborhoodFilter li");var a=c?c.length:0;if(visibleAreas>=a){visibleAreas=a;$("#acolNeighborhoodFilterMore").hide();}showUpToIndex(visibleAreas);$("#acolNeighborhoodFilterMore").click(function(h){h.preventDefault();var g=$("ul#acolNeighborhoodFilter li");var f=g?g.length:0;visibleAreas=visibleAreas+10;if(visibleAreas>f){visibleAreas=f;$("#acolNeighborhoodFilterMore").hide();}showUpToIndex(visibleAreas);});}var b="id_NeighborhoodRegionName"+d.selectedNeighborhoodId;$("input:radio[id="+b+"]").attr("checked",true);}}function updateMapButton(a){$("#srMapButton").html($("#packageSearchResultsMapButtonTemplate").render(a));}function updateMapPoiInfo(c){if(c.pageState.selectedPoiId&&c.pageData.poiFilterOptions){var b;for(var a=0;a<c.pageData.poiFilterOptions.length;a++){var d=c.pageData.poiFilterOptions[a];if(c.pageState.selectedPoiId==d.poiId){b=d;break;}}renderSelectedPoiOnMap(b);}else{renderSelectedPoiOnMap();}}function renderSelectedPoiOnMap(d){var e;var b;var c=$("#titleLegend");if(d){var f={poiId:d.poiId,longitude:d.longitude.toString(),latitude:d.latitude.toString(),poiName:d.poiName};e=d.poiId;b=d.poiName;var a=[f];$("#poiInfoJson").val(JSON.stringify(a));c.removeClass("l5");c.addClass("l3");}else{c.removeClass("l3");c.addClass("l5");$("#poiInfoJson").val("");}$("#mapBubbleList").append($("#selectedPoiMapTemplate").render({poiId:e,poiName:b}));$("#googleMapLegend").html($("#poiLegendItemTemplate").render({poiId:e,poiName:b}));}function updateMapHotelInfoJSONs(b){var d=[];var c=b.packageResult.packageOfferModels;for(var a=0;a<c.length;a++){var e={index:a,hotelId:c[a].hotel.hotelId,lon:c[a].hotel.longitude.toString(),lat:c[a].hotel.latitude.toString(),infoSiteURL:c[a].hotel.infositeURL,htlAvail:"2"};d.push(e);}$("#hotelInfoJSONs").val(JSON.stringify(d));$("#mapBubbleList").empty();$("#mapBubbleList").html($("#packageSearchResultMapTemplate").render(b));}function updateCoalitionJSON(a){$("#coalitionAwardContainer").empty();$("#coalitionAwardContainer").html($("#coalitionSearchAwardTemplate").render(a));formController.publish("formController.events.presults.rendered");}function hasOffers(a){return a&&a.packageResult&&a.packageResult.packageOfferModels&&a.packageResult.packageOfferModels.length>0;}function updatePage(e,f){preProcessGetPackagesResponse(e,true,f);if(hasOffers(e)){if(e.pageData.singleUseToken){getPackagesToken=e.pageData.singleUseToken.getPackagesToken;}if(f){getAllPackages(e);totalResultsCount=e.packageResult.resultCount;if(e.pageData){featuredDealState=e.pageData.featuredDeal;}}updateErrorPanel(e);if(e.errors){var j=e.errors;var k=($.inArray("pkg_relax_star_hotel_filters",j)>=0)||($.inArray("pkg_relax_amenity_filters",j)>=0)||($.inArray("pkg_relax_board_filter",j)>=0)||($.inArray("pkg_relax_board_filter_only",j)>=0)||($.inArray("pkg_relax_POI_filter_SelectedByItself",j)>=0)||($.inArray("pkg_relax_POI_filter_SelectedWithOthers",j)>=0);if(k){updateHotelName("");window.scrollTo(0,0);}}if($("#updateContentListing").length){trackTests("3899",$("#updateContentListing").val());
if($("#updateContentListing").val()=="1"){e.pageData["updateContentListingTest"]=true;}}if($("#removeBookOnline").length){trackTests("3902",$("#removeBookOnline").val());}if($("#reorderFiltersTreatment").length){var m=$("#reorderFiltersTreatment").val();if(m>=0){trackTests("4692",m);}}if($("#openNewTabTreatmentValue").length){var b=$("#openNewTabTreatmentValue").val();if(b>=0){trackTests("4861",b);}}updateSearchResults(e,f);updatePageTitle(e);updateMapHotelInfoJSONs(e);updateMapPoiInfo(e);updateMapButton(e);if(e.pageData){updateSortBar(e);updateHotelNeighborhoodFilter(e);if(e.pageData.standardizeWayFinderTreatment==1){updateStandardizeWayFinderSubTitle(e);}}if(e){updateHotelStarRatingFilter(e);}if(e.pageData.hotelAmenityList){updateAmenityFilter(e);}if(e.pageState&&e.pageState.selectedBoardType>0){updateBoardTypeFilter(e);boardFilterAmenityBold();}if(e.coalitionPackageInfoModel&&e.coalitionPackageInfoModel.coalitionEnabled){updateCoalitionJSON(e.coalitionPackageInfoModel);}updatePagination(e);updateProp59(e);var h=$("#third_party_banner");if(h.length){var c=h.attr("class");var d;if(c==="tpb_top"){d="#pageTitle";trackTests("4378",1);}else{if($("#travelAds").children().length){d="#packageSearchResults > div:nth-child(1)";}else{d="#packageSearchResults > div:nth-child(2)";}trackTests("4378",2);}h.insertAfter(d);h.show();}}else{if(e.errors){var j=e.errors;var a=($.inArray("pkg_hlr_failure",j)>=0)||($.inArray("pkg_hlr_search_unsupported",j)>=0);if(a){var g=window.location.search.substring(1).split("#")[0];g=g+"&disambigDestination=true";window.location=window.location.pathname+"?"+g;return;}var l=$.inArray("pkg_domain_timeout_waiting_full_search_cache",j)>=0;if(l){$("a.poi.selected").removeClass("selected");$("#poiId").attr("value","");return;}}updateErrorPanel(e,true);}if(destinationUrgencyReady==true){showDestinationUrgency();}}function updateSortBarState(a){$("[data-sort]").removeClass("current");$("[data-sort="+a+"]").addClass("current");}function updateHotelName(a){$("#inpHotelNameMirror").val(a);}function applyState(a){if(a.sortOrder){document.getElementById(formController.filterFormId).sortOrder.value=a.sortOrder;updateSortBarState(a.sortOrder);}updateHotelName(a.hotelName);}function Interstitial(){this._bInit=false;this._bModal=false;this._elMod="";this._elModI="";this.interstitialOverlay=null;this.filterMsgTxt="";this.pagMsgTxt="";this.sortMsgTxt="";if($("#primedInterstitialTreatment").length){trackTests("4693",$("#primedInterstitialTreatment").val());}this.showInterstitial=function(b,a){if(b){if(!this._bInit){this._elInt=$("#divInterstitial");this.filterMsgTxt=$("#intMsg");this.pagMsgTxt=$("#intMsg1");this.sortMsgTxt=$("#intMsg2");this.createInterstitialOverlay();this._bInit=true;}if(this._bModal){this.showModal(true);}this._elInt[0].style.display="block";if(a.indexOf("pagination")>=0){this.pagMsgTxt[0].style.display="block";this.filterMsgTxt[0].style.display="none";this.sortMsgTxt[0].style.display="none";}else{if(a.indexOf("sort")>=0){this.sortMsgTxt[0].style.display="block";this.pagMsgTxt[0].style.display="none";this.filterMsgTxt[0].style.display="none";}else{this.sortMsgTxt[0].style.display="none";this.pagMsgTxt[0].style.display="none";this.filterMsgTxt[0].style.display="block";}}this.interstitialOverlay.render();this.interstitialOverlay.show();}else{if(this._bModal){this.showModal(false);}if(this.interstitialOverlay!==null){this.interstitialOverlay.hide();}}};this.createInterstitialOverlay=function(){this.interstitialOverlay=new YAHOO.widget.Overlay(this._elInt[0],{fixedcenter:true,visible:false});};this.showModal=function(c){if(c){var b=0;var b=document.body.scrollHeight||window.scrollHeight;var a=document.body.scrollWidth||window.innerWidth;this._elMod.style.display="block";this._elMod.style.height=b+"px";this._elMod.style.width=a+"px";if(this._elModI!=null){this._elModI.style.display="block";this._elModI.style.height=b+"px";this._elModI.style.width=a+"px";}}else{this._elMod.style.display="none";if(this._elModI!=null){this._elModI.style.display="none";}}};}function AJAXEvents(){this.intDialog=_interstitial;this.reqTimerFlag=false;this.timerState;this.timeout=AJAX_TIMEOUT;this.callStartTime=null;this.getTimerFlag=function(){return this.reqTimerFlag;};this.start=function(b,a){this.reqTimerFlag=true;this.intDialog=_interstitial;this.intDialog.showInterstitial(true,formController.getAJAXRequestType.call(formController));this.callStartTime=(new Date()).getTime();};this.complete=function(a,b){this.callStartTime=null;this.reqTimerFlag=false;window.clearTimeout(timerState);this.intDialog=null;};this.clearOmnitureState=function(a){for(var b=0;b<a.length;b++){delete s_exp[a[b]];}};this.success=function(f,h,d){if(h=="success"){formController.saveResponse(f);updatePage(f,false);if(this.callStartTime){var a="PSR_ajax_"+ajaxRequestType;if(f.pageData&&f.pageData.hlrSearch){a=a+"_HLRS";}else{a=a+"_Regular";}if(f.pageState&&f.pageState.readFromCache){a=a+"_Cache";}else{a=a+"_PSS";}a=a+jsonVersionSuffix;expClientLoggingAdapter.logTrxEvent(a,["clEventName01="+a,"clEventTime01="+((new Date()).getTime()-this.callStartTime)]);}this.intDialog.showInterstitial(false);var c=this;var b=$("#siteid")?$("#siteid").val():"";updateReferrerImpressionTracking(f);ajaxCalledOmnitureTracking(f,c);if(f.siteAnalyticsModel){doubleClickTracking(f.siteAnalyticsModel.doubleClickModel);if(typeof(f.siteAnalyticsModel.travelHookModel)!="undefined"){_updateTravelHook(f.siteAnalyticsModel.travelHookModel);}}try{if(expads){expads.refresh();}}catch(g){}if(typeof moveAIfilter=="function"){moveAIfilter();}}};this.failure=function(a,d,c){if(d=="abort"){return;}this.intDialog.showInterstitial(false);var b={};b.errors=createAjaxError(a);updateErrorPanel(b,false);};}function updateReferrerImpressionTracking(d){var c=d&&d.siteAnalyticsModel&&d.siteAnalyticsModel.omnitureModel&&d.siteAnalyticsModel.omnitureModel.omnitureMap;var a=d&&d.packageResult&&d.packageResult.packageOfferModels;if(c){if(a&&hasPinnedHotel(d.packageResult.packageOfferModels)){var b="";if(d.siteAnalyticsModel.omnitureModel.omnitureMap.eVar28){b=d.siteAnalyticsModel.omnitureModel.omnitureMap.eVar28+"|";}b+="PKG.SR.PinnedHotel";if(isPinnedHotelSoldOut(d)){b+=".SoldOut";}d.siteAnalyticsModel.omnitureModel.omnitureMap.eVar28=b;d.siteAnalyticsModel.omnitureModel.omnitureMap.prop16=b;}}}function hasPinnedHotel(b){if(window.location.pathname.indexOf("packagesearch")>=0){for(var a=0;a<b.length;a++){if(b[a].hotel.pinnedHotel){return true;}}}return false;}function isPinnedHotelSoldOut(c){if(c.packageResult&&c.packageResult.packageOfferModels){if(c.packageResult.packageOfferModels.length==1){return c.packageResult.packageOfferModels[0].piid==undefined;}for(var a=0;a<c.packageResult.packageOfferModels.length;a++){var b=c.packageResult.packageOfferModels[a];if(b.hotel.pinnedHotel){return b.piid==undefined;}}}return true;}function ajaxCalledOmnitureTracking(c,b){if(("undefined"!=typeof(s_exp))){if("undefined"!=typeof(ProductSiteAnalyticsLogger)&&"undefined"!=typeof(ProductSiteAnalyticsLogger.updateOmniture)){b.clearOmnitureState(["prop17","prop18","prop19","prop20","prop29","prop36"]);for(i=0;i<trackABTests.length;i++){var a=trackABTests[i].split(".");c.siteAnalyticsModel.omnitureModel.abTests[a[0]]=a[1];}ProductSiteAnalyticsLogger.updateOmniture(s_exp,c.siteAnalyticsModel.omnitureModel.omnitureMap,c.siteAnalyticsModel.omnitureModel.abTests);}}else{omnitureTracking(c);}}function AJAXController(){this.filterFormId=null;this.ajaxEvents=null;this.xmlContent=null;this.jsonData=null;this.requestType="POST";this.wizardFormId=null;this.queryString="";this.ajaxRequestType;this.originId="";this.ftla="";this.destinationId="";this.ttla="";this.setOriginId=function(b){this.originId=b;};this.getOriginId=function(){return this.originId;};this.setFtla=function(b){this.ftla=b;};this.getFtla=function(){return this.ftla;};this.setDestinationId=function(b){this.destinationId=b;};this.getDestinationId=function(){return this.destinationId;};this.setTtla=function(b){this.ttla=b;
};this.getTtla=function(){return this.ttla;};this.setFilterFormId=function(c){this.filterFormId=c;var b=document.getElementById(this.filterFormId);if(b){this.requestType=b.attributes.method.value;}};this.getFilterFormId=function(){return this.filterFormId;};this.setWizardFormId=function(b){this.wizardFormId=b;};this.getWizardFormId=function(){return this.wizardFormId;};this.setRequestType=function(b){this.requestType=b;};this.getRequestType=function(){return this.requestType;};this.getAJAXEvents=function(){return this.ajaxEvents;};this.setQueryString=function(b){this.queryString=b;};this.getQueryString=function(){return this.queryString;};this.setupConnectionManager=function(){this.ajaxEvents=new AJAXEvents();};this.setup=function(b,c){this.setFilterFormId(b);this.setWizardFormId(c);this.setupConnectionManager();this.setOriginId($("#wizardOriginRegionIdInput").val());this.setDestinationId($("#wizardDestinationRegionIdInput").val());this.setFtla($("#wizardFtlaInput").val());this.setTtla($("#wizardTtlaInput").val());};this.psrStateChangeHandler=function(){var b=jQuery.bbq.getState();if(b&&!jQuery.isEmptyObject(b)){applyState(b);formController.setAJAXRequestType(b.ajaxRequestType);b=getQueryStringFromHash(b);b=formController.formatHistoryStateString.call(formController,b);}else{b=location.search;originalstate=b;}formController.processHistoryAJAXRequest.call(formController,b);};this.ajaxProcess;this.requests=[];this.submitAJAXRequest=function(b){var d=b;if(d==null){d=this.buildQueryString();}this.setQueryString(d);if(firstReq){firstReq.abort();$("#interstitial").css("display","none");}if(this.ajaxProcess){if(ajaxRequestType=="boardtypefilter"){this.requests.push(d);var c=this;this.ajaxProcess.complete(function(){var e=c.requests.length;if(e>0){request=c.requests[e-1];c.requests.length=0;c.submitRequest(request);}});}else{this.ajaxProcess.abort();this.submitRequest(d);}}else{this.submitRequest(d);}};this.submitRequest=function(c){var b=this.formatHistoryStateString(c);b=b+"&ajaxRequestType="+this.getAJAXRequestType();currentSavedState=b;ajaxRequestType=this.getAJAXRequestType();jQuery.bbq.pushState(b,2);this.ajaxProcess=$.ajax({type:this.getRequestType(),url:this.buildRequestURI(b),context:this.ajaxEvents,data:this.requestParams,beforeSend:this.ajaxEvents.start,success:this.ajaxEvents.success,error:this.ajaxEvents.failure,complete:this.ajaxEvents.complete});};this.formatHistoryStateString=function(e){var d="";var c=e.split("&");for(var b=0;b<c.length;b++){if(c[b].substring(0,2)=="c="){continue;}if(b!=0){d+="&"+c[b];}else{d=c[b];}}return d;};this.buildRequestURI=function(b){var c=getPackagesURI;if(b&&b.length>0&&b.charAt(0)!="?"){c+="?";}if(window.location.pathname.indexOf("changehotel")!=-1){b+="&pageType=CHANGE_HOTEL";}c+=b;return c;};this.QueryStringArry=function a(){var e=[],d;var b=window.location.search.substring(1).split("#")[0].split("&");for(var c=0;c<b.length;c++){d=b[c].split("=");e.push(d[0]);e[d[0]]=d[1];}return e;};this.buildQueryString=function(h){var l="";if(h==null){l+=$("#"+this.getFilterFormId()).serialize();var b=this.QueryStringArry();var e=["sort","sortorder","amenity","startindex","hotelname","hotelstarrating","regionfilter","region","c","rfrr","action","star","dlam","poiId","piidexpired","boardType","uurl"];var g;for(var d=b.length-1;d>=0;d--){g=b[d].toLowerCase();for(var f=0;f<e.length;f++){if(g==e[f].toLowerCase()){b.splice(d,1);break;}}}for(var c=0;c<b.length;c++){if(b[c]=="drid1"&&b[b[c]]==undefined){continue;}l+="&"+b[c]+"="+b[b[c]];}if($.inArray("destinationId",b)<0){l+="&destinationId="+this.getDestinationId();}if($.inArray("ttla",b)<0){l+="&ttla="+this.getTtla();}if($.inArray("originId",b)<0){l+="&originId="+this.getOriginId();}if($.inArray("ftla",b)<0){l+="&ftla="+this.getFtla();}if(featuredDealState&&$.inArray("featuredDeal",b)<0){l+="&featuredDeal="+featuredDealState;}}else{l+=h;}return l;};this.processHistoryAJAXRequest=function(b){if(originalstate==b){history.back(-1);}else{var c=this.buildQueryString(b);this.setQueryString(c);this.ajaxProcess=$.ajax({type:this.getRequestType(),url:this.buildRequestURI(c),context:this.ajaxEvents,data:this.requestParams,beforeSend:this.ajaxEvents.start,success:this.ajaxEvents.success,error:this.ajaxEvents.failure,complete:this.ajaxEvents.complete});}};this.setAJAXRequestType=function(b){this.ajaxRequestType=b;};this.getAJAXRequestType=function(b){return this.ajaxRequestType;};this.setSelectedSortOrder=function(b){document.getElementById(formController.filterFormId).sortOrder.value=b;};this.setSelectedStartIndex=function(b){document.getElementById(formController.filterFormId).startIndex.value=b;};this.saveResponse=function(f){var e;var c={};c.requestType=this.ajaxRequestType;if($.browser.msie){c.data=f;var g=450000;var d=JSON.stringify(c);$("input.previousResponse").val(d.substr(0,g));$("input.previousResponseIE1").val(d.substr(g,(g*2)));$("input.previousResponseIE2").val(d.substr((g*2)));}else{if($.browser.webkit||$.browser.safari){var b=$("input.chrome_previousResponse");c.data=f;b.val(JSON.stringify(c));}else{var b=$("input.previousResponse");c.data=f;b.val(JSON.stringify(c));}}};this.getSavedResponse=function(){var b;if($.browser.msie){var e=$("input.previousResponse").val();var d=$("input.previousResponseIE1").val();var c=$("input.previousResponseIE2").val();b=$.parseJSON(e.concat(d,c));}else{if($.browser.webkit||$.browser.safari){b=$.parseJSON($("input.chrome_previousResponse").val());}else{b=$.parseJSON($("input.previousResponse").val());}}return b;};this.publish=function(b){$(document).trigger(b);};}$(window).bind("hashchange",function(a){if(currentSavedState!=a.fragment){formController.psrStateChangeHandler();}});function processAJAXRequest(a,b){if(formController==null){pkg.page.init();}if(b){formController.requestType=b;}if(a){formController.requestParams=a;}if(a.borderObjId){toggleClass(a.borderObjId,"selected");}if(a.trackingReferrer){document.getElementById(formController.filterFormId).rfrr.value=a.trackingReferrer;}if(a.pageIndex){formController.setSelectedStartIndex(a.pageIndex);}else{formController.setSelectedStartIndex(0);}a.gpTkn=getPackagesToken;a.totalResultsCount=totalResultsCount;requestType=a.requestType;requestType=requestType.toLowerCase();formController.setAJAXRequestType(requestType);if(requestType.indexOf("pagination")>=0){window.scrollTo(0,0);}if(a.selectedOrder!=undefined){formController.setSelectedSortOrder(a.selectedOrder);}formController.submitAJAXRequest.call(formController);}function sortHotels(a){$(".sort-bar-inner .current").removeClass("current");a=$(a);processAJAXRequest({"pageIndex":0,"selectedOrder":a.data("sort"),"trackingReferrer":a.data("referrer"),"requestType":"hotelSort"});a.addClass("current");}if("undefined"!=typeof(fnTHJSInc)&&fnTHJSInc){fnTHJSInc();}function showUrgencyDisclaimer(d){var e=$(d);var a=$("#urgencyDisclaimer");var c=e.offset().top+e.outerHeight()+5;var b=e.offset().left+e.outerWidth()-a.outerWidth();a.css("top",c);a.css("left",b);$("#urgencyDisclaimer").removeClass("hide");}function hideUrgencyDisclaimer(){$("#urgencyDisclaimer").addClass("hide");}function setCookie(c,e,b){var a=window.location.hostname;var d=a.split("www")[1];document.cookie=c+"="+e+"; expires="+b+"; path=/; domain="+d+";";}function getEvarByStringArg(e,f,g,h){var d;try{d=$.parseJSON(e);}catch(c){}var a;var b;if(d){a=d.index;b=d.amount;}getEvar(a,f,b,g,h);}function getEvar(a,n,l,b,d){var f="";if(n){f="prop16,eVar28";s_exp.prop16=n;s_exp.eVar28=n;}if(a>=0){var m="";if(l){l=removeFormatting(l);var e=document.getElementById("minPkgPrice").value;e=removeFormatting(e);m=Math.round(l-e);}if(typeof(evarList)!="undefined"&&a<evarList.length){var c=prop57List[a];var j=evarList[a];var h=j.split(":");var k="";for(var g=0;g<h.length;g++){if(g==3){k=k+(a+1);k=k+":";}k=k+h[g];if(g!=h.length-1){k=k+":";}}k=k+"-"+m;if(f.length>0){f+=",";}f+="eVar39";if(c!=""){f+=",prop57";s_exp.prop57=c;}s_exp.eVar39=k;}f+=addMultiBrandedDealClickTracking(a,d,b);}s_exp.linkTrackVars=f;s_exp.linkTrackEvents="None";
s_exp.tl(true,"o","Clicked hotel position");}function addMultiBrandedDealClickTracking(b,d,c,a){if(d){s_exp.prop59="BDClick-"+b+"."+getDealType(d)+"."+c;return",prop59";}return"";}function getDealType(a){if(a=="FreeHotel"){return"H";}else{if(a=="FreeFlight"){return"F";}else{if(a=="FreeOneNightHotel"){return"N";}else{if(a=="HotelDeal"){return"P";}}}}return"";}function removeFormatting(a){return a.replace(/[^\d\.-]/g,"");}function getQueryStringFromHash(a){var d="";if(!a){return d;}for(var b in a){var c=a[b];d+=getQuery(b,c);}return d.substring(1);}function getQueryHashFromString(e){var d={},c;var a=e.split("#")[0].split("&");for(var b=0;b<a.length;b++){c=a[b].split("=");d[c[0]]=c[1];}return d;}function getQuery(c,d){if(d instanceof Array){var e="";for(var b=0;b<d.length;b++){var a=d[b];if(a){e+=getQuery(c+"["+b+"]",a);}}return e;}else{return"&"+c+"="+d;}}function hidePriceDetailContent(a){if(a.length<1){return;}document.getElementById(a).style.display="none";}function showPriceDetailContent(b){if(b.length<1){return;}var a=document.getElementById(b);a.style.display="block";}function revampDPFSData(){var a=$("#selectedFlightReason").val();if(a&&a!=""){s_exp.linkTrackVars="prop12,prop16,eVar28,eVar61";s_exp.prop16=a;s_exp.eVar28=a;s_exp.tl(true,"o","ape:DPFS");return false;}}function showUpToIndex(a){var b=$("ul#acolNeighborhoodFilter li");b.hide();b.slice(0,a).show();}function removeTHdiv(a){if(document.location.href.indexOf("rth=1")>0){$.each([1,2,3,4,5],function(b,c){if(a&&c>3){return false;}$("#TH_bid_placement_"+c).remove();});}}function boardFilterAmenityBold(){if($('#roomAndBoard input[id!="noPreference"]').is(":checked")){$('li[id^="roomAmenities_"]').addClass("bold");if($(".boardBasisPricePanel")[0]){$(".boardBasisPricePanel").text("("+$("#roomAndBoard input:checked").next().text()+")");$(".boardBasisPricePanel").show();}}}function handleAmcPsrClick(e,c,b,d){if(d){doesTrackClick(e,c,d);}$(location).attr("href",b);return;}function doesTrackClick(c,a,b){if("undefined"!=typeof(s_exp_trackClick)&&s_exp_trackClick){s_exp_trackClick(c,a,b);}}$(document).on("click",'a[href^="/"]',function(d){try{var c=$(this),b=c.attr("href"),a=(c.attr("target")==="_blank"||d.metaKey||d.ctrlKey||d.shiftKey);if(!a){d.preventDefault();setTimeout(function(){document.location=b;},500);}}catch(d){}});function checkStaticUrgency(e,a,d,c){var e=e;var a=a;destinationUrgencyCity=c;destinationUrgencyTime=d;var b="api/urgency/regionActivity/"+e;$.ajax({dataType:"json",url:b}).done(function(g){destinationViewCount=g.hotelProductActivityAtRegionLevelList[0].viewCount;if(destinationViewCount>=a){var h=$("#siteid")?$("#siteid").val():"";var f=c.replace(/\(([\s\S]*?)\)/mig,"");staticDestinationUrgency=true;$("#regionUrgencyMessageContainer").html($("#regionUrgencyTemplate").render({viewCount:destinationViewCount,destination:f}));destinationUrgencyReady=true;}}).fail(function(){});}function showDestinationUrgency(){$("#regionUrgencyMessageContainer").removeClass("hidden");$("#regionUrgencyMessageContainer").fadeIn(destinationUrgencyTime,"swing",removeDestinationUrgency);$("#regionUrgencyMessageContainer").css("position","fixed").css("height","50px");destinationUrgencyReady=false;}function removeDestinationUrgency(){setTimeout(function(){$("#regionUrgencyMessageContainer").fadeOut("slow");},destinationUrgencyTime);}function closeRegionUrgencyMessageContainer(){$("#regionUrgencyMessageContainer").addClass("hidden");}function dismissAllInclusiveBanner(){$("#allInclusiveBanner").hide();allInclusiveBannerDismissed=true;}function updateStandardizeWayFinderSubTitle(a){$("#standardizeWayFinderAboveAColumn").html($("#standardizeWayFinderSubTitleTemplate").render(a));}function openInNewTab(a){var b=window.open(a,"_blank");b.focus();}
/*!  generated on 2014-06-06 02:23:01.549 PDT(-0700) in 15 ms  */

/*!  served in 0 ms  */
