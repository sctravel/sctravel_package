if(!Handlebars.templates){Handlebars.templates={};}Handlebars.templates["handlebars/recentlyviewed/container"]=Handlebars.template(function(d,j,c,i,h){this.compilerInfo=[4,">= 1.0.0"];c=this.merge(c,d.helpers);i=this.merge(i,d.partials);h=h||{};var f="",a,k=this,g=this.escapeExpression,e="function";function b(o,n){var l="",m;l+=" ";m=k.invokePartial(i["handlebars/recentlyviewed/rv-box"],"handlebars/recentlyviewed/rv-box",o,c,i,n);if(m||m===0){l+=m;}l+=" ";return l;}f+='<header class="cols-row-header"> <h3 id="rv-title" class="rv-title">';if(a=c.title){a=a.call(j,{hash:{},data:h});}else{a=j.title;a=typeof a===e?a.apply(j):a;}f+=g(a)+'</h3> <span id="rv-legal-msg" class="rv-legal-msg">Prices vary and will be updated when you view current results</span> </header> <div class="cols-row cf"> ';a=c.each.call(j,j.rvModel,{hash:{},inverse:k.noop,fn:k.program(1,b,h),data:h});if(a||a===0){f+=a;}f+=" </div>";return f;});Handlebars.templates["handlebars/recentlyviewed/rv-box"]=Handlebars.template(function(i,y,w,n,G){this.compilerInfo=[4,">= 1.0.0"];w=this.merge(w,i.helpers);G=G||{};var x="",j,u=this,b=this.escapeExpression,c="function";function p(L,K){var I="",J;I+=' data-hotelId="';if(J=w.hotelId){J=J.call(L,{hash:{},data:K});}else{J=L.hotelId;J=typeof J===c?J.apply(L):J;}I+=b(J)+'"';return I;}function o(J,I){return"isRV";}function m(J,I){return"isRS";}function l(L,K){var I="",J;I+=' <figure class="aspect-ratio4-3 image" data-media-type="image" data-lazy="true" data-downgrade="false" data-src="//media.expedia.com/';if(J=w.thumbnail){J=J.call(L,{hash:{},data:K});}else{J=L.thumbnail;J=typeof J===c?J.apply(L):J;}I+=b(J)+'" data-alt="missing image alt" data-aspect-ratio="4-3"> <img alt="missing image alt" class="undefined" src="//media.expedia.com/';if(J=w.thumbnail){J=J.call(L,{hash:{},data:K});}else{J=L.thumbnail;J=typeof J===c?J.apply(L):J;}I+=b(J)+'"> <noscript data-src="//media.expedia.com/';if(J=w.thumbnail){J=J.call(L,{hash:{},data:K});}else{J=L.thumbnail;J=typeof J===c?J.apply(L):J;}I+=b(J)+'" data-alt="missing image alt" data-aspect-ratio="4-3" data-class="tile-media"> &lt;img src="//media.expedia.com/';if(J=w.thumbnail){J=J.call(L,{hash:{},data:K});}else{J=L.thumbnail;J=typeof J===c?J.apply(L):J;}I+=b(J)+'" alt="missing image alt" class="tile-media" /&gt; </noscript> <span class="media-loader"> <span class="loader loader-light loader-static" title="Loading..."></span> </span> </figure> ';return I;}function h(L,K){var I="",J;I+=' <span class="icon icon-';J=w["if"].call(L,L.isRSP,{hash:{},inverse:u.noop,fn:u.program(10,H,K),data:K});if(J||J===0){I+=J;}J=w["if"].call(L,L.isRSF,{hash:{},inverse:u.noop,fn:u.program(12,E,K),data:K});if(J||J===0){I+=J;}J=w["if"].call(L,L.isRSH,{hash:{},inverse:u.noop,fn:u.program(14,C,K),data:K});if(J||J===0){I+=J;}I+='"></span> ';return I;}function H(J,I){return"packagesalt";}function E(J,I){return"flightsalt";}function C(J,I){return"hotelsalt";}function A(L,K){var I="",J;I+=' <h5 class="trip-info-main" id="';if(J=w.id){J=J.call(L,{hash:{},data:K});}else{J=L.id;J=typeof J===c?J.apply(L):J;}I+=b(J)+'-trip-info-main" title="';if(J=w.hotelName){J=J.call(L,{hash:{},data:K});}else{J=L.hotelName;J=typeof J===c?J.apply(L):J;}I+=b(J)+'"><span class="sm-tablet-greater">';if(J=w.hotelName){J=J.call(L,{hash:{},data:K});}else{J=L.hotelName;J=typeof J===c?J.apply(L):J;}I+=b(J)+'</span><span class="sm-tablet">';if(J=w.rsfShortName){J=J.call(L,{hash:{},data:K});}else{J=L.rsfShortName;J=typeof J===c?J.apply(L):J;}I+=b(J)+"</span></h5> ";return I;}function z(L,K){var I="",J;I+=' <h5 class="trip-info-main" id="';if(J=w.id){J=J.call(L,{hash:{},data:K});}else{J=L.id;J=typeof J===c?J.apply(L):J;}I+=b(J)+'-trip-info-main" title="';if(J=w.hotelName){J=J.call(L,{hash:{},data:K});}else{J=L.hotelName;J=typeof J===c?J.apply(L):J;}I+=b(J)+'">';if(J=w.hotelName){J=J.call(L,{hash:{},data:K});}else{J=L.hotelName;J=typeof J===c?J.apply(L):J;}I+=b(J)+"</h5> ";return I;}function k(L,K){var I="",J;I+=' <strong class="star-rating rating-secondary rating secondary" id="';if(J=w.id){J=J.call(L,{hash:{},data:K});}else{J=L.id;J=typeof J===c?J.apply(L):J;}I+=b(J)+'-rec-hotel-stars"> <span class="icon icon-stars';if(J=w.starsIcon){J=J.call(L,{hash:{},data:K});}else{J=L.starsIcon;J=typeof J===c?J.apply(L):J;}I+=b(J)+' stars-black value-title" title="';if(J=w.stars){J=J.call(L,{hash:{},data:K});}else{J=L.stars;J=typeof J===c?J.apply(L):J;}I+=b(J)+' Star"></span> </strong> ';return I;}function g(L,K){var I="",J;I+=' <span class="trip-info-dates" id="';if(J=w.id){J=J.call(L,{hash:{},data:K});}else{J=L.id;J=typeof J===c?J.apply(L):J;}I+=b(J)+'-trip-info-dates">';if(J=w.dates){J=J.call(L,{hash:{},data:K});}else{J=L.dates;J=typeof J===c?J.apply(L):J;}I+=b(J)+"</span> ";return I;}function f(K,J){var I;if(I=w.city){I=I.call(K,{hash:{},data:J});}else{I=K.city;I=typeof I===c?I.apply(K):I;}return b(I);}function e(K,J){var I;if(I=w.flightType){I=I.call(K,{hash:{},data:J});}else{I=K.flightType;I=typeof I===c?I.apply(K):I;}return b(I);}function d(L,K){var I="",J;J=w["if"].call(L,L.info,{hash:{},inverse:u.noop,fn:u.program(29,a,K),data:K});if(J||J===0){I+=J;}J=w.unless.call(L,L.info,{hash:{},inverse:u.noop,fn:u.program(31,v,K),data:K});if(J||J===0){I+=J;}return I;}function a(K,J){var I;if(I=w.info){I=I.call(K,{hash:{},data:J});}else{I=K.info;I=typeof I===c?I.apply(K):I;}return b(I);}function v(J,I){return'<span class="icon icon-flights"></span><span>Flight included</span>';}function t(J,I){return"<span>Flight and hotel included</span>";}function s(L,K){var I="",J;I+="<span>";if(J=w.info){J=J.call(L,{hash:{},data:K});}else{J=L.info;J=typeof J===c?J.apply(L):J;}I+=b(J)+"</span>";return I;}function r(L,K){var I="",J;I+=' sfid="';if(J=w.sfid){J=J.call(L,{hash:{},data:K});}else{J=L.sfid;J=typeof J===c?J.apply(L):J;}I+=b(J)+'"';return I;}function q(J,I){return" see-price";}function F(J,I){return" has-price";}function D(J,I){return" package-orig-price";}function B(L,K){var I="",J;I+=' <section class="rv-savings-info" id="';if(J=w.id){J=J.call(L,{hash:{},data:K});}else{J=L.id;J=typeof J===c?J.apply(L):J;}I+=b(J)+'-rv-savings-info"> <span class="">Total savings: <span class="savingsAmount">';if(J=w.packageSavings){J=J.call(L,{hash:{},data:K});}else{J=L.packageSavings;J=typeof J===c?J.apply(L):J;}I+=b(J)+"</span></span> </section> ";return I;}x+='<article class="box col" id="';if(j=w.id){j=j.call(y,{hash:{},data:G});}else{j=y.id;j=typeof j===c?j.apply(y):j;}x+=b(j)+'" data-rv-type="';if(j=w.rvType){j=j.call(y,{hash:{},data:G});}else{j=y.rvType;j=typeof j===c?j.apply(y):j;}x+=b(j)+'"';j=w["if"].call(y,y.isRVH,{hash:{},inverse:u.noop,fn:u.program(1,p,G),data:G});if(j||j===0){x+=j;}x+=' > <a title="';if(j=w.hotelName){j=j.call(y,{hash:{},data:G});}else{j=y.hotelName;j=typeof j===c?j.apply(y):j;}x+=b(j)+'" href="';if(j=w.localizedPageUrl){j=j.call(y,{hash:{},data:G});}else{j=y.localizedPageUrl;j=typeof j===c?j.apply(y):j;}x+=b(j)+'"> <section class="rv-visual ';j=w["if"].call(y,y.isRV,{hash:{},inverse:u.program(5,m,G),fn:u.program(3,o,G),data:G});if(j||j===0){x+=j;}x+='"> ';j=w["if"].call(y,y.isRV,{hash:{},inverse:u.noop,fn:u.program(7,l,G),data:G});if(j||j===0){x+=j;}x+=" ";j=w["if"].call(y,y.isRS,{hash:{},inverse:u.noop,fn:u.program(9,h,G),data:G});if(j||j===0){x+=j;}x+=' </section> <section class="rv-trip-info ';j=w["if"].call(y,y.isRV,{hash:{},inverse:u.program(5,m,G),fn:u.program(3,o,G),data:G});if(j||j===0){x+=j;}x+='" id="';if(j=w.id){j=j.call(y,{hash:{},data:G});}else{j=y.id;j=typeof j===c?j.apply(y):j;}x+=b(j)+'-rv-trip-info"> ';j=w["if"].call(y,y.isRSF,{hash:{},inverse:u.program(18,z,G),fn:u.program(16,A,G),data:G});if(j||j===0){x+=j;}x+=" ";j=w["if"].call(y,y.ab3293viewedHotelStars,{hash:{},inverse:u.program(22,g,G),fn:u.program(20,k,G),data:G});if(j||j===0){x+=j;}x+=' <span class="trip-info-city" id="';if(j=w.id){j=j.call(y,{hash:{},data:G});}else{j=y.id;j=typeof j===c?j.apply(y):j;}x+=b(j)+'-trip-info-city"> ';j=w["if"].call(y,y.isRVH,{hash:{},inverse:u.program(26,e,G),fn:u.program(24,f,G),data:G});
if(j||j===0){x+=j;}x+=' </span> <span class="trip-info-additional" id="';if(j=w.id){j=j.call(y,{hash:{},data:G});}else{j=y.id;j=typeof j===c?j.apply(y):j;}x+=b(j)+'-trip-info-additional"> ';j=w["if"].call(y,y.isRVP,{hash:{},inverse:u.noop,fn:u.program(28,d,G),data:G});if(j||j===0){x+=j;}x+=" ";j=w["if"].call(y,y.isRSP,{hash:{},inverse:u.noop,fn:u.program(33,t,G),data:G});if(j||j===0){x+=j;}x+=" ";j=w["if"].call(y,y.isRSH,{hash:{},inverse:u.noop,fn:u.program(35,s,G),data:G});if(j||j===0){x+=j;}x+=' </span> </section> <section class="rv-remove"';j=w["if"].call(y,y.sfid,{hash:{},inverse:u.noop,fn:u.program(37,r,G),data:G});if(j||j===0){x+=j;}x+='> <span class="icon icon-close" aria-hidden="true"></span><span class="alt">X</span> </section> <section class="rv-price-info" id="';if(j=w.id){j=j.call(y,{hash:{},data:G});}else{j=y.id;j=typeof j===c?j.apply(y):j;}x+=b(j)+'-rv-price-info"> <h5 class="price-info-price';j=w["if"].call(y,y.seePrice,{hash:{},inverse:u.noop,fn:u.program(39,q,G),data:G});if(j||j===0){x+=j;}j=w.unless.call(y,y.seePrice,{hash:{},inverse:u.noop,fn:u.program(41,F,G),data:G});if(j||j===0){x+=j;}x+='" id="';if(j=w.id){j=j.call(y,{hash:{},data:G});}else{j=y.id;j=typeof j===c?j.apply(y):j;}x+=b(j)+'-price-info-price">';if(j=w.price){j=j.call(y,{hash:{},data:G});}else{j=y.price;j=typeof j===c?j.apply(y):j;}x+=b(j)+'</h5> <span class="price-info-additional';j=w["if"].call(y,y.origPrice,{hash:{},inverse:u.noop,fn:u.program(43,D,G),data:G});if(j||j===0){x+=j;}x+='" id="';if(j=w.id){j=j.call(y,{hash:{},data:G});}else{j=y.id;j=typeof j===c?j.apply(y):j;}x+=b(j)+'-price-additional">';if(j=w.origPrice){j=j.call(y,{hash:{},data:G});}else{j=y.origPrice;j=typeof j===c?j.apply(y):j;}x+=b(j);if(j=w.additionalPriceInfo){j=j.call(y,{hash:{},data:G});}else{j=y.additionalPriceInfo;j=typeof j===c?j.apply(y):j;}x+=b(j)+"</span> </section> ";j=w["if"].call(y,y.packageSavings,{hash:{},inverse:u.noop,fn:u.program(45,B,G),data:G});if(j||j===0){x+=j;}x+=" </a> </article>";return x;});if(!Handlebars.templates){Handlebars.templates={};}Handlebars.templates["handlebars/recommender/container"]=Handlebars.template(function(d,j,c,i,h){this.compilerInfo=[4,">= 1.0.0"];c=this.merge(c,d.helpers);i=this.merge(i,d.partials);h=h||{};var f="",a,k=this,g=this.escapeExpression,e="function";function b(o,n){var l="",m;l+=" ";m=k.invokePartial(i["handlebars/recommender/hotel-tile"],"handlebars/recommender/hotel-tile",o,c,i,n);if(m||m===0){l+=m;}l+=" ";return l;}f+='<hgroup class="cols-row-header section-header cf"> <h3 id="rec-title" class="section-header-main">Recommended Hotels</h3> <h4 class="section-header-sub">';if(a=c.title){a=a.call(j,{hash:{},data:h});}else{a=j.title;a=typeof a===e?a.apply(j):a;}f+=g(a)+'</h4> <span id="rec-disclaimer">Prices are average per night</span> </hgroup> <div class="content-slider" id="rec-content-slider" data-omniture-prefix="Home.SuggHotel" data-control="content-slider"> <section class="content-slider-mask cols-nested"> <div class="tile-grid cf"> ';a=c.each.call(j,j.hotel,{hash:{},inverse:k.noop,fn:k.program(1,b,h),data:h});if(a||a===0){f+=a;}f+=" </div> </section> </div>";return f;});Handlebars.templates["handlebars/recommender/hotel-tile"]=Handlebars.template(function(d,j,c,i,h){this.compilerInfo=[4,">= 1.0.0"];c=this.merge(c,d.helpers);h=h||{};var f="",a,k=this,g=this.escapeExpression,e="function";function b(m,l){return"$ ";}f+='<article id="';if(a=c.id){a=a.call(j,{hash:{},data:h});}else{a=j.id;a=typeof a===e?a.apply(j):a;}f+=g(a)+'" class="col tile tile-no-header tile-no-footer current-tile"> <a class="tile-link " href="';if(a=c.localizedPageUrl){a=a.call(j,{hash:{},data:h});}else{a=j.localizedPageUrl;a=typeof a===e?a.apply(j):a;}f+=g(a)+'"> <section class="tile-content"> <figure class="image aspect-ratio16-9 " data-lazy="false"> <img src="';if(a=c.thumbnail){a=a.call(j,{hash:{},data:h});}else{a=j.thumbnail;a=typeof a===e?a.apply(j):a;}f+=g(a)+'" alt="';if(a=c.hotelName){a=a.call(j,{hash:{},data:h});}else{a=j.hotelName;a=typeof a===e?a.apply(j):a;}f+=g(a)+'" id="';if(a=c.id){a=a.call(j,{hash:{},data:h});}else{a=j.id;a=typeof a===e?a.apply(j):a;}f+=g(a)+'-rec-image" class="tile-media"> </figure> <div class="box tile-details"> <section class="rec-hotel-info"> <h5 id="';if(a=c.id){a=a.call(j,{hash:{},data:h});}else{a=j.id;a=typeof a===e?a.apply(j):a;}f+=g(a)+'-rec-hotel-name" class="tile-name" title="';if(a=c.hotelName){a=a.call(j,{hash:{},data:h});}else{a=j.hotelName;a=typeof a===e?a.apply(j):a;}f+=g(a)+'">';if(a=c.hotelName){a=a.call(j,{hash:{},data:h});}else{a=j.hotelName;a=typeof a===e?a.apply(j):a;}f+=g(a)+'</h5> <strong class="star-rating rating-secondary rating secondary" id="';if(a=c.id){a=a.call(j,{hash:{},data:h});}else{a=j.id;a=typeof a===e?a.apply(j):a;}f+=g(a)+'-rec-hotel-stars"> <span class="visuallyhidden">';if(a=c.stars){a=a.call(j,{hash:{},data:h});}else{a=j.stars;a=typeof a===e?a.apply(j):a;}f+=g(a)+' out of 5 stars</span> <span class="icon stars-background"></span> <span class="icon icon-stars';if(a=c.starsIcon){a=a.call(j,{hash:{},data:h});}else{a=j.starsIcon;a=typeof a===e?a.apply(j):a;}f+=g(a)+' stars-black value-title" title="';if(a=c.stars){a=a.call(j,{hash:{},data:h});}else{a=j.stars;a=typeof a===e?a.apply(j):a;}f+=g(a)+'"></span> </strong> <span class="rec-hotel-dates">';if(a=c.dates){a=a.call(j,{hash:{},data:h});}else{a=j.dates;a=typeof a===e?a.apply(j):a;}f+=g(a)+'</span> </section> <section class="rec-price-info"> <span>';a=c["if"].call(j,j.price,{hash:{},inverse:k.noop,fn:k.program(1,b,h),data:h});if(a||a===0){f+=a;}f+='<h5 id="';if(a=c.id){a=a.call(j,{hash:{},data:h});}else{a=j.id;a=typeof a===e?a.apply(j):a;}f+=g(a)+'-rec-hotel-price">';if(a=c.price){a=a.call(j,{hash:{},data:h});}else{a=j.price;a=typeof a===e?a.apply(j):a;}f+=g(a)+"</h5></span> </section> </div> </section> </a> </article>";return f;});if(!Handlebars.templates){Handlebars.templates={};}Handlebars.templates["handlebars/localfavourites/container"]=Handlebars.template(function(e,l,d,j,i){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,e.helpers);i=i||{};var g="",a,o,n,f="function",h=this.escapeExpression,k=d.helperMissing,m=this;function c(u,t){var p="",s,r,q;p+=' <article id="local-favourites-module-';if(s=d.moduleId){s=s.call(u,{hash:{},data:t});}else{s=u.moduleId;s=typeof s===f?s.apply(u):s;}p+=h(s)+"-tile-";if(s=d.slideTileId){s=s.call(u,{hash:{},data:t});}else{s=u.slideTileId;s=typeof s===f?s.apply(u):s;}p+=h(s)+'" class="col tile tile-no-header tile-no-footer"><a class="tile-link" href="';if(s=d.urlToHotelInfosite){s=s.call(u,{hash:{},data:t});}else{s=u.urlToHotelInfosite;s=typeof s===f?s.apply(u):s;}p+=h(s)+'"><section class="tile-content"><figure id="local-favourites-module-';if(s=d.moduleId){s=s.call(u,{hash:{},data:t});}else{s=u.moduleId;s=typeof s===f?s.apply(u):s;}p+=h(s)+"-tile-";if(s=d.slideTileId){s=s.call(u,{hash:{},data:t});}else{s=u.slideTileId;s=typeof s===f?s.apply(u):s;}p+=h(s)+'-img" class="aspect-ratio16-9 loading image" data-media-type="image" data-lazy="true" data-downgrade="false" data-src="';q={hash:{},data:t};p+=h(((s=d.LFMuseLargerImage||u.LFMuseLargerImage),s?s.call(u,u.urlToThumbnail,q):k.call(u,"LFMuseLargerImage",u.urlToThumbnail,q)))+'" data-alt="';q={hash:{},data:t};p+=h(((s=d.LFMunescape||u.LFMunescape),s?s.call(u,u.localizedHotelName,q):k.call(u,"LFMunescape",u.localizedHotelName,q)))+'" data-aspect-ratio="16-9" data-class="tile-media"><noscript><img src="';q={hash:{},data:t};p+=h(((s=d.LFMuseLargerImage||u.LFMuseLargerImage),s?s.call(u,u.urlToThumbnail,q):k.call(u,"LFMuseLargerImage",u.urlToThumbnail,q)))+'" alt="';q={hash:{},data:t};p+=h(((s=d.LFMunescape||u.LFMunescape),s?s.call(u,u.localizedHotelName,q):k.call(u,"LFMunescape",u.localizedHotelName,q)))+'" class="tile-media"/></noscript><span class="media-loader"><span class="loader loader-light loader-static" title="Loading..."></span></span></figure><div class="box tile-details"><h4 class="tile-name" id="local-favourites-module-';if(r=d.moduleId){r=r.call(u,{hash:{},data:t});
}else{r=u.moduleId;r=typeof r===f?r.apply(u):r;}p+=h(r)+"-tile-";if(r=d.slideTileId){r=r.call(u,{hash:{},data:t});}else{r=u.slideTileId;r=typeof r===f?r.apply(u):r;}p+=h(r)+'-hotel-name">';q={hash:{},data:t};p+=h(((s=d.LFMunescape||u.LFMunescape),s?s.call(u,u.hotelName,q):k.call(u,"LFMunescape",u.hotelName,q)))+'</h4><strong class="star-rating rating-secondary rating secondary"><span class="visuallyhidden">';if(r=d.starRating){r=r.call(u,{hash:{},data:t});}else{r=u.starRating;r=typeof r===f?r.apply(u):r;}p+=h(r)+' out of 5 stars</span><span class="icon icon-stars';q={hash:{},data:t};p+=h(((s=d.LFMstarRating||u.LFMstarRating),s?s.call(u,u.starRating,q):k.call(u,"LFMstarRating",u.starRating,q)))+' stars-black value-title" title="';if(r=d.starRating){r=r.call(u,{hash:{},data:t});}else{r=u.starRating;r=typeof r===f?r.apply(u):r;}p+=h(r)+'" aria-hidden="true"></span></strong><p class="secondary" id="local-favourites-module-';if(r=d.moduleId){r=r.call(u,{hash:{},data:t});}else{r=u.moduleId;r=typeof r===f?r.apply(u):r;}p+=h(r)+"-tile-";if(r=d.slideTileId){r=r.call(u,{hash:{},data:t});}else{r=u.slideTileId;r=typeof r===f?r.apply(u):r;}p+=h(r)+'-txt1">';q={hash:{},data:t};p+=h(((s=d.LFMunescape||u.LFMunescape),s?s.call(u,u.hotelCity,q):k.call(u,"LFMunescape",u.hotelCity,q)));r=d["if"].call(u,u.hotelProvince,{hash:{},inverse:m.noop,fn:m.program(2,b,t),data:t});if(r||r===0){p+=r;}p+='</p><p class="secondary tile-price" id="local-favourites-module-';if(r=d.moduleId){r=r.call(u,{hash:{},data:t});}else{r=u.moduleId;r=typeof r===f?r.apply(u):r;}p+=h(r)+"-tile-";if(r=d.slideTileId){r=r.call(u,{hash:{},data:t});}else{r=u.slideTileId;r=typeof r===f?r.apply(u):r;}p+=h(r)+'-price"><strong>';q={hash:{},data:t};p+=h(((s=d.LFMunescape||u.LFMunescape),s?s.call(u,u.averagePrice,q):k.call(u,"LFMunescape",u.averagePrice,q)))+"</strong></p></div></section></a></article> ";return p;}function b(t,s){var p="",r,q;p+=",&nbsp";q={hash:{},data:s};p+=h(((r=d.LFMunescape||t.LFMunescape),r?r.call(t,t.hotelProvince,q):k.call(t,"LFMunescape",t.hotelProvince,q)));return p;}g+='<div class="content-slider" id="local-favourites-module-';if(a=d.id){a=a.call(l,{hash:{},data:i});}else{a=l.id;a=typeof a===f?a.apply(l):a;}g+=h(a)+'" data-control="content-slider" data-omniture-prefix="Home.LocHotel"> <section class="content-slider-mask cols-nested"><div class="tile-grid cf" > ';n={hash:{},inverse:m.noop,fn:m.program(1,c,i),data:i};o=((a=d.LFMlist||l.LFMlist),a?a.call(l,l.recommendationsTiles,n):k.call(l,"LFMlist",l.recommendationsTiles,n));if(o||o===0){g+=o;}g+=" </div></section> </div>";return g;});var feefo={$feefo:null};feefo.getRatings=function(a){feefo.$feefo=$("#feefo");if(feefo.$feefo.length==0){return;}a=a||"http://www.feefo.com/feefo/xmlfeed.jsp?logon=www.expedia.co.uk/Expedia.co.uk";$.ajax({dataType:"jsonp",url:a+"&json=true",success:feefo.render,cache:false,timeout:5000});};feefo.formatNumberWithCommas=function(a){return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",");};feefo.render=function(a){if(a&&a.FEEDBACKLIST&&a.FEEDBACKLIST.SUMMARY){var c=a.FEEDBACKLIST.SUMMARY.AVERAGE;var b=a.FEEDBACKLIST.SUMMARY.COUNT;b=feefo.formatNumberWithCommas(b);feefo.addStarRating(c);$(".feefo-circle").text(c+"%");$(".feefo-count").text(b);feefo.$feefo.removeClass("visuallyhidden");}};feefo.addStarRating=function(d){if(d>100){d=90;}var a=Math.floor(d/10)/2;if(a!=4.5){if(a%1==0){a+=".0";}var b=a.replace(".","-");var c='<span class="visuallyhidden"><STAR-DOT> out of 5 stars</span><span class="icon icon-stars<STAR-DASH> stars-black value-title" title="<STAR-DOT>" aria-hidden="true"></span>';c=c.replace(/<STAR-DOT>/g,a);c=c.replace(/<STAR-DASH>/g,b);$("#feefo .star-rating").html(c);}};function typeaheadItemClickCallback(b){var a=corewizard.model.getGlobalModel();var c=JSON.parse(b.attr("data-data"));if(c.t=="HOTEL"){a.set("hotelId",c.id);}else{a.set("hotelId",null);}a.set("OMHotelTA",true);a.set("regionId",c.id);a.set("multiCityRegion",c.amc);a.set("destinationTLA",c.a);a.set("destinationFromTA",c.f);if(ab3291status===1){if(a.get("noDate")==false){corewizard.helpers.openCalendarField("departing");}}else{if(corewizard.helpers.shouldOpenCalendar("departing")&&(a.get("noDate")==false)){corewizard.helpers.openCalendarField("departing");}}}function typeaheadCarPickUpCallback(b){var a=corewizard.model.getGlobalModel();var c=JSON.parse(b.attr("data-data"));a.set("car.showDropOff",(c.t=="AIRPORT"));a.set("tla",c.a);if(!a.get("car.showDropOff")){a.set("carReturn","");}a.set("car.searchType",(a.get("car.showDropOff"))?1:2);a.set("carPickupValueFromTA",c.f);setTimeout(function(){corewizard.core.reloadTab();},100);}function typeaheadFlightOriginCallback(b){var a=corewizard.model.getGlobalModel();a.set("OMOriginTA",true);var c=JSON.parse(b.attr("data-data"));a.set("originTLA",c.a);a.set("originFromTA",c.l);if(ab3291status===1){corewizard.core.shiftFocus(corewizard.helpers.getWizardFieldByType("destination"));}}function typeaheadFlightDestinationCallback(b){var c=JSON.parse(b.attr("data-data"));var a=corewizard.model.getGlobalModel();a.set("OMDestinationTA",true);a.set("OMDestinationTACompare",c.l);if(c.t=="AIRPORT"){a.set("regionId",c.id);a.set("destinationTLA",c.a);a.set("destinationFromTA",c.l);}if(ab3291status===1){corewizard.core.shiftFocus(corewizard.helpers.getWizardFieldByType("departing"));}}function typeaheadPackageOriginCallback(b){var c=JSON.parse(b.attr("data-data"));var a=corewizard.model.getGlobalModel();a.set("OMOriginTA",true);a.set("originTLA",c.a);a.set("originFromTA",c.f);}function typeaheadPackageDestinationCallback(b){var c=JSON.parse(b.attr("data-data"));var a=corewizard.model.getGlobalModel();a.set("OMDestinationTA",true);a.set("regionId",c.id);a.set("destinationTLA",c.a);a.set("destinationFromTA",c.f);if(ab3291status===1){corewizard.helpers.openCalendarField("departing");}}if("undefined"==typeof(exp)){var exp={};}if("undefined"==typeof(exp.core)){exp.core={};}if("undefined"==typeof(exp.core.date)){exp.core.date={};}exp.core.date.Calendar=function(a){var b={config:a,rM:[31,28,31,30,31,30,31,31,30,31,30,31],getDateFormat:function(){return this.config.getDateFormat();},getDateSeparator:function(){return this.config.getDateSeparator();},getStartOfWeek:function(){return this.config.getStartOfWeek();},getDateFromString:function(g){if(!g||!g.length){return null;}g=g.replace(/\s+/g,"");if(g.match(/[^-|\d|\.|\/]/)){return null;}var h=g.split(/-|\.|\//);for(var f=0;f<h.length;f++){h[f]=parseInt(h[f],10);}if(!h[1]){return null;}var c,k,l;var e=this.getDateFormat();if(e=="yymmdd"){if(!h[2]){return null;}c=h[1];k=h[2];l=h[0];}else{if(e=="mmddyy"){c=h[0];k=h[1];}else{c=h[1];k=h[0];}if(h[2]){l=h[2];}else{l=this.DefYr(c-1,k);}}var j=new Date().getFullYear();c-=1;if(l.toString().length===2){l+=2000;}if(l<j){l=j;}if(l<1601||l>4500||c<0||c>11||k<1||k>this.getMonthCount(c,l)){return null;}return new Date(l,c,k);},toStringFromComp:function(i,c,j){function h(d){return d<10?"0"+d:d;}var f="";var g=this.getDateSeparator();var e=this.getDateFormat();i=h(i);c=h(c);if(e=="mmddyy"){f=c+g+i+g+j;}else{if(e=="ddmmyy"){f=i+g+c+g+j;}else{f=j+g+c+g+i;}}return f;},toStringFromDate:function(f){var e="";var g=this.getDateSeparator();var d=this.getDateFormat();var h=f.getMonth()+1;var c=f.getDate();var i=f.getFullYear();if(d=="mmddyy"){e=h+g+c+g+i;}else{if(d=="ddmmyy"){e=c+g+h+g+i;}else{e=i+g+h+g+c;}}return e;},IsLY:function(c){if(0==c%4&&((c%100!=0)||(c%400==0))){return true;}else{return false;}},DefYr:function(c,g){var e=new Date();var f=(e.getYear()<1000)?1900+e.getYear():e.getYear();if(c<e.getMonth()||(c==e.getMonth()&&g<e.getDate())){f++;}return f;},getMonthCount:function(d,f){var e=this.rM[d];if((1==d)&&this.IsLY(f)){e++;}return e;},IsLastDayOfMonth:function(c){return this.getMonthCount(c.getMonth(),c.getFullYear())==c.getDate();},incrementMonth:function(c){if(c.getMonth()==11){c.setMonth(0);c.setFullYear(c.getFullYear()+1);}else{c.setMonth(c.getMonth()+1);}return c;},decrementMonth:function(c){if(c.getMonth()==0){c.setMonth(11);
c.setFullYear(c.getFullYear()-1);}else{c.setMonth(c.getMonth()-1);}return c;}};return b;};exp.core.date.DateUpdater=function(d,b){var a;var c={config:b,calendar:d,register:function(j,r,m,n,l,u){m=m||0;var s=$(j);var i=this.calendar.getDateFromString(s[0].value);var q=$(r);var h=this.calendar.getDateFromString(q[0].value);var g=this.calendar.getDateSeparator();var f=this.calendar.getDateFormat();var t=f.substring(0,2)+g+f.substring(2,4)+g+f.substring(4,6);var e=new Date();e.setHours(0,0,0,0);if(i&&i.valueOf()<e.valueOf()){s[0].value=t;}if(h&&h.valueOf()<e.valueOf()){q[0].value=t;}a=this;var p=function(){a.update("#"+j.id,"#"+r.id,m,n,u);};var o=function(){a.updateByNights(s[0],q[0],m);a.update(s[0],q[0],m,n);};$("body").on("blur","#"+j.id,p);$("body").on("focus","#"+j.id,p);$("body").on("blur","#"+r.id,p);$("body").on("focus","#"+r.id,p);var k=$("#"+j.id+"-stay-nights");if(k.length!=0){k.change(o);k.keypress(o);}},days_between:function(i,h){var j=1000*60*60*24;var g=i.getTime();var f=h.getTime();var e=Math.abs(g-f);return Math.round(e/j);},updateNumberOfNights:function(i,h){var g=document.getElementById("hot-sear-date-num-nights");if(this.config!=undefined&&g!=null){var e=this.config.getNightTextConfig();var f=this.days_between(h,i);if(f>1){g.innerHTML=f+" "+e[1];}else{g.innerHTML=e[0];}g.style.display="inline";}},updateDayName:function(j,f){var i=$("#"+j.id+"-day");if(this.config!=undefined&&i.length!=0){try{var e=f.getDay();if(e==undefined){i.html("");return;}var h=this.config.getDayNames();i.html(h[e]);}catch(g){i.html("");}}},updateByNights:function(f,g,i){var e=this.calendar.getDateFromString($(f).val());var h=$("#"+f.id+"-stay-nights");if(e){e.setDate(e.getDate()+parseInt(h.get(0).value));$(g).val(this.calendar.toStringFromComp(e.getDate(),e.getMonth()+1,e.getFullYear()));}},update:function(g,m,j,k,p){var n=$(g);var l=$(m);var f=this.calendar.getDateFromString(n.val());var e=this.calendar.getDateFromString(l.val());var h=$("#"+g.id+"-stay-nights");j=n.attr("data-min-booking-length")||0;if(!p||isNaN(parseInt(p))||e){p=0;}this.updateDayName(g,f);this.updateDayName(m,e);if(f&&e){this.updateNumberOfNights(f,e);}if(f){if(e&&h.length!=0){var q=Math.round((e-f)/1000/60/60/24);if(q<1){q=h.get(0).value;}h.get(0).value=q;}var o=Math.max(j,p);f=new Date(f.valueOf()+1000*3600*24*o);var i=this.calendar.toStringFromComp(f.getDate(),f.getMonth()+1,f.getFullYear());if(e&&e<=f){e=null;}if(null==e&&(l.attr("data-optional")!="true"||l.val()!="")){e=this.calendar.getDateFromString(n.val());this.updateNumberOfNights(e,f);if(h.length!=0&&h.get(0).value!=1){f.setDate(f.getDate()+parseInt(h.get(0).value)-1);var i=this.calendar.toStringFromComp(f.getDate(),f.getMonth()+1,f.getFullYear());}if(i!=l.val()){l.val(i);l.blur();}if(exp.core.date.datePicker){exp.core.date.datePicker.entries[l.attr("id")].currentValue=f;}this.updateDayName(m,f);}}if(n.is(".fieldDefaultText")){n.removeClass("fieldDefaultText");}if(l.is(".fieldDefaultText")){l.removeClass("fieldDefaultText");}uitk.updatePlaceholderClass(n);uitk.updatePlaceholderClass(l);}};return c;};exp.core.date.CalendarControl=function(){var a=function(){var n="mmddyy";var g="/";var o=0;var e=["January","February","March","April","May","June","July","August","September","October","November","December"];var f=["JAN","FEV","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"];var c=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];var q=["S","M","T","W","T","F","S"];var j="Close";var i="";var d=["night","nights"];var b=function(r){d=r;};var l=function(r,s){n=r;g=s;};var p=function(s,r,u,t){o=s;e=r;q=u;if(t!=undefined){c=t;}};var m=function(s,r,t){o=s;f=r;q=t;};var h=function(r){j=r;};var k=function(r){i=r;};return{setFormatConfig:l,setUnitConfig:p,setSingleUnitConfig:m,setTextConfig:h,setLocaleConfig:k,setNightTextConfig:b,getDateFormat:function(){return n;},getDateSeparator:function(){return g;},getStartOfWeek:function(){return o;},getMonths:function(){return e;},getSingleMonths:function(){return f;},getDayAbbrs:function(){return q;},getDayNames:function(){return c;},getCloseText:function(){return j;},getLocaleConfig:function(){return i;},getNightTextConfig:function(){return d;}};};return{Config:new a("ddmmyy",".",2)};}();(function(){var l=0,d=false,q=false,e=4,h=4;function g(){if(!d){d=true;if(/Chrom(e|ium|eframe)\/([0-9]+)\./i.test(navigator.userAgent)){l=new Number(RegExp.$2);}}}function c(){g();return((l>=23)&&(l<=24));}function o(t){var r="";var s=t.getMonth();r=t.getFullYear()+((s<9)?("-0"+(s+1)):("-"+(s+1)));var u=t.getDate();r+=(u<10)?("-0"+u):("-"+u);return r;}if(c()){$(".hero-form").on("mousedown","#search-button",function(){a();});}$(".hero-form").on("click","#search-button",function(){k();});function j(){var r=corewizard.model.getGlobalModel();var s="";if(r.get("tab")==="flight"){s="flightOnly";if(r.get("packages.hotel")){s=(r.get("packages.car"))?"flightHotelAndCar":"flightAndHotel";}else{if(r.get("packages.car")){s="flightAndCar";}}}else{if(r.get("tab")==="hotel"){s="hotelOnly";if(r.get("packages.flight")){s=(r.get("packages.car"))?"flightHotelAndCar":"flightAndHotel";}else{if(r.get("packages.car")){s="hotelAndCar";}}}else{if(r.get("tab")==="package"){s="flightAndHotel";if(r.get("packages.hotel")&&r.get("packages.flight")&&r.get("packages.car")){s="flightHotelAndCar";}else{if(r.get("packages.hotel")&&r.get("packages.flight")){s="flightAndHotel";}else{if(r.get("packages.hotel")&&r.get("packages.car")){s="hotelAndCar";}else{if(r.get("packages.flight")&&r.get("packages.car")){s="flightAndCar";}}}}}}}return s;}function n(){var t=corewizard.model.getGlobalModel();var s=new corewizard.config(corewizard.config_data);var r=new corewizard.validation(t,s);var u=true;if(t.get("tab")==="flight"&&!(t.get("packages.car")||t.get("packages.hotel"))){corewizard.validation.flightRules.run(t.getAll(),s.getAll("flight"),r);}else{if(t.get("tab")==="hotel"&&!(t.get("packages.car")||t.get("packages.flight"))){corewizard.validation.hotelRules.run(t.getAll(),s.getAll("hotel"),r);}else{if(t.get("tab")==="package"||(t.get("packages.car")&&(t.get("packages.hotel")||t.get("packages.flight")))||(t.get("packages.hotel")&&t.get("packages.flight"))){corewizard.validation.packageRules.run(t.getAll(),s.getAll("package"),r);}}}return t.get("validation.isValid");}var m=function(w,K,y,v,I,t){try{if(w||!K.enabled||!n()){return;}var F=K[y]||K["default"],u=v.daysUntilDeparture,x=v.departureDate,C=v.returnDate,z=v.regionId,s=v.destionation,G=this.site_id,L=v.origin,J=v.rooms,A=J?J.length:0,r=v.noOfAdults,E=0;if(u<=7){F=K[y+"0To7Days"]||F;}var D=function(){I.initialize(y,G,z,L,s,x,C,A,r,0,0,F);};if((F.indexOf("intentmedia")>-1)&&t&&t.fill_exit_unit){i();t.fill_exit_unit();}else{if(F.indexOf("hotwire")>-1){D();}else{if(F.indexOf("popunder")>-1){i();var B=(window.ab4824status===1);if(B&&t&&t.fill_exit_unit){t.fill_exit_unit();}else{D();}}}}}catch(H){console.error("Error loading exit window "+H.name+" : "+H.message);}};function k(){try{var t=b(),s=(window.adExitWindow&&window.adExitWindow.config)||{},w=j(),r=window.PopUnder||{},u=window.IntentMedia||{};return m(q,s,w,t,r,u);}catch(v){console.error("Error initializing exit window "+v.name+" : "+v.message);}}var b=function(){var B=window.corewizard.model.getGlobalModel(),z={};var t=exp.core.date.CalendarControl.Config;var v=new exp.core.date.Calendar(t);var x=v.getDateFromString(B.get("departing"));var s=v.getDateFromString(B.get("returning"));var u="";var A="";if(x&&s){u=o(x);A=o(s);}z.daysUntilDeparture=Math.round(Math.abs(((new Date()).getTime()-x.getTime())/86400000));z.departureDate=u;z.returnDate=A;z.regionId=B.get("regionId");z.destionation=B.get("destination");z.origin=B.get("origin");z.rooms=B.get("rooms");var w=z.rooms?z.rooms.length:0;var C=0;for(var y=0;y<w;y++){var r=(z.rooms[y]&&z.rooms[y].adults)?parseInt(z.rooms[y].adults,10):2;if(!isNaN(r)){C+=r>0?r:2;}}z.noOfAdults=C;return z;};function p(u){var t="",s=[];var r=corewizard.model.getGlobalModel();if(!r||!r.get("destination")){return"";
}else{s=r.get("destination").split(",");switch(u){case 1:t=(typeof s[0]==="undefined")?"":s[0].replace(/\(([^)]+)\)/,"");break;case 2:t=(typeof s[1]==="undefined"||s.length<=2)?"":s[1].replace(/\(([^)]+)\)/,"");break;case 3:if(typeof s[2]==="undefined"){t=(typeof s[1]!=="undefined")?s[1].replace(/\(([^)]+)\)/,""):"";}else{t=s[2].replace(/\(([^)]+)\)/,"");}break;default:break;}}return(typeof t==="string")?t.replace(/^\s+|\s+$/g,""):t;}$("#tab-hotel-tab").click(function(){f("homepage.hotels");});$("#tab-flight-tab").click(function(){f("homepage.flights");});function f(r){window.IntentMediaProperties=window.IntentMediaProperties||{};window.IntentMediaProperties.page_id=r;if(window.IntentMedia&&window.IntentMedia.page_id_updated){window.IntentMedia.page_id_updated();}}function i(){window.IntentMediaProperties=window.IntentMediaProperties||{};var y=j();if(y==="flightOnly"){window.IntentMediaProperties.control_group="N";}else{window.IntentMediaProperties.control_group=(window.ab4824status===0)?"Y":"N";}var x=corewizard.model.getGlobalModel();var v=x.get("departing").split("/");window.IntentMediaProperties.travel_date_start=v[2]+v[0]+v[1];var w=x.get("returning");if(w.length>0){var C=w.split("/");window.IntentMediaProperties.travel_date_end=C[2]+C[0]+C[1];}else{window.IntentMediaProperties.travel_date_end="";}setDefaultForRoomOneAdults();var r=x.get("rooms");var t=(y==="flightOnly")?1:(r?r.length:0);var z=0;var s=0;for(var u=0;u<t;u++){z+=parseInt(r[u].adults);s+=r[u].children.length;}window.IntentMediaProperties.adults=z;window.IntentMediaProperties.children=s;window.IntentMediaProperties.travelers=z+s;if(y==="flightOnly"){window.IntentMediaProperties.page_id="homepage.flights";window.IntentMediaProperties.trip_type=x.get("flighttype");var B=x.get("origin");var A=x.get("destination");window.IntentMediaProperties.flight_origin=B.substr(B.indexOf("(")+1,3);window.IntentMediaProperties.flight_destination=A.substr(A.indexOf("(")+1,3);delete window.IntentMediaProperties.hotel_rooms;delete window.IntentMediaProperties.hotel_city;delete window.IntentMediaProperties.hotel_state;delete window.IntentMediaProperties.hotel_country;delete window.IntentMediaProperties.hotel_market_id;}else{if(y==="hotelOnly"){window.IntentMediaProperties.page_id="homepage.hotels";window.IntentMediaProperties.hotel_rooms=t;window.IntentMediaProperties.hotel_city=p(1);window.IntentMediaProperties.hotel_state=p(2);window.IntentMediaProperties.hotel_country=p(3);window.IntentMediaProperties.hotel_market_id=x.get("regionId");delete window.IntentMediaProperties.trip_type;delete window.IntentMediaProperties.flight_origin;delete window.IntentMediaProperties.flight_destination;}}}function a(){var t=corewizard.model.getGlobalModel();var v=j();if((v!=="")&&(typeof(PopUnder)!="undefined")){q=false;if(n()){var y=exp.core.date.CalendarControl.Config;var G=new exp.core.date.Calendar(y);var u=G.getDateFromString(t.get("checkin"));var w=G.getDateFromString(t.get("checkout"));var B="";var A="";if((typeof(u)!="undefined")&&(typeof(w)!="undefined")&&null!=u&&null!=w){B=o(u);A=o(w);}var x=t.get("regionId");var s=t.get("destination");var F=this.site_id;var I=t.get("origin");var H=t.get("rooms");var z=H?H.length:0;var r=0;for(var E=0;E<z;E++){var C=(H[E]&&H[E].adults)?parseInt(H[E].adults,10):2;if(!isNaN(C)){r+=C;}}if(z>e){z=e;}var D=z*h;if(r>D){r=D;}PopUnder.handleMouseDownForChrome23(v,F,x,I,s,B,A,z,r);}else{q=true;}}}})();function startLocalFavouritesModule(){var a=$(".local-favourites-module");window.localFavouritesModule={};if(a.length>0){$.each(a,function(b){window.localFavouritesModule[b]=new LocalFavouritesModule({index:b,containerEl:$(this),moduleTimeOut:$(this).attr("data-module-timeout"),mcicid:$(this).attr("data-mcicid"),responseModels:$(this).attr("data-response-models"),dataSource:{tplToUse:$(this).attr("data-tpl-to-use").replace(/-/g,""),url:$(this).attr("data-url")},loaders:{primary:'<div title="Loading..." class="loader"></div>',secondary:'<div title="Loading..." class="loader-secondary"></div>'}});});}}uitk.subscribe("contentSlider.pageChange",function(b,d,a){var c=d.parent();if(c.hasClass("local-favourites-module")){var e=window.localFavouritesModule[c.index(".local-favourites-module")];if(e.debug){console.info("LocalFavouritesModule - "+e.index+": uitk contentSlider.pageChange event fired",d,e);}e.updateTracking(e.pageData.contentSliderTiles);}});var LocalFavouritesModule=function(a){var b=this;b.debug=(typeof window.console=="object")?true:false;b.defaults=a;b.containerEl=a.containerEl;b.index=a.index+1;b.pageData={};b.dynamicData={};b.dynamicData.responseModels=a.responseModels;b.loaders=a.loaders;b.moduleTemplates={};b.moduleHeight="";b.init();};LocalFavouritesModule.prototype.init=function(){var a=this;a.getDynamicData();a.getPageData();a.getModuleTemplates();a.loadUtils();a.bindEvents();a.loaderAnim("start");a.containerEl.attr("id","local-favourites-module-"+a.index+"-container");};LocalFavouritesModule.prototype.getPageData=function(b){var a=this;a.pageData={localFavouritesTpls:$(".local-favourites-module-tpl"),contentSliderPages:a.containerEl.find(".content-slider-pages"),contentSlider:a.containerEl.find(".content-slider"),contentSliderMask:a.containerEl.find(".content-slider-mask"),contentSliderTileGrid:a.containerEl.find(".tile-grid"),contentSliderTiles:a.containerEl.find(".tile"),contentSliderControls:a.containerEl.find(".content-slider-controls"),alertInfo:a.containerEl.find(".alert-info"),secondaryBoxes:a.containerEl.find(".tile")};if(typeof b=="function"){b();}};LocalFavouritesModule.prototype.getModuleTemplates=function(){var b=this;var a=b.defaults.dataSource.tplToUse;b.moduleTemplates[a]=Handlebars.partials[a];};LocalFavouritesModule.prototype.getDynamicData=function(){var b=this;try{$.ajax({url:encodeURI(b.defaults.dataSource.url),cache:true,dataType:"json",timeout:parseInt(b.defaults.moduleTimeOut),success:function(c){if(c.hasOwnProperty(b.dynamicData.responseModels)){$(b).trigger("LocalFavouritesModule:response-loaded",{dataContainer:b.dynamicData.responseModels+"Container",dataRoot:b.dynamicData.responseModels,tplToUse:b.defaults.dataSource.tplToUse,data:c});$(".tile-price strong").each(function(){var e=$(this).html();var d=$("<span>"+e.charAt(0)+"</span>").addClass("currency");$(this).html(e.substring(1)).prepend(d);});}else{$(b.containerEl).html("");}},error:function(){$(b.containerEl).html("");console.log("request failed");}});}catch(a){$(b.containerEl).html("");}};LocalFavouritesModule.prototype.bindEvents=function(){var a=this;$(a).bind("LocalFavouritesModule:response-loaded",function(c,b){if(a.debug){console.info("LocalFavouritesModule - "+a.index+": response-loaded event fired ");}if(b.data.errorCode==0&&b.data[b.dataRoot][0].items.regions[0].hotels.length>2){a.dynamicData[b.dataContainer]=b.data;a.render(b.dataContainer,b.dataRoot,b.tplToUse,b);}else{$(a.containerEl).html("");}});$(a).bind("LocalFavouritesModule:display-error",function(c,b){if(a.debug){console.info("LocalFavouritesModule - "+a.index+": display-error event fired | ",b.msg," | ",b.error);}a.pageData.contentSlider.hide();a.pageData.contentSlider.height("auto");a.loaderAnim("stop");a.pageData.alertInfo.removeClass("hidden").bind("click",function(){a.containerEl.delay("500").fadeOut();});});};LocalFavouritesModule.prototype.loadUtils=function(){var a=this;a.objectSize=function(d){var c=0,b;for(b in d){if(d.hasOwnProperty(b)){c++;}}return c;};a.sortJSON_by=function(d,b,e){var c=e?function(f){return e(f[d]);}:function(f){return f[d];};return function(h,g){var f=c(h),i=c(g);return(f<i?-1:(f>i?+1:0))*[-1,1][+!!b];};};Handlebars.registerHelper("LFMunescape",function(b){return unescape(b);});Handlebars.registerHelper("LFMuseLargerImage",function(b){console.log(b);return b.replace("_l.jpg","_b.jpg");});Handlebars.registerHelper("LFMstarRating",function(b){return b.replace(/\./,"-");});Handlebars.registerHelper("LFMaddSpaces",function(b){var c=b.replace(/%20/g,"&nbsp;");c=c.replace(/%2C/g,",");c=c.replace(/%22/g,'"');
c=c.replace(/%26/g,"&");c=c.replace(/%27/g,"'");c=c.replace(/%28/g,"(");c=c.replace(/%29/g,")");c=c.replace(/%2A/g,"*");c=c.replace(/%2D/g,"-");c=c.replace(/%2E/g,".");return c;});Handlebars.registerHelper("LFMlist",function(e,f){var c="";for(var d=0,b=e.length;d<b;d++){c=c+f.fn(e[d]);}return c;});};LocalFavouritesModule.prototype.updateTracking=function(c){var f=this,b=Math.floor(f.pageData.contentSliderMask.width()/$(c[0]).width()),h=1,g=1;if(f.debug){console.info("LocalFavouritesModule - "+f.index+": updateing tracking ids | calculating no. of tiles on current page | mask width = "+f.pageData.contentSliderMask.width()," tile width = "+$(c[0]).width()," No. of tiles on page = "+Math.floor(f.pageData.contentSliderMask.width()/$(c[0]).width()));}$.each(c,function(j){if($(this).children("a").attr("href").indexOf(f.defaults.mcicid)==-1){a($(this),j);}else{d($(this),j);}});function e(j,o){var m=j.split("?"),n,l,k;if(m.length>=2){n=encodeURIComponent(o)+"=";l=m[1].split(/[&;]/g);for(k=l.length-1;k>0;k--){if(l[k].lastIndexOf(n,0)!==-1){l.splice(k,1);j=m[0]+"?"+l.join("&");}}}return j;}function a(l,k){var j="",n=l.children("a"),m=n.attr("href");if(k>0&&k%b==0){g=1;h++;}j="."+h+"."+g;l.attr("data-tracking-id",f.defaults.mcicid+j);m=m+f.defaults.mcicid+j;n.attr("href",m);g++;}function d(k,j){k.attr("data-tracking-id","");var l=e(k.children("a").attr("href"),"mcicid");k.children("a").attr("href",l);a(k,j);}};LocalFavouritesModule.prototype.render=function(k,l,j,a){var g=this,c=0,h=0,b=[];g.dynamicData[k].renderedHtml="";g.dynamicData[k].id=g.index;if(g.debug){console.info("LocalFavouritesModule - "+g.index+": ready to render ",g);}g.dynamicData[k][l+"Tiles"]=[];if(typeof g.dynamicData[k][l][0]!="undefined"){for(i in g.dynamicData[k][l]){if(typeof g.dynamicData[k][l][i]=="object"){g.dynamicData[k][l][i].moduleId=g.index;g.dynamicData[k][l][i].slideTileId=h;if(h>0&&h%3==0){c++;}g.dynamicData[k][l][i].slidePageId=c;g.dynamicData[k][l+"Tiles"][i]=g.dynamicData[k][l][i];h++;}}}else{$(g.containerEl).html("");console.log("cannot parse JSON for some reason");}var e=a.data.recommendations[0].items.regions;var f=[];for(var i=0;i<e.length;i++){f=f.concat(e[i].hotels);}var d={recommendationsTiles:f};g.dynamicData[k].renderedHtml=g.moduleTemplates[j](d);g.loaderAnim("stop");if(g.dynamicData[k].renderedHtml!=""){$(g.dynamicData[k].renderedHtml).appendTo(g.containerEl);g.getPageData(function(){g.pageData.contentSlider.uitk_contentSlider();g.getPageData();g.pageData.contentSliderControls.attr("id","local-favourites-module-"+g.index+"-controls");g.pageData.contentSlider.animate({"height":g.pageData.contentSliderTileGrid.height()+g.pageData.contentSliderControls.children("button").eq(0).height()+parseInt(g.pageData.contentSliderControls.css("margin-top"))},function(){g.pageData.contentSlider.css("height","auto");});});if(g.debug){console.info("LocalFavouritesModule - "+g.index+": finished ",g);}}};LocalFavouritesModule.prototype.loaderAnim=function(a){var b=this;if(a=="start"){if(b.pageData.loaderPrimary!=undefined){b.pageData.loaderPrimary.show();}else{$(b.loaders.primary).appendTo(b.containerEl);b.pageData.loaderPrimary=b.containerEl.find(".loader");}}else{b.pageData.loaderPrimary.closest(".local-favourites-module").removeClass("loading");}};var typeaheadConfig={typeahead:{def:{minchar:3,maxitems:10,version:"v1",locale:"en_US",mask:95,client:"HOMEPAGE",lob:"FLIGHTS",dest:false,closetext:"Close",continuetext:"Continue typing to refine search",tooltip:true,forceicon:false,template:"default",regionid:1},flight_origin:{forceicon:"flights",selectioncallback:typeaheadFlightOriginCallback},flight_dest:{forceicon:"flights",dest:true,selectioncallback:typeaheadFlightDestinationCallback},flight_multi:{forceicon:"flights"},hotel:{lob:"HOTELS",dest:true,selectioncallback:typeaheadItemClickCallback,mask:223,version:"v1"},package_origin:{forceicon:"flights",lob:"PACKAGES",selectioncallback:typeaheadPackageOriginCallback},package_dest:{forceicon:"flights",dest:true,lob:"PACKAGES",selectioncallback:typeaheadPackageDestinationCallback},car_origin:{lob:"CARS",selectioncallback:typeaheadCarPickUpCallback,mask:31,version:"v3",template:"category"},car_dest:{lob:"CARS",forceicon:"flights",dest:true,mask:1}}};var recentlyViewed={hotelIds:[],rvModel:[]};recentlyViewed.init=function(b){function a(){recentlyViewed.getModel();recentlyViewed.renderModel();recentlyViewed.initRecommendations();}if(recHBookedF&&lbi&&lbi.destinationAirport!=""){var c=lbi.destinationName.substring(5,lbi.destinationName.indexOf("&"));c=c.replace("+"," ");recentlyViewed.getHotelRecommendations(lbi.destinationAirport,c,lbi.startDate.m_dateTimeString,lbi.endDate.m_dateTimeString,1,"flight",true);}else{a();recentlyViewed.getUrgencyMessages();}};recentlyViewed.renderModel=function(){if(recentlyViewed.rvModel[0]){var c={title:(signedIn&&username&&username.length>0)?username+"'s Recent Searches":"Your Recent Searches",rvModel:recentlyViewed.rvModel};var a=Handlebars.partials["handlebars/recentlyviewed/container"];var b=a(c);$(".rv-container").html(b).find(".box:odd").addClass("even");recentlyViewed.addPlaceholders();}};recentlyViewed.addPlaceholders=function(){var a=recentlyViewed.rvModel.length;$("article.placeholder").remove();$(".rv-container .even").removeClass("even");$(".rv-container").find(".box:odd").addClass("even");if(a%2>0){$("#rv-container .cols-row").append("<article class='box placeholder even'></article>");}};$(function(){var b=document.getElementById("rv-container"),a={"rvH":"Home.RV.Hotel","rvP":"Home.RV.Package","rsF":"Home.RS.Flight","rsH":"Home.RS.Hotel","rsP":"Home.RS.Package"};$(b).find(".box.col").each(function(){var c=$(this).attr("data-rv-type"),d=$(this).find("a"),e=$(d).attr("href");if(e.indexOf("?")==-1){e+="?";}else{if(e.slice(-1)!="&"){e+="&";}}$(d).attr("href",e+"rfrr="+a[c]);});});$(".rv-container").on(uitk.clickEvent,".rv-remove",function(b){var a=$(this).parents("article.box");recentlyViewed.deleteBox(a);b.stopPropagation();b.preventDefault();});recentlyViewed.deleteBox=function(c){var d=c.attr("id");var b=c.attr("data-rv-type");c.remove();var a=recentlyViewed.rvModel.length;if(a==1){$("#rv-container .cols-row").prepend("<article class='box placeholder'></article>");recentlyViewed.rvModel.length=0;}else{$.each(recentlyViewed.rvModel,function(e,f){if(d==f.id){recentlyViewed.rvModel.splice(e,1);return false;}});recentlyViewed.addPlaceholders();}recentlyViewed.initRecommendations();if(b=="rvH"){d=d.split("-")[1];}else{if(b=="rvP"){d="VP-"+d.split("-")[1];}else{if(b=="rsH"){d="SH-"+c.find(".rv-remove").attr("sfid");}else{if(b=="rsF"){d=c.find(".rv-remove").attr("sfid");}else{if(b=="rsP"){d="SP-"+c.find(".rv-remove").attr("sfid");}}}}}recentlyViewed.notInterested(d);};recentlyViewed.notInterested=function(a){$.ajax({url:"/UserActivityData/notInterested?id="+a,cache:false});};recentlyViewed.getModel=function(){recentlyViewed.rvModel=[];recentlyViewed.hotelIds.length=0;$("#rv-container").addClass("ab3293");recentlyViewed.sortByTimestamp();return recentlyViewed.rvModel;};recentlyViewed.sortByTimestamp=function(){function d(s,t,r,u){if(s<t){var v=new Date(r[s].searchedDate||r[s].viewedDate);if(g==""||v>g){g=v;a=u;}}}var m=rvP_index=rsH_index=rsF_index=rsP_index=0;var o=(UAD.viewedHotels)?UAD.viewedHotels.length:0;var c=(UAD.viewedPackages)?UAD.viewedPackages.length:0;var e=(UAD.searchedHotels)?UAD.searchedHotels.length:0;var p=(UAD.searchedFlights)?UAD.searchedFlights.length:0;var i=(UAD.searchedPackages)?UAD.searchedPackages.length:0;var n=8;var b=0;while(b<n&&(rsH_index<e||rsF_index<p||rsP_index<i||m<o||rvP_index<c)){var g="";var a="";d(rsH_index,e,UAD.searchedHotels,"rsH");d(rsF_index,p,UAD.searchedFlights,"rsF");d(rsP_index,i,UAD.searchedPackages,"rsP");d(m,o,UAD.viewedHotels,"rvH");d(rvP_index,c,UAD.viewedPackages,"rvP");var q;if(a=="rsH"){var k=UAD.searchedHotels[rsH_index];q=recentlyViewed.convertRSItem(k,"hotel",rsH_index++);}else{if(a=="rsF"){var l=UAD.searchedFlights[rsF_index];q=recentlyViewed.convertRSItem(l,"flight",rsF_index++);
q.ab3293=true;}else{if(a=="rsP"){var h=UAD.searchedPackages[rsP_index];q=recentlyViewed.convertRSItem(h,"package",rsP_index++);}else{if(a=="rvH"){var j=UAD.viewedHotels[m];q=recentlyViewed.convertRVItem(j,"hotel",m++);recentlyViewed.hotelIds.push(j.hotelId);q.ab3293=true;}else{if(a=="rvP"){var f=UAD.viewedPackages[rvP_index];q=recentlyViewed.convertRVItem(f,"package",rvP_index++);}}}}}recentlyViewed.rvModel.push(q);b++;}};recentlyViewed.formatDate=function(b){if(!b){return"";}var a=new Date(b);return a.toDateString().substr(0,a.toDateString().length-5);};recentlyViewed.formatDatePair=function(b,a){if(!b||!a){return"";}return recentlyViewed.formatDate(b)+" - "+recentlyViewed.formatDate(a);};recentlyViewed.formatDateStandard=function(a){if(!a){return null;}var a=new Date(a);return a.getMonth()+1+"/"+a.getDate()+"/"+a.getFullYear();};recentlyViewed.convertRVItem=function(c,b,a){var d={};d.isRV=true;d.hotelId=c.hotelId;d.hotelName=c.hotelName;d.localizedPageUrl=c.localizedPageUrl;d.thumbnail=(c.thumbnail)?c.thumbnail.replace("_t","_s"):"";d.city=c.regionLongName.substr(0,c.regionLongName.indexOf(","))||c.regionLongName;d.dates=recentlyViewed.formatDatePair(c.checkInDate,c.checkOutDate);d.checkIn=c.checkInDate;d.checkOut=c.checkOutDate;d.travelerUnits=c.travelerUnits;if(b=="hotel"){d.id="rvH"+a+"-"+c.hotelId;d.rvType="rvH";d.isRVH=true;d.price=(c.price&&c.price.amount)?"$"+Math.round(c.price.amount):"See price";d.ab3293viewedHotelStars=false;d.starsIcon=c.starRating.replace(".","-");d.stars=c.starRating;}else{if(b=="package"){d.id="rvP"+a+"-"+c.hotelId;d.rvType="rvP";d.isRVP=true;d.price=(c.packagePricePerPerson&&c.packagePricePerPerson.amount)?"$"+Math.ceil(c.packagePricePerPerson.amount):"See price";if(c.packageSavings&&c.packageSavings.amount>0){d.packageSavings="$"+Math.round(c.packageSavings.amount);}if(c.origin&&c.origin.city&&c.destination&&c.destination.city){d.info=c.origin.city+" to "+c.destination.city;}}}if(d.price=="See price"){d.seePrice=true;}else{if(d.isRVH==true){d.additionalPriceInfo="per night";}else{if(d.isRVP==true){d.additionalPriceInfo="per person";}}}return d;};recentlyViewed.convertRSItem=function(j,i,h){var b={};if(i=="hotel"){b.hotelName=(j.searchType=="CITY")?"Hotels in "+j.destination:"Hotels near "+j.destination;b.dates=recentlyViewed.formatDatePair(j.checkinDate,j.checkoutDate);var d=j.numRooms+" room";if(j.numRooms>1){d+="s";}var k=j.numNights+" night";if(j.numNights>1){k+="s";}b.info=d+", "+k;if(j.price){j.price="$"+Math.round(j.price.substring(1));}b.rvType="rsH";b.id="rsH"+h;b.isRSH=true;}else{if(i=="flight"){b.hotelName="Flights from "+j.origin.city+" ("+j.originTLA+") to "+j.destination.city+" ("+j.destinationTLA+")";b.rsfShortName=j.originTLA+" to "+j.destinationTLA;b.localizedPageUrl=j.searchUrl;b.dates=recentlyViewed.formatDatePair(j.departureDate,j.returnDate);b.rvType="rsF";b.id="rsF"+h;b.isRSF=true;b.destTLA=j.destinationTLA;b.start=j.departureDate;b.end=j.returnDate;b.city=j.destination.city;b.flightType=j.flightType;if(b.flightType=="ROUND_TRIP"){b.flightType="Roundtrip";}else{if(b.flightType=="MULTIPLE_DESTINATION"){b.flightType="Multiple destinations";}else{if(b.flightType=="ONE_WAY"){b.flightType="One way";b.dates=recentlyViewed.formatDate(j.departureDate);}}}b.travelerUnit=j.travelerUnit;}else{if(i=="package"){b.hotelName=j.origin.city+" to "+j.destination.city;b.dates=recentlyViewed.formatDatePair(j.departureDate,j.returnDate);b.rvType="rsP";b.id="rsP"+h;b.isRSP=true;var d=[];var a=true;$.each(j.travelerUnits,function(l,m){var n={};n.adults=m.numberOfAdults;n.children=m.childAges;d.push(n);a=!m.infantInLap;});var g=recentlyViewed.formatDateStandard(j.departureDate);var f=recentlyViewed.formatDateStandard(j.returnDate);var c={destination:j.destinationTLA,origin:j.originTLA,departing:g,returning:f,rooms:d,lapSeat:(a)?"lap":"seat"};if((j.checkInDate&&j.checkInDate!=j.departureDate)||(j.checkOutDate&&j.checkOutDate!=j.returnDate)){c.isPartialStay=true;c.checkin=recentlyViewed.formatDateStandard(j.checkInDate);c.checkout=recentlyViewed.formatDateStandard(j.checkOutDate);}var e=new corewizard.model();e.setAll(c);b.localizedPageUrl=packageSearchUrl(e,"flightHotel");}}}b.isRS=true;b.sfid=j.cacheKey;b.price=j.price||"See price";if(b.price=="See price"){b.seePrice=true;if(b.isRSP==true){b.price="See full search";b.additionalPriceInfo="Over 540 deals";}}else{if(b.isRSF==true){b.additionalPriceInfo="per person";}}return b;};recentlyViewed.getUrgencyMessages=function(){if(recentlyViewed.hotelIds.length>0){recentlyViewed.getFreeCancellation(recentlyViewed.hotelIds);recentlyViewed.getTrendMessage(recentlyViewed.hotelIds);}};recentlyViewed.getFreeCancellation=function(a){var b="";$.each(a,function(c,d){b=b+"&hotelId="+d;});$.ajax({dataType:"json",url:"/UserActivityDataAjax/getAdditionalHotelAvailInfo?"+b,success:recentlyViewed.freeCancellationCallback,cache:false,timeout:5000});};recentlyViewed.freeCancellationCallback=function(a){if(a!==null){if(typeof a=="string"){if(a.substring(0,5)==="Error"){recentlyViewed.getTrendMessage(recentlyViewed.hotelIds);return false;}dataArray=JSON.parse(a);}else{dataArray=a;}for(var b=0;b<dataArray.length;b++){data=dataArray[b];if(data.freeCancellation){$("[data-hotelId="+data.hotelId+"] .rv-price-info").append('<span class="price-info-additional free-cancellation" style="display:none;">Free cancellation</span>');}else{if(data.numberOfRoomsLeft&&parseInt(data.numberOfRoomsLeft)>0){var c=(data.numberOfRoomsLeft>1)?data.numberOfRoomsLeft+" rooms left":data.numberOfRoomsLeft+" room left";$("[data-hotelId="+data.hotelId+"] .rv-price-info").append('<span class="price-info-additional number-of-rooms-left" style="display:none;">'+c+"</span>");}}}$(".free-cancellation, .number-of-rooms-left").fadeIn(1000);}};recentlyViewed.getTrendMessage=function(a){if(typeof a=="object"&&a.length>0){$.ajax({"url":"/Hotels/Offers","data":{"action":"getAndUpdateHotelProductActivity","hotelIds":a.join(","),"durationForViews":1800000,"durationForBookings":172800000},"success":recentlyViewed.trendMessageCallback,"timeout":5000,"dataType":"json"});}};recentlyViewed.trendMessageCallback=function(a){if(a!==null){if(typeof a=="string"){a=JSON.parse(a);}$.each(a.HotelProductActivityList,function(b,d){var c="";if(d.BookingCount&&parseInt(d.BookingCount)>0){c=d.BookingCount+((parseInt(d.BookingCount)==1)?" booking in the last 48 hours":" bookings in the last 48 hours");}else{if(d.ViewCount&&parseInt(d.ViewCount)>0){c=d.ViewCount+((parseInt(d.ViewCount)==1)?" other viewing this hotel now":" others viewing this hotel now");}}if(c){$("[data-hotelId="+d.HotelId+"] .rv-trip-info .trip-info-additional").html('<span class="icon icon-trend" style="display:none;"></span><span style="display:none;">'+c+"</span>").addClass("trend-msg");}});$(".rv-trip-info .trip-info-additional span").fadeIn(1000);}};recentlyViewed.initRecommendations=function(){var d=recentlyViewed.rvModel[0];var a="";if(d&&d.rvType=="rvH"&&recVH){var f=[];$.each(d.travelerUnits,function(g,h){var i=h.numberOfAdults;if(h.childAges.length>0){i+=";"+h.childAges.join(":");}f.push(i);});var c=f.join(",")||"1";a=recentlyViewed.getHotelRecommendations(d.hotelId,d.city,d.checkIn,d.checkOut,c,"hotel");}else{if(d&&d.rvType=="rsF"&&recSF){if(!(d.flightType=="One way")&&!(d.flightType=="Roundtrip"&&d.start==d.end)&&!(d.flightType=="Multiple destinations"&&d.sfid.substring(20,23)==d.sfid.substring(23,26))){var b=d.travelerUnit;var e=b.numberOfAdults;if(b.childAges.length>0){e+=";"+b.childAges.join(":");}var c=e||"1";a=recentlyViewed.getHotelRecommendations(d.destTLA,d.city,d.start,d.end,c,"flight");}}}return a;};recentlyViewed.getHotelRecommendations=function(i,e,b,f,j,g,d){var e=e;var b=b;var f=f;function h(n){var m=new Date();return(m.toDateString()==new Date(n).toDateString());}function l(m){if(!m){return null;}var m=new Date(m);return m.getMonth()+1+"/"+m.getDate()+"/"+m.getFullYear();}function k(q,o,m,n,p){if(q&&!h(o)){Recommender.call(q,l(o),l(m),n,p,a,c);}}function a(s){if(s.length>=3){var q=[];
var n=recentlyViewed.formatDatePair(b,f);$.each(s,function(v,w){var x={};x.id=w.hotelId;if($.inArray(x.id,recentlyViewed.hotelIds)==-1){x.localizedPageUrl=w.urlToHotelInfosite;x.thumbnail=w.urlToThumbnail;x.hotelName=decodeURIComponent(w.hotelName);x.starsIcon=w.starRating.replace(".","-");x.stars=w.starRating;x.city=(w.hotelProvince)?w.hotelCity+", "+w.hotelProvince:w.hotelCity;x.price=w.averagePrice.replace(/%24/g,"").replace(/%2C/g,"");x.dates=n;q.push(x);}});if(q.length>=3){var t=(d)?"Because you booked a flight to "+e:"Based on your recent search in "+e;var o={hotel:q,title:t};var u=Handlebars.partials["handlebars/recommender/container"];var r=u(o);var p=$(".recommender-container");var m=$(".banner-ads-wrapper");if(m.length>0){p.insertAfter(m);}p.html(r);$("#rec-content-slider").uitk_contentSlider();}}}function c(m){}k(i,b,f,j,g);return g+"-"+e;};var Recommender=(function(){var b,e,d,h,i;function j(p){getMonthString=function(w){var v=parseInt(w,10);var u=h.split(",");return u[v-1];};if(p){if(typeof d=="undefined"||typeof h=="undefined"){return"";}var t=/[^A-Za-z0-9]+/;var r=d.split(t);var s=0;var n=1;for(var q=0;q<r.length;q++){if(r[q]=="MM"){s=q;}if(r[q]=="dd"){n=q;}}var o=p.split(t);return getMonthString(o[s])+" "+o[n];}else{return"";}}function c(r,t,x,w){var o=[];var u=3;for(var s=0;s<r.length&&u>0;s++){var q=r[s];var n=q.urlToThumbnail;if(n==""||n=="http://media.expedia.com/"){n="/static/default/default/images/hotResult/noPhotosAvailSmall.gif";}else{n=n.replace("_l.jpg","_t.jpg");}var y=false;for(var p=0;p<t.length;p++){if(t[p]==q.hotelId){y=true;break;}}if(!y){u--;t.push(q.hotelId);var v={"hotelId":q.hotelId,"index":s,"hotelName":decodeURIComponent(q.localizedHotelName?q.localizedHotelName:q.hotelName),"urlToThumbnail":n,"starDotRating":q.starRating,"starDashRating":q.starRating.replace(".","-"),"hotelCity":q.hotelCity,"averagePrice":decodeURIComponent(q.averagePrice,10),"crossOutPrice":decodeURIComponent(q.crossOutPrice,10),"crossOutPriceValue":parseInt(q.crossOutPriceValue),"percentageSavingsString":parseInt(q.percentageSavingsString),"urlToHotelInfosite":q.urlToHotelInfosite+"&rfrr="+x,"priceUrlToHotelInfosite":q.urlToHotelInfosite+"&rfrr="+w,"startDate":j(b),"endDate":j(e),"recommended":true,"urgency":Urgency.formatUrgencyMsg({"BookingCount":q.peopleBooked,"ViewCount":q.otherViewing})};o.push(v);}}return o;}function m(r,t,y){var o=[];var v=5;for(var s=0;s<r.length&&v>0;s++){var q=r[s];v--;t.push(q.hotelId);var p=q.starRating.toFixed(1);var u="$"+q.pricePerNight.toFixed(0);var x=q.imageUrl;if(x==""||x=="http://media.expedia.com/"){x="/static/default/default/images/hotResult/noPhotosAvailSmall.gif";}else{x=x.replace("_l.jpg","_t.jpg");}var n=unescape(q.dealDeepLink)+"&rfrr="+y;var w={"hotelId":q.hotelId+"","index":s,"hotelName":q.name,"urlToThumbnail":x,"starDotRating":p,"starDashRating":p.replace(".","-"),"hotelCity":q.city,"averagePrice":u,"urlToHotelInfosite":n,"priceUrlToHotelInfosite":n,"startDate":j(q.checkInDate.substring(5).replace(/-/g,"/")),"endDate":j(q.checkOutDate.substring(5).replace(/-/g,"/")),"recommended":true,"urgency":"Urgent"};o.push(w);}return o;}function l(p,o,n){$.ajax({url:p,async:true,dataType:"html",timeout:5000,success:function(q){if(q!=null){o(q);}else{n();}},error:function(s,q,r){n();}});}function a(p,n,o){$.ajax({url:p,async:true,dataType:"jsonp",mimeType:"application/jsonp",timeout:5000,success:function(q){if(q!=null&&q.hotels&&q.hotels.length>=4){n(q.hotels);}else{o();}},error:function(s,q,r){o();}});}function f(n,o,p){if(typeof n=="string"){n=JSON.parse(n);}if(n!=null&&n.errorCode==0&&n.hotelModels&&n.hotelModels.length){o(n.hotelModels);}else{p();}}function g(o,n,q){try{if(i!=null){i.abort();}i=$.ajax({"url":"/Hotel-Recommender-Ajax","data":o,"success":function(r){f(r,n,q);},"error":function(){q();},"timeout":5000,"dataType":"json"});}catch(p){q();}}function k(n,o,s,r,w,q,t,p,v){b=o||"";e=s||"";d=p||"";h=v||"";var r=r||"1";var u={"action":"getProductRecommendations","scenario":"homepage","rule":(w=="hotel")?"persona-item-item-xsell":"persona-region-item-xsell","maxCount":8,"getDetails":true,"itemId":n,"itemType":(w=="hotel")?"0":"1","startDate":b,"endDate":e,"travellersInfo":r};g(u,q,t);}return{"call":k,"convertHotelObjects":c,"getGDEDeal":a,"convertGDEHotelObjects":m,"loadAttachFallbackModule":l};})();
/*!  generated on 2014-06-05 16:55:35.764 PDT(-0700) in 16 ms  */

/*!  served in 16 ms  */
