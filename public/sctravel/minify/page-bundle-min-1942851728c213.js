!function(c){var b="uitk_tooltip";var d=function(e,g,f){this.$element=c(e);this.$label=this.$element.closest("label");if(!f.rawHtml){if(uitk){this.template=uitk.getCompiledTemplate(g);}else{g=c(g).html();this.template=Handlebars.compile(g);}}else{this.template=Handlebars.compile(g);}this.opts=c.extend(true,{},d.defaultOptions,f);this.searchType=null;this.cache={};this.ignoreNext=false;this.isClickOn=false;this.bodyClick=false;this.$element.autocomplete="off";this.$element.closest("form").attr("autocomplete","off");this.$element.on("focus",c.proxy(this.focus,this)).on("keydown",c.proxy(this.keyDown,this)).on("keyup",c.proxy(this.keyUp,this)).on("keypress",c.proxy(this.keyPress,this)).on("blur",c.proxy(this.blur,this));this.$ta=c('<div class="typeahead">');if(this.opts.tooltip){this.$element[b]({content:this.$ta,template:'<div class="uitk-tooltip"><div class="tooltip-inner"></div><span class="tooltip-arrow-border"></span><span class="tooltip-arrow"></span></div>'});}else{this.$ta.appendTo(document.body);if(!uitk.isTouchDevice){this.$ta.on("mousedown",c.proxy(this.clickOn,this)).on("mouseup",c.proxy(this.clickOff,this)).on("click",c.proxy(this.click,this)).on("mouseenter","a",c.proxy(this.mouseEnter,this));}else{this.$ta.on("click",function(h){h.preventDefault();});}}this.$element.data("typeahead",this);this.request("zzzzzz",true);};d.prototype={constructor:d,shouldBeOpen:false,startRequest:function(){var e=this.$element.val();if(e.length>=this.opts.minchar){if(!this.cache[e]){this.request(e);}else{this.render(e,this.cache[e]);}}else{this.close();}},request:function(h,g){var f=["//suggest.expedia.com/hint/es/",this.opts.version,"/ac/",this.opts.locale,"/",encodeURIComponent(h),"?callback=?"].join("");var e;if(g){e=c.noop;}else{e=c.proxy(this.callback,this);}c.getJSON(f,{type:this.opts.mask,ab:this.opts.abtest,lob:this.opts.lob,format:"json",dest:this.opts.dest,maxresults:this.opts.maxresults,rid:this.opts.regionid},e);},callback:function(f){var e=f.sr?f.sr:f.r;var g=f.q;if(e&&this.shouldBeOpen){this.cache[g]=e;this.render(g,e);}else{this.cache[g]=[];this.close();}},render:function(n,h){if(h.length>0&&this.$element.val()==n){h.sort(function(q,p){return q.i-p.i;});var e=this.opts;var f={};c.each(h,function(q,p){var r=d.CATEGORIES[p.t];var s=r?r.name:"Other";if(typeof f[s]==="undefined"){f[s]=true;}});var m={};if(this.opts.lob=="HOTELS"){if(f["Region/City"]){m["Region/City"]=[];}if(f["Attractions"]){m["Attractions"]=[];}if(f["Airports"]){m["Airports"]=[];}if(f["Hotels"]){m["Hotels"]=[];}}else{if(this.opts.lob=="CARS"){if(f["Airports"]){m["Airports"]=[];}if(f["Region/City"]){m["Region/City"]=[];}if(f["Attractions"]){m["Attractions"]=[];}}}c.each(h,function(q,p){var r=d.CATEGORIES[p.t];var s=r?r.name:"Other";if(typeof m[s]==="undefined"){m[s]=[];}m[s].push(p);if(e.forceicon){p.icon=e.forceicon;}else{p.icon=r.icon;}if(typeof p.l!="undefined"){p.l=p.l.replace(/'/g,"&#39;");}else{p.l=p.f.replace(/'/g,"&#39;");}p.data=JSON.stringify(p);});var k={continueText:this.opts.continuetext,closeText:this.opts.closetext,results:h,resultsByCategory:m};var l=this.template(k);this.$ta.html(l);if(this.$ta.is(":hidden")){this.$ta.show();}this.$label.addClass("focused");if(this.opts.tooltip){this.$element[b]("show");this.$element[b]("checkPos",true,true);this.$ta.on("mousedown",c.proxy(this.clickOn,this)).on("mouseup",c.proxy(this.clickOff,this)).on(uitk.clickEvent,c.proxy(this.click,this)).on("mouseenter","a",c.proxy(this.mouseEnter,this));}else{var o=parseInt(this.$element.css("height"),10);var g=this.$element.offset();this.$ta.css({top:g.top+o+"px",left:g.left+"px"});this.$ta.show();}}else{this.close();}},close:function(){this.$label.removeClass("focused");if(this.opts.tooltip){this.$element[b]("hide");}else{this.$ta.hide();this.$ta.html("");}if(this.bodyClick){this.$ta.unbind("mousedown",c.proxy(this.cancelEvent,this));c(document.body).unbind("mousedown",c.proxy(this.close,this));this.bodyClick=false;}},prev:function(){var e=this.$ta.find("a"),h=this.$ta.find(".highlight").removeClass("highlight"),f=e.index(h),g=e[f-1];if(g){c(g).addClass("highlight");}},next:function(){var e=this.$ta.find("a"),h=this.$ta.find(".highlight").removeClass("highlight"),f=e.index(h),g=e[f+1];if(g){c(g).addClass("highlight");}},removeHighlights:function(){this.$ta.find(".highlight").removeClass("highlight");},selectHighlighted:function(g){var f=this.$ta.find(".highlight");if(g&&f.length===0){f=c(g.target).closest(".results-item").find("a");}this.updateTextField(f);f.removeClass("highlight");},updateTextField:function(e){if(e){var f=e.attr("data-value");if(f){f=f.replace(/&#39;/g,"'");this.$element.val(f);if(this.opts.selectioncallback){if(typeof this.opts.selectioncallback=="function"){this.opts.selectioncallback(e);}else{if(typeof this.opts.selectioncallback=="string"){window[this.opts.selectioncallback](e);}}}}this.close();this.$element.focus();}},focus:function(e){},keyDown:function(e){var f;if(!e){e=window.event;}f=e.keyCode;switch(f){case 27:this.close();e.stopPropagation();break;case 9:case 13:if(this.$ta.find(".highlight").length){e.stopPropagation();if(f===13){e.preventDefault();}this.selectHighlighted();}break;case 39:if(this.$ta.find(".highlight").length){this.ignoreNext=true;e.stopPropagation();this.selectHighlighted();}break;}},keyPress:function(e){if(!e){e=window.event;}if(e.keyCode==13){this.close();}},keyUp:function(e){if(this.ignoreNext){this.ignoreNext=false;return;}if(!e){e=window.event;}switch(e.keyCode){case 27:break;case 37:this.removeHighlights();break;case 38:this.prev();break;case 40:this.next();break;case 16:case 17:case 18:break;case 13:this.shouldBeOpen=false;break;default:this.shouldBeOpen=true;this.startRequest();break;}},blur:function(){if(!this.isClickOn){this.close();}else{this.$ta.bind("mousedown",c.proxy(this.cancelEvent,this));c(document.body).bind("mousedown",c.proxy(this.close,this));this.bodyClick=true;}},clickOn:function(){this.isClickOn=true;},clickOff:function(){this.isClickOn=false;},click:function(f){f.stopPropagation();f.preventDefault();this.selectHighlighted(f);},mouseEnter:function(f){this.removeHighlights();c(f.currentTarget).addClass("highlight");},cancelEvent:function(e){e.cancelBubble=true;if(e.stopPropagation){e.stopPropagation();}if(e.preventDefault){e.preventDefault();}e.cancel=true;e.returnValue=false;},remove:function(){this.$element.autocomplete="on";this.$element.closest("form").attr("autocomplete","on");this.$element.off("focus",c.proxy(this.focus,this)).off("keydown",c.proxy(this.keyDown,this)).off("keyup",c.proxy(this.keyUp,this)).off("keypress",c.proxy(this.keyPress,this)).off("blur",c.proxy(this.blur,this));this.$ta.off("mousedown",c.proxy(this.mouseDown,this)).off("mouseup",c.proxy(this.mouseUp,this)).off("click",c.proxy(this.click,this)).off("mouseenter","a",c.proxy(this.mouseEnter,this)).remove();}};d.AIRPORT=1;d.CITY=2;d.MULTICITY=4;d.NEIGHBORHOOD=8;d.POI=16;d.ADDRESS=32;d.METROCODE=64;d.HOTEL=128;d.REGIONTYPE={"ALL":31,"AIRPORT":1,"CITIES":2};d.LOB={"HOTELS":"HOTELS","PACKAGES":"PACKAGES","FLIGHTS":"FLIGHTS"};d.CATEGORIES={"CITY":{"id":0,name:"Region/City",icon:"location"},"ATTRACTION":{"id":1,name:"Attractions",icon:"location"},"AIRPORT":{"id":2,name:"Airports",icon:"flights"},"HOTEL":{"id":3,name:"Hotels",icon:"hotels"},"ADDRESS":{"id":4,name:"Address",icon:"location"},"TRAINSTATION":{"id":5,name:"Train Station",icon:"train"},"METROSTATION":{"id":6,name:"Metro Station",icon:"train"}};Handlebars.registerHelper("each_with_key",function(l,f){var h,e="",g,k=f.hash.key;for(g in l){if(l.hasOwnProperty(g)){h=l[g];if(k){h[k]=g;}e+=f.fn(h);}}return e;});d.defaultOptions={minchar:3,maxitems:10,version:"v2",locale:"en_US",abtest:"",mask:(d.AIRPORT|d.CITY|d.MULTICITY|d.NEIGHBORHOOD|d.POI),lob:d.LOB.FLIGHTS,dest:false,closetext:"Close",continuetext:"Continue typing to refine search",selectioncallback:null,tooltip:true,forceicon:false};function a(e){if(e.data("typeahead")){return;}var f=e.data("template");if(f==undefined){return;}if(f.indexOf("/")>=0){c.ajax({url:f,success:function(h){var g=e.data();
g.rawHtml=true;new d(e,h,g);},dataType:"text"});}else{new d(e,f,e.data());}}c(function(){c("body").on("focus.typeahead",'[data-provide="typeahead"]',function(g){g.preventDefault();var f=c(this);a(f);});a(c(c('[data-provide="typeahead"]')[0]));});}(window.jQuery);if("undefined"==typeof(exp)){var exp={};}if("undefined"==typeof(exp.core)){exp.core={};}if("undefined"==typeof(exp.core.date)){exp.core.date={};}exp.core.date.Calendar=function(a){var b={config:a,rM:[31,28,31,30,31,30,31,31,30,31,30,31],getDateFormat:function(){return this.config.getDateFormat();},getDateSeparator:function(){return this.config.getDateSeparator();},getStartOfWeek:function(){return this.config.getStartOfWeek();},getDateFromString:function(g){if(!g||!g.length){return null;}g=g.replace(/\s+/g,"");if(g.match(/[^-|\d|\.|\/]/)){return null;}var h=g.split(/-|\.|\//);for(var f=0;f<h.length;f++){h[f]=parseInt(h[f],10);}if(!h[1]){return null;}var c,l,n;var e=this.getDateFormat();if(e=="yymmdd"){if(!h[2]){return null;}c=h[1];l=h[2];n=h[0];}else{if(e=="mmddyy"){c=h[0];l=h[1];}else{c=h[1];l=h[0];}if(h[2]){n=h[2];}else{n=this.DefYr(c-1,l);}}var k=new Date().getFullYear();c-=1;if(n.toString().length===2){n+=2000;}if(n<k){n=k;}if(n<1601||n>4500||c<0||c>11||l<1||l>this.getMonthCount(c,n)){return null;}return new Date(n,c,l);},toStringFromComp:function(k,c,l){function h(d){return d<10?"0"+d:d;}var f="";var g=this.getDateSeparator();var e=this.getDateFormat();k=h(k);c=h(c);if(e=="mmddyy"){f=c+g+k+g+l;}else{if(e=="ddmmyy"){f=k+g+c+g+l;}else{f=l+g+c+g+k;}}return f;},toStringFromDate:function(f){var e="";var g=this.getDateSeparator();var d=this.getDateFormat();var h=f.getMonth()+1;var c=f.getDate();var k=f.getFullYear();if(d=="mmddyy"){e=h+g+c+g+k;}else{if(d=="ddmmyy"){e=c+g+h+g+k;}else{e=k+g+h+g+c;}}return e;},IsLY:function(c){if(0==c%4&&((c%100!=0)||(c%400==0))){return true;}else{return false;}},DefYr:function(c,g){var e=new Date();var f=(e.getYear()<1000)?1900+e.getYear():e.getYear();if(c<e.getMonth()||(c==e.getMonth()&&g<e.getDate())){f++;}return f;},getMonthCount:function(d,f){var e=this.rM[d];if((1==d)&&this.IsLY(f)){e++;}return e;},IsLastDayOfMonth:function(c){return this.getMonthCount(c.getMonth(),c.getFullYear())==c.getDate();},incrementMonth:function(c){if(c.getMonth()==11){c.setMonth(0);c.setFullYear(c.getFullYear()+1);}else{c.setMonth(c.getMonth()+1);}return c;},decrementMonth:function(c){if(c.getMonth()==0){c.setMonth(11);c.setFullYear(c.getFullYear()-1);}else{c.setMonth(c.getMonth()-1);}return c;}};return b;};exp.core.date.DateUpdater=function(d,b){var a;var c={config:b,calendar:d,register:function(l,t,o,p,n,w){o=o||0;var u=$(l);var k=this.calendar.getDateFromString(u[0].value);var s=$(t);var h=this.calendar.getDateFromString(s[0].value);var g=this.calendar.getDateSeparator();var f=this.calendar.getDateFormat();var v=f.substring(0,2)+g+f.substring(2,4)+g+f.substring(4,6);var e=new Date();e.setHours(0,0,0,0);if(k&&k.valueOf()<e.valueOf()){u[0].value=v;}if(h&&h.valueOf()<e.valueOf()){s[0].value=v;}a=this;var r=function(){a.update("#"+l.id,"#"+t.id,o,p,w);};var q=function(){a.updateByNights(u[0],s[0],o);a.update(u[0],s[0],o,p);};$("body").on("blur","#"+l.id,r);$("body").on("focus","#"+l.id,r);$("body").on("blur","#"+t.id,r);$("body").on("focus","#"+t.id,r);var m=$("#"+l.id+"-stay-nights");if(m.length!=0){m.change(q);m.keypress(q);}},days_between:function(k,h){var l=1000*60*60*24;var g=k.getTime();var f=h.getTime();var e=Math.abs(g-f);return Math.round(e/l);},updateNumberOfNights:function(k,h){var g=document.getElementById("hot-sear-date-num-nights");if(this.config!=undefined&&g!=null){var e=this.config.getNightTextConfig();var f=this.days_between(h,k);if(f>1){g.innerHTML=f+" "+e[1];}else{g.innerHTML=e[0];}g.style.display="inline";}},updateDayName:function(l,f){var k=$("#"+l.id+"-day");if(this.config!=undefined&&k.length!=0){try{var e=f.getDay();if(e==undefined){k.html("");return;}var h=this.config.getDayNames();k.html(h[e]);}catch(g){k.html("");}}},updateByNights:function(f,g,k){var e=this.calendar.getDateFromString($(f).val());var h=$("#"+f.id+"-stay-nights");if(e){e.setDate(e.getDate()+parseInt(h.get(0).value));$(g).val(this.calendar.toStringFromComp(e.getDate(),e.getMonth()+1,e.getFullYear()));}},update:function(g,o,l,m,r){var p=$(g);var n=$(o);var f=this.calendar.getDateFromString(p.val());var e=this.calendar.getDateFromString(n.val());var h=$("#"+g.id+"-stay-nights");l=p.attr("data-min-booking-length")||0;if(!r||isNaN(parseInt(r))||e){r=0;}this.updateDayName(g,f);this.updateDayName(o,e);if(f&&e){this.updateNumberOfNights(f,e);}if(f){if(e&&h.length!=0){var s=Math.round((e-f)/1000/60/60/24);if(s<1){s=h.get(0).value;}h.get(0).value=s;}var q=Math.max(l,r);f=new Date(f.valueOf()+1000*3600*24*q);var k=this.calendar.toStringFromComp(f.getDate(),f.getMonth()+1,f.getFullYear());if(e&&e<=f){e=null;}if(null==e&&(n.attr("data-optional")!="true"||n.val()!="")){e=this.calendar.getDateFromString(p.val());this.updateNumberOfNights(e,f);if(h.length!=0&&h.get(0).value!=1){f.setDate(f.getDate()+parseInt(h.get(0).value)-1);var k=this.calendar.toStringFromComp(f.getDate(),f.getMonth()+1,f.getFullYear());}if(k!=n.val()){n.val(k);n.blur();}if(exp.core.date.datePicker){exp.core.date.datePicker.entries[n.attr("id")].currentValue=f;}this.updateDayName(o,f);}}if(p.is(".fieldDefaultText")){p.removeClass("fieldDefaultText");}if(n.is(".fieldDefaultText")){n.removeClass("fieldDefaultText");}uitk.updatePlaceholderClass(p);uitk.updatePlaceholderClass(n);}};return c;};exp.core.date.CalendarControl=function(){var a=function(){var p="mmddyy";var g="/";var q=0;var e=["January","February","March","April","May","June","July","August","September","October","November","December"];var f=["JAN","FEV","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"];var c=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];var s=["S","M","T","W","T","F","S"];var l="Close";var k="";var d=["night","nights"];var b=function(t){d=t;};var n=function(t,u){p=t;g=u;};var r=function(u,t,w,v){q=u;e=t;s=w;if(v!=undefined){c=v;}};var o=function(u,t,v){q=u;f=t;s=v;};var h=function(t){l=t;};var m=function(t){k=t;};return{setFormatConfig:n,setUnitConfig:r,setSingleUnitConfig:o,setTextConfig:h,setLocaleConfig:m,setNightTextConfig:b,getDateFormat:function(){return p;},getDateSeparator:function(){return g;},getStartOfWeek:function(){return q;},getMonths:function(){return e;},getSingleMonths:function(){return f;},getDayAbbrs:function(){return s;},getDayNames:function(){return c;},getCloseText:function(){return l;},getLocaleConfig:function(){return k;},getNightTextConfig:function(){return d;}};};return{Config:new a("ddmmyy",".",2)};}();var urlHandler=function(){var p="#inpFlightRouteType",h="inpDepartureLocations0",k="inpArrivalLocations0",v="inpDepartureLocations",z="inpArrivalLocations",A="inpDepartureLocationCodes",u="inpArrivalLocationCodes",c="#inpDepartDate",l="#inpDepartureTimes",o="inpDepartDate",g="inpDepartureTimes",w="#inpReturnDate",q="#inpArrivalTime0",m="#inpAdult",a="#inpSenior",n="#inpChildren1",y="inpChildAgesDetail",s="#radInfantOnLap",r="#radInfantOnSeat",f="#inpRefundableFlightsOnly",e="#inpFlightAirlinePreference",t="#inpFlightClass",b="#inpIsNonstopOnly",d="";var x=[{"id":"1","value":"T00:00"},{"id":"60","value":"T01:00"},{"id":"120","value":"T02:00"},{"id":"180","value":"T03:00"},{"id":"240","value":"T04:00"},{"id":"300","value":"T05:00"},{"id":"360","value":"T06:00"},{"id":"420","value":"T07:00"},{"id":"480","value":"T08:00"},{"id":"540","value":"T09:00"},{"id":"600","value":"T10:00"},{"id":"660","value":"T11:00"},{"id":"720","value":"T12:00"},{"id":"780","value":"T13:00"},{"id":"840","value":"T14:00"},{"id":"900","value":"T15:00"},{"id":"960","value":"T16:00"},{"id":"1020","value":"T17:00"},{"id":"1080","value":"T18:00"},{"id":"1140","value":"T19:00"},{"id":"1200","value":"T20:00"},{"id":"1260","value":"T21:00"},{"id":"1320","value":"T22:00"},{"id":"1380","value":"T23:00"},{"id":"362","value":"TANYT"},{"id":"361","value":"TMORN"},{"id":"721","value":"TNOON"},{"id":"1081","value":"TEVEN"},{"id":"12AM","value":"T00:00"},{"id":"1AM","value":"T01:00"},{"id":"2AM","value":"T02:00"},{"id":"3AM","value":"T03:00"},{"id":"4AM","value":"T04:00"},{"id":"5AM","value":"T05:00"},{"id":"6AM","value":"T06:00"},{"id":"7AM","value":"T07:00"},{"id":"8AM","value":"T08:00"},{"id":"9AM","value":"T09:00"},{"id":"10AM","value":"T10:00"},{"id":"11AM","value":"T11:00"},{"id":"12PM","value":"T12:00"},{"id":"1PM","value":"T13:00"},{"id":"2PM","value":"T14:00"},{"id":"3PM","value":"T15:00"},{"id":"4PM","value":"T16:00"},{"id":"5PM","value":"T17:00"},{"id":"6PM","value":"T18:00"},{"id":"7PM","value":"T19:00"},{"id":"8PM","value":"T20:00"},{"id":"9PM","value":"T21:00"},{"id":"10PM","value":"T22:00"},{"id":"11PM","value":"T23:00"}];
return{setInputFileldNames:function(B){p=B.inpFlightRouteTypeId;h=B.inpFirstDepartureLocationId;k=B.inpFirstArrivalLocationId;v=B.inpDepartureLocationId;z=B.inpArrivalLocationId;A=B.inpDepartureLocationCode;u=B.inpArrivalLocationCode;c=B.inpFirstFlightDepartureDateId;l=B.inpFirstFlightDepartureTimeId;o=B.inpDepartureDateId;g=B.inpDepartureTimeId;w=B.inpReturnDateId;q=B.inpArrivalTimeId;m=B.inpAdultId;a=B.inpSeniorId;n=B.inpChildrenId;y=B.inpAgesId;s=B.radInfantOnLapId;r=B.radInfantOnSeatId;f=B.inpRefoundableId;e=B.inpFlightAirlinePreferenceId;t=B.inpFlightClassId;b=B.inpIsNonstopOnlyId;d=B.inpRouteType;},getTLAIndex:function(F){var E="";if((typeof F)=="undefined"){return 0;}var B=((typeof F)!="undefined")?F.indexOf("("):"";if((F!=="")&&(F.length>3)&&(B>0)){E=F.substr(B+1,3);var C=true;for(var D=0;D<3;D++){if(!((E.charAt(D)>="a"&&E.charAt(D)<="z")||(E.charAt(D)>="A"&&E.charAt(D)<="Z"))){C=false;break;}}if(!C){B=urlHandler.getTLAIndex(F.replace("(","C"));}}return B;},parseAirportCode:function(D,C){var B=this.getTLAIndex(D);if(B>0){D=D.substr(B+1,3);}else{if(C&&C==true){return"";}}return D;},bindFlightRouteType:function(){var B=jQuery(p).attr("value");inputCreator.addNewInput("addedFlightRouteType","inpFlightRouteType",B);},bindLocationsAndDates:function(){var D=0,G,F=0,B=0,C=0,E=this.getValidLocationNumber();jQuery("#"+h+", input[id^='"+v+"']:visible").each(function(){if((D<E)){G="";if(jQuery("input[name^='"+A+"']")[D]!=undefined){G=jQuery("input[name^='"+A+"']")[D].value;inputCreator.addNewInput("addedDepartureLocationCode"+D,"inpDepartureLocationCodes",G);}if(G==undefined||G==""){G=urlHandler.parseAirportCode(jQuery(this).attr("value"),false);}inputCreator.addNewInput("addedDepartureLocation"+D,"inpDepartureLocations",G);}D++;});jQuery("#"+k+", input[id^='"+z+"']:visible").each(function(){if((F<E)){G="";if(jQuery("input[name^='"+u+"']")[F]!=undefined){G=jQuery("input[name^='"+u+"']")[F].value;inputCreator.addNewInput("addedArrivalLocationCode"+F,"inpArrivalLocationCodes",G);}if(G==undefined||G==""){G=urlHandler.parseAirportCode(jQuery(this).attr("value"),false);}inputCreator.addNewInput("addedArrivalLocation"+F,"inpArrivalLocations",G);}F++;});jQuery(c+", input[id^='"+o+"']").each(function(){if(B<E){inputCreator.addNewInput("addedDepartureDate"+B,"inpDepartureDates",jQuery(this).attr("value"));}B++;});jQuery(l+", select[id^='"+g+"']").each(function(){if(C<E){inputCreator.addNewInput("addedDepartureTime"+C,"inpDepartureTimes",jQuery(this).attr("value"));}C++;});if(jQuery(p).attr("value")=="2"||d==="roundtrip"){inputCreator.addNewInput("addedReturnDate","inpArrivalDates",jQuery(w).attr("value"));if(jQuery(q).attr("value")!=undefined){inputCreator.addNewInput("addedArrivalTime","inpArrivalTimes",jQuery(q).attr("value"));}}},bindTravelers:function(D){inputCreator.addNewInput("addedAdultCounts","inpAdultCounts",jQuery(m).attr("value"));inputCreator.addNewInput("addedSeniorCounts","inpSeniorCounts",jQuery(a).attr("value"));inputCreator.addNewInput("adddedChildrenCounts","inpChildCounts",jQuery(n).attr("value"));var B=jQuery(n).attr("value");var C=0;jQuery("select[id^='"+y+"']").each(function(){if(C<B){inputCreator.addNewInput("addedChildAges"+C,"inpChildAges",jQuery(this).attr("value"));}C++;});if(D&&D==true){if(jQuery("[id="+r+"][value=1]").is(":checked")){inputCreator.addNewInput("addedRadInfantOnSeat","inpInfants","1");}else{if(jQuery("[id="+s+"][value=2]").is(":checked")){inputCreator.addNewInput("addedRadInfantOnLap","inpInfants","2");}}}else{if(jQuery(s).is(":checked")){inputCreator.addNewInput("addedRadInfantOnLap","inpInfants","2");}else{if(jQuery(r).is(":checked")){inputCreator.addNewInput("addedRadInfantOnSeat","inpInfants","1");}}}},bindAdditions:function(){inputCreator.addNewInput("addedFlightAirlinePreference","inpFlightAirlinePreference",jQuery(e).attr("value"));inputCreator.addNewInput("addedFlightClass","inpFlightClass",jQuery(t).attr("value"));if(jQuery(b).is(":checked")){inputCreator.addNewInput("addedIsNonstopOnly","inpIsNonstopOnly",jQuery(b).attr("value"));}if(jQuery(f).is(":checked")){inputCreator.addNewInput("addedRefundableFlightsOnly","inpRefundableFlightsOnly",jQuery(f).attr("value"));}if(jQuery("#omnitureReferralId").length>0){var B=jQuery("#omnitureReferralId").attr("value").replace(/\|/g,",");inputCreator.addNewInput("addedOmnitureReferralId","inpOmnitureReferralId",B);}inputCreator.addNewInput("addedAction","action",this.getAction());},getValidLocationNumber:function(){var C,B;C=jQuery("#"+h+", input[id^='"+v+"']:visible");arrLocations=jQuery("#"+k+", input[id^='"+z+"']:visible");var E=C.length;for(var D=E-1;D>=0;D--){if(C[D].value!=""||arrLocations[D].value!=""){return D+1;}}return 0;},getAction:function(){if(jQuery(p).attr("value")==="3"||d==="multi"){jQuery("#flightSearchForm").attr("action","/Flight-SearchResults");return"FlightSearchResults@searchFlights";}else{jQuery("#flightSearchForm").attr("action","/Flight-Search-All");return"FlightSearchAll@searchFlights";}},reduceLocationLength:function(){var M="",J="",P="",Y="",D=new Array(),S=new Array(),W=new Array(),O=new Array();jQuery("#flightSearchForm input").each(function(){M=M+jQuery(this).attr("name")+"="+jQuery(this).attr("value")+"&";});jQuery("#flightSearchForm input[name^='inpDepartureLocations']").each(function(){J=J+jQuery(this).attr("name")+"="+jQuery(this).attr("value")+"&";D.push(jQuery(this).attr("name")+"="+jQuery(this).attr("value")+"&");W.push(jQuery(this).attr("id"));});jQuery("#flightSearchForm input[name^='inpArrivalLocations']").each(function(){P=P+jQuery(this).attr("name")+"="+jQuery(this).attr("value")+"&";S.push(jQuery(this).attr("name")+"="+jQuery(this).attr("value")+"&");O.push(jQuery(this).attr("id"));});var Q=escape(M),X=J+P;if(Q.length>1900){var U=this.getValidLocationNumber();var aa=U*2;var V=(M.length-X.length);var B=(1900-V)/aa;var G=new Array(),R="",C,I;for(i=0;i<U;i++){C=D[i];I=S[i];C=escape(C);I=escape(I);if(C.length>B){G.push(W[i]);}if(I.length>B){G.push(O[i]);}}var K=G.length;var Z=(Q.length-(1900-V))/K;var E,N,H,F,L;for(var T=0;T<=K;T++){E=G[T];L=jQuery("#"+E).attr("value");H=escape(L);H=H.substring(0,(H.length-Z));H=H.substr(0,H.lastIndexOf("%"));L=unescape(H);jQuery("#"+E).attr("value",L);}}},convertTimeStr:function(C){var B="TANYT";jQuery.each(x,function(D,E){if(E["id"]==C){B=E["value"];}});return B;},buildLegInfo:function(D,E,G,B,H,C){var F="from:"+D+",frCode:"+E+",to:"+G+",toCode:"+B+",departure:"+H+this.convertTimeStr(C);return F;},buildPassengerInfo:function(){var B=jQuery(n).attr("value");var D="children:"+B;if(parseInt(B)>0){D=D+"[";for(var E=0;E<parseInt(B);E++){if(E>0){D=D+";";}var C=jQuery("#addedChildAges"+E).attr("value");D=D+C;}D=D+"]";}var F="Y";if((jQuery("#addedRadInfantOnSeat").attr("value")==="1")){F="N";}D=D+",adults:"+jQuery(m).attr("value")+",seniors:"+jQuery(a).attr("value")+",infantinlap:"+F;return D;},buildAdditionInfo:function(){var C="economy";switch(jQuery(t).attr("value")){case"1":C="first";break;case"2":C="business";break;case"5":C="premium";break;case"3":C="economy";break;default:C="economy";break;}var B="cabinclass:"+C;if(jQuery(b).is(":checked")){B=B+",maxhops:0";}var D="N";if(jQuery(f).is(":checked")){var D="Y";}B=B+",nopenalty:"+D+",sortby:price";var E=jQuery(e).attr("value");if(E!=""){B=B+",carrier:"+E;}return B;},getLegs:function(){var B=new Array();var H=this.getValidLocationNumber();var D,G,C,F,I,E=0;for(D=0;D<H;D++){C=jQuery("#addedDepartureLocation"+D).attr("value");F=jQuery("#addedArrivalLocation"+D).attr("value");frAirportCode=jQuery("#addedDepartureLocationCode"+D).attr("value");toAirportCode=jQuery("#addedArrivalLocationCode"+D).attr("value");G=this.buildLegInfo(C,frAirportCode,F,toAirportCode,jQuery("#addedDepartureDate"+D).attr("value"),jQuery("#addedDepartureTime"+D).attr("value"));B.push(G);}if(d==="roundtrip"){G=this.buildLegInfo(F,toAirportCode,C,frAirportCode,jQuery("#addedReturnDate").attr("value"),jQuery("#addedArrivalTime").attr("value"));B.push(G);}return B;},createDeeplinkFormatURL:function(C,B,F,E){jQuery("#flightSearchForm").empty();
inputCreator.addNewInput("routeType","trip",C);for(var G=0;G<B.length;G++){var D=G+1;inputCreator.addNewInput("leg"+D,"leg"+D,B[G]);}inputCreator.addNewInput("passengers","passengers",F);inputCreator.addNewInput("options","options",E);inputCreator.addNewInput("mode","mode","search");},handleFlightSearchForm:function(B){this.deepLink(B);},setInputIds:function(){if(this.isFrontPage()){f="#uw_fc_refund_flights_input";a="#inpSenior1";m="#inpAdult1";}else{f="#inpRefundableFlightsOnly";a="#inpSenior";m="#inpAdult";}},isFrontPage:function(){if(jQuery("#pageId").attr("value")==="page.secondary-flights"){return true;}return false;},deepLink:function(E){this.bindFlightRouteType();this.bindLocationsAndDates();this.bindTravelers(E);this.bindAdditions();this.reduceLocationLength();if(E&&E==true){var B=this.getLegs();var D=this.buildPassengerInfo();var C=this.buildAdditionInfo();this.createDeeplinkFormatURL(d,B,D,C);}},handleFlightSearchFormInternalSearch:function(B){this.setInputIds();this.deepLink(B);}};}();var inputCreator=function(){return{addNewInput:function(b,c,a){var d="#"+b;if(jQuery(d).attr("id")===undefined){jQuery("#flightSearchForm").append('<input type="hidden" id="'+b+'" value="'+a+'" name="'+c+'">');}else{jQuery(d).attr({"value":a,"name":c});}}};}();var tlaSelector=function(){return{getTLA:function(a,c){if(c){var b=c&&c.selectedItem;if(b){return c.selectedItem.tla;}}else{return jQuery("#"+a).attr("value");}},selectedTypeAhead:function(a,c,b){jQuery("#"+c).attr("value",this.getTLA(a,b));}};}();if(!window["g_publishingWizardJSLoaded"]){g_publishingWizardJSLoaded=true;var expNamespace=function(){var c=arguments,a=null,b;for(i=0;i<c.length;i=i+1){b=c[i].split(".");a=window;for(j=0;j<b.length;j=j+1){a[b[j]]=a[b[j]]||{};a=a[b[j]];}}return a;};expNamespace("publishing.util");expNamespace("publishing.wizard");expNamespace("publishing.wizard.lobforms");expNamespace("publishing.wizard.common.flight");publishing.wizard.setUpAddRoomLinks=function(a){var c=(typeof a.field("numRooms")!="undefined")?a.field("numRooms"):a.field("numRoom");function b(){var f=c[0];var e=a.find(".addRoomLink");var d=a.find(".removeRoomLink");if(typeof f!="undefined"){if(f.selectedIndex==f.length-1){e.hide();d.show();}else{if(f.selectedIndex===0){d.hide();e.show();}else{e.show();d.show();}}}}a.find(".addRoomLink").click(function(){var d=c[0];if(typeof d!="undefined"&&d.selectedIndex!=d.length-1){d.selectedIndex++;c.change();b();}});a.find(".removeRoomLink").click(function(){var d=c[0];if(typeof d!="undefined"&&d.selectedIndex!==0){d.selectedIndex--;c.change();b();}});b();$("#widgetcatalogWizard").bind("formSwitched",b);};publishing.wizard.setupPackageRadioButtons=function(a){if(typeof g_selectedPackage!=="undefined"){g_radioButonsSetUp=true;a.find("input:radio[name=packageLob]").click(function(b){a.find("input:radio[value="+g_selectedPackage+"]").attr("checked",true);g_selectedPackage=$(this).val();publishSwitchForm(g_selectedPackage,true);});}};publishing.wizard.disableTabletKeyboard=function(){if(typeof Modernizr!=="undefined"){var b=Modernizr.touch,a=Modernizr.win8touch;if(b||a){$('[data-control="calendar"]').attr("readonly","readonly");}}};publishing.wizard.disableCalendarClickPropagation=function(){if(typeof uitk!=="undefined"){$(".allLobForms").bind(uitk.clickEvent||"click","[data-control=calendar]",function(a){a.stopPropagation();});}};publishing.wizard.setUpPackageCheckboxes=function(a,c,b){if(a){a.click(function(){publishing.wizard.addPackageToHotel(b,a,this);});}if(c){c.click(function(){publishing.wizard.addPackageToFlight(b,c,this);});}if(b){b.click(function(){if($(".current-lob a").attr("data-lob")=="flightOnly"){publishing.wizard.addPackageToFlight(b,c,this);}else{if($(".current-lob a").attr("data-lob")=="hotelOnly"){publishing.wizard.addPackageToHotel(b,a,this);}}});}};publishing.wizard.addPackageToHotel=function(c,a,b){if(c&&c.is(":checked")&&a&&a.is(":checked")){publishSwitchForm("flightHotelAndCar",true);b.checked=!b.checked;}else{if(a&&a.is(":checked")){publishSwitchForm("flightAndHotel",true);b.checked=!b.checked;}else{if(c&&c.is(":checked")){publishSwitchForm("hotelAndCar",true);b.checked=!b.checked;}else{publishSwitchForm("hotelOnly",true);b.checked=!b.checked;}}}};publishing.wizard.addPackageToFlight=function(b,c,a){if(b&&b.is(":checked")&&c&&c.is(":checked")){publishSwitchForm("flightHotelAndCar",true);a.checked=!a.checked;}else{if(c&&c.is(":checked")){publishSwitchForm("flightAndHotel",true);a.checked=!a.checked;}else{if(b&&b.is(":checked")){publishSwitchForm("flightAndCar",true);a.checked=!a.checked;}else{publishSwitchForm("flightOnly",true);a.checked=!a.checked;}}}};publishing.wizard.formatDateForGroupForm9PlusRoomsService=function(b){var a=publishing.util.parseDate(b);if(a===null){return"";}return publishing.util.formattedDate("MM/DD/YYYY",0,a);};publishing.wizard.currentlySelectedField=null;publishing.wizard.SelectAll=function(a){if(publishing.wizard.currentlySelectedField!=a){document.getElementById(a).focus();document.getElementById(a).select();publishing.wizard.currentlySelectedField=a;$("#"+a).blur(function(){if(publishing.wizard.currentlySelectedField==a){publishing.wizard.currentlySelectedField=null;}});}};publishing.wizard.packageLobData={};publishing.wizard.addPackageLobFields=function(f,e){var b=e.field("destination").val();var a=publishing.wizard.LSDATA;var c=publishing.wizard.packageLobData;if(a&&(a.destination==b||a.regionName==b)){if(!c.MultiCity){c.MultiCity=a.regionID;}if(!c.TLA){var d=a.destination.match(/\(([A-Z][A-Z][A-Z])\s?\-?/);if(d&&d.length>1){c.TLA=d[1];}}}if(!$("input[name='DestID']").length&&(f=="flightAndHotel"||f=="hotelAndCar"||f=="flightHotelAndCar")&&c.TLA&&c.MultiCity){e.append($('<input type="hidden" />').attr("name","DestID").attr("value",c.MultiCity+":"+c.TLA));}if(!$("input[name='HotelIDs']").length&&(f=="hotelOnly"||f=="flightAndHotel"||f=="hotelAndCar"||f=="flightHotelAndCar")&&c.HotelId){e.append($('<input type="hidden" />').attr("name","HotelIDs").attr("value",c.HotelId));}if(!$("input[name='CityId']").length&&(f=="hotelOnly"||f=="flightAndHotel")&&c.regionId){e.append($('<input type="hidden" />').attr("name","CityId").attr("value",c.regionId));}};publishing.wizard.turnOnInterstitial=function(b,a){b.width(b.outerWidth());b.parent().parent().addClass("interstitial");b.html(a.searchingText+'<img src="/static/fusion/v2.3/images/ajax-loader.gif" style="vertical-align:-4px;margin-left:6px;" height="16" width="16">');b.attr("disabled","disabled");};publishing.wizard.turnOffInterstitial=function(b,a){b.width("auto");b.parent().parent().removeClass("interstitial");b.html(a.normalButtonText);b.removeAttr("disabled");};publishing.WIZARD_CONTAINER_ID="#widgetcatalogWizard";publishing.DATE_SEPERATOR_REGEX=/[\- \/.]/;publishing.UNDEFINED_CHILD_AGE="-1";publishing.wizard.canonicFields={};publishing.wizard.canonicFieldValues={};publishing.wizard.setSearchButtonToInterstitial=function(d,c){var b=$(d.target).find("button");var e=$(d.target).find(".xp-b-leftSubmit2");var a=$(d.target).find(".xp-b-rightSubmit2");b.css("background-position","left -145px");e.css("background-position","left -87px");a.css("background-position","left -116px");b.html('<span style="color:#4c3900">'+c.searchingText+'<img src="/static/fusion/v2.3/images/ajax-loader.gif" style="vertical-align:-4px;margin-left:6px;" height="16" width="16"></span>');};publishing.wizard.hasBrowserVersionBeenChecked=false;publishing.wizard.isChrome23OrAbove=false;publishing.wizard.checkForChrome23OrAbove=function(){if(!this.hasBrowserVersionBeenChecked){publishing.wizard.isChrome23OrAbove=false;publishing.wizard.hasBrowserVersionBeenChecked=true;if(/Chrom(e|ium|eframe)\/([0-9]+)\./i.test(navigator.userAgent)){var a=new Number(RegExp.$2);if(a>=23){publishing.wizard.isChrome23OrAbove=true;}}}return publishing.wizard.isChrome23OrAbove;};publishing.wizard.handleMouseDown=function(h){if(typeof(PopUnder)!="undefined"){var g=$(h).attr("class");var d=g_calendar.getDateFromString($(h).find('[name="InDate"]').val());
var a=g_calendar.getDateFromString($(h).find('[name="OutDate"]').val());var b="";var e="";if((typeof(d)!="undefined")&&(typeof(a)!="undefined")&&null!=d&&null!=a){var f=d.getMonth();b=d.getFullYear()+((f<9)?("-0"+(f+1)):("-"+(f+1)));var m=d.getDate();b+=(m<10)?("-0"+m):("-"+m);var k=a.getMonth();e=a.getFullYear()+((k<9)?("-0"+(k+1)):("-"+(k+1)));var c=a.getDate();e+=(c<10)?("-0"+c):("-"+c);}var l="";if(typeof($(h).find('[name="CityId"]'))!="undefined"){l=$(h).find('[name="CityId"]').val();}PopUnder.handleMouseDownForChrome23(g,this.siteId,l,$(h).find('[name="PlaceName"]').val(),b,e);}};publishing.wizard.initPopUnderIfLoaded=function(b){if(typeof(PopUnder)!="undefined"){var g=$(b.target).attr("class");var c=g_calendar.getDateFromString(b.target.InDate.value);var f=g_calendar.getDateFromString(b.target.OutDate.value);var e="";var d="";if((typeof(c)!="undefined")&&(typeof(f)!="undefined")&&null!=c&&null!=f){if(c.getMonth()<9){e=c.getFullYear()+"-0"+(c.getMonth()+1);}else{e=c.getFullYear()+"-"+(c.getMonth()+1);}if(c.getDate()<10){e=e+"-0"+c.getDate();}else{e=e+"-"+c.getDate();}if(f.getMonth()<9){d=f.getFullYear()+"-0"+(f.getMonth()+1);}else{d=f.getFullYear()+"-"+(f.getMonth()+1);}if(f.getDate()<10){d=d+"-0"+f.getDate();}else{d=d+"-"+f.getDate();}}var a="";if(typeof(b.target.CityId)!="undefined"){a=b.target.CityId.value;}PopUnder.initialize(g,this.siteId,a,b.target.PlaceName.value,e,d);}};publishing.wizard.ON_FORM_SUBMIT=function(E,x){if($(E.target).attr("class")=="hotelOnly"){try{publishing.wizard.initPopUnderIfLoaded(E);}catch(J){}if(publishing.wizard.lobforms.hotelOnly.handleNinePlusRooms(E.target,x)){return false;}if(publishing.wizard.lobforms.hotelOnly.gotoHotelInfo(E.target,x)){return false;}}if($(E.target).attr("class")=="flightAndHotel"){if(publishing.wizard.lobforms.hotelOnly.gotoPackageInfo(E.target,x)){return false;}}if($(E.target).attr("class")=="carOnly"){var A=TA?TA.getInstance("C-destination"):null;var o=A&&A.On;var B=A&&A.selectedItem;if(o&&B){if(A.selectedItem.type=="AIRPORT"){$("#C-destination").val(A.selectedItem.tla);var H=TA?TA.getInstance("C-dropOffLocation"):null;var G=H&&H.On;var a=H&&H.selectedItem;if($("#showHideDropOff")!=null&&$("#showHideDropOff").is(":checkbox")&&!$("#showHideDropOff").is(":checked")){$("#C-dropOffLocation").val("");}else{if(G&&a&&H.selectedItem.type=="AIRPORT"){$("#C-dropOffLocation").val(H.selectedItem.tla);}}}else{$("#C-SearchType").val("PLACE");}}else{$("#C-SearchType").replaceWith('<input type="hidden" name="searchType" value="DTI">');}}if(x.interstitial){publishing.wizard.setSearchButtonToInterstitial(E,x);}if(publishing.wizard.lobforms.flightOnly.submitFormTarget&&$(publishing.wizard.lobforms.flightOnly.submitFormTarget).attr("submittype")=="flightAndHotel"){publishing.wizard.lobforms.flightOnly.submitFormTarget=null;function C(){$(publishing.WIZARD_CONTAINER_ID+" form.flightAndHotel").find("input[type='submit']").each(function(){$(this).val($(this).val().toUpperCase());});h.clearErrors();n();}function n(){publishing.wizard.lobforms.flightOnly.searchFlightAndHotel();$form=$(publishing.WIZARD_CONTAINER_ID+" form.flightAndHotel");$form.find(".ignore-hidden-fields").removeClass("ignore-hidden-fields");$form.find("button:submit").trigger("click");}var D=$(publishing.WIZARD_CONTAINER_ID).find(".allLobForms");if(D.find("div.lobForm-flightAndHotel").length==0){var h=$('<div class="lobForm lobForm-flightAndHotel"/>').hide().appendTo(D);var m=window["g_wizDesign"]?"/"+g_wizDesign:"";h.load("/publishing/wizard-lob-form/flightAndHotel"+m,C);}else{n();}return false;}if(publishing.wizard.lobforms.flightOnly.submitFormTarget&&$(publishing.wizard.lobforms.flightOnly.submitFormTarget).attr("submittype")=="flightOnly"){var y=$(E.target).find("[name=TripType][value=Multicity]");var K=$(E.target).find("[name=TripType][value=RoundTrip]");var l=$(E.target).find("[name=TripType][value=OneWay]");if((K!=null&&K.is(":checked"))||(l!=null&&l.is(":checked"))){var I=$(E.target).find(".oneWayOrReturn").find("[name=stopOverCheck]");if(I.length>0&&I.is(":checked")){publishing.wizard.lobforms.flightOnly.stopOverSearch(E.target);return true;}var p=$("form[name=flightSearch]");if(p!=null){var q=[{"id":"12AM","value":"T00:00"},{"id":"1AM","value":"T01:00"},{"id":"2AM","value":"T02:00"},{"id":"3AM","value":"T03:00"},{"id":"4AM","value":"T04:00"},{"id":"5AM","value":"T05:00"},{"id":"6AM","value":"T06:00"},{"id":"7AM","value":"T07:00"},{"id":"8AM","value":"T08:00"},{"id":"9AM","value":"T09:00"},{"id":"10AM","value":"T10:00"},{"id":"11AM","value":"T11:00"},{"id":"12PM","value":"T12:00"},{"id":"1PM","value":"T13:00"},{"id":"2PM","value":"T14:00"},{"id":"3PM","value":"T15:00"},{"id":"4PM","value":"T16:00"},{"id":"5PM","value":"T17:00"},{"id":"6PM","value":"T18:00"},{"id":"7PM","value":"T19:00"},{"id":"8PM","value":"T20:00"},{"id":"9PM","value":"T21:00"},{"id":"10PM","value":"T22:00"},{"id":"11PM","value":"T23:00"},{"id":"362","value":"TANYT"},{"id":"361","value":"TMORN"},{"id":"721","value":"TNOON"},{"id":"1081","value":"TEVEN"}];function F(N){var e="TANYT";$.each(q,function(O,P){if(P["id"]==N){e=P["value"];}});return e;}function r(N,P,Q,e){var O="from:"+N+",to:"+P+",departure:"+Q+F(e);return O;}var k=$(E.target).find("input[name=FrAirport]").attr("value");var L=$(E.target).find("input[name=ToAirport]").attr("value");if(k==undefined){k=$(E.target).find("select[name=FrAirport]").attr("value");}if(L==undefined){L=$(E.target).find("select[name=ToAirport]").attr("value");}var w=r(k,L,$(E.target).find("input[name=FromDate]").attr("value"),$(E.target).find("select[name=FromTime]").attr("value"));var d=$(E.target).find("select[name=NumChild]").eq(0).attr("value");var c="children:"+d;if(parseInt(d)>0){c=c+"[";for(i=1;i<=parseInt(d);i++){if(i>1){c=c+";";}var f=$(E.target).find("select[name=Age"+i+"]").attr("value");c=c+f;}c=c+"]";}var M="Y";var t=$(E.target).find("[name=InfantInSeat][value=1]");if(t!=null&&t.is(":checked")){M="N";}var g=($(E.target).find("select[name=NumSenior]").length>0)?$(E.target).find("select[name=NumSenior]").attr("value"):0;c=c+",adults:"+$(E.target).find("select[name=NumAdult]").attr("value")+",seniors:"+g+",infantinlap:"+M;var z="economy";switch($(E.target).find("select[name=Class]").attr("value")){case"1":z="first";break;case"2":z="business";break;case"5":z="premium";break;case"3":z="economy";break;default:z="economy";break;}var u="cabinclass:"+z;if($(E.target).find("input[name=Direct]").is(":checked")){u=u+",maxhops:0";}var b="N";if($(E.target).find("input[name=NoChangePen]").is(":checked")){var b="Y";}u=u+",nopenalty:"+b+",sortby:price";var s=$(E.target).find("select[name=Airline]").attr("value");if(s!=""&&typeof(s)!="undefined"){u=u+",carrier:"+s;}if(K!=null&&K.is(":checked")){var v=r(L,k,$(E.target).find("input[name=ToDate]").attr("value"),$(E.target).find("select[name=ToTime]").attr("value"));$("<input />").attr({"type":"hidden","name":"trip","value":"roundtrip"}).appendTo(p);$("<input />").attr({"type":"hidden","name":"leg1","value":w}).appendTo(p);$("<input />").attr({"type":"hidden","name":"leg2","value":v}).appendTo(p);}else{$("<input />").attr({"type":"hidden","name":"trip","value":"oneway"}).appendTo(p);$("<input />").attr({"type":"hidden","name":"leg1","value":w}).appendTo(p);}$("<input />").attr({"type":"hidden","name":"passengers","value":c}).appendTo(p);$("<input />").attr({"type":"hidden","name":"options","value":u}).appendTo(p);$("<input />").attr({"type":"hidden","name":"mode","value":"search"}).appendTo(p);p.submit();return false;}}else{if(y!=null&&y.is(":checked")&&jQuery("#flightSearchForm").length>0){urlHandler.setInputFileldNames({inpFlightRouteTypeId:"",inpFirstDepartureLocationId:"F-origin-1",inpFirstArrivalLocationId:"F-destination-1",inpDepartureLocationId:"F-fromAirport",inpArrivalLocationId:"F-toAirport",inpDepartureLocationCode:"hiddenDepartureLocationCodes",inpArrivalLocationCode:"hiddenArrivalLocationCodes",inpFirstFlightDepartureDateId:"#F-fromDate",inpFirstFlightDepartureTimeId:"#F-FromTime",inpDepartureDateId:"F-date",inpDepartureTimeId:"F-Time",inpAdultId:"#F-NumAdult",inpSeniorId:"#F-NumSenior",inpChildrenId:"#F-NumChild",inpAgesId:"F-Age",radInfantOnLapId:"infantSeatPreference",radInfantOnSeatId:"infantSeatPreference",inpRefoundableId:"#refundableFlightsOnly",inpFlightAirlinePreferenceId:"#F-Airline",inpFlightClassId:"#F-Class",inpIsNonstopOnlyId:"#directFlightsOnly",inpRouteType:"multi"});
urlHandler.handleFlightSearchForm(true);jQuery("#flightSearchForm").submit();return false;}}}if(publishing.wizard.lobforms.carOnly){$form=$(publishing.WIZARD_CONTAINER_ID+" form.carOnly");if($form.find("#street").css("display")=="none"){$form.find("#street").empty();$form.find("#city").empty();$form.find("#state").empty();$form.find("#zip").empty();}if($form.find("#disCorpCode").css("display")=="none"||$form.find("#disCorpCode").find("input[name=CorpDiscNum]").val()==""){$form.find("#disCorpCode").find("input[name=CorpDiscNum]").attr("disabled","disabled");}if($form.find("#disRateCode").css("display")=="none"||$form.find("#disRateCode").find("input[name=RateCode]").val()==""){$form.find("#disRateCode").find("input[name=RateCode]").attr("disabled","disabled");}if($form.find("#disCouponCode").css("display")=="none"||$form.find("#disCouponCode").find("input[name=CouponCode]").val()==""){$form.find("#disCouponCode").find("input[name=CouponCode]").attr("disabled","disabled");}if($form.find("#disOtherCode").css("display")=="none"||$form.find("#disOtherCode").find("input[name=OtherCode]").val()==""){$form.find("#disOtherCode").find("input[name=OtherCode]").attr("disabled","disabled");}}return true;};publishing.util.Date=function(b,f){var g=(1000*60*60*24);var c=new Date(b.valueOf()+(g*f));function a(){return c.getMonth()+1<10?"0"+(c.getMonth()+1):c.getMonth()+1;}function e(){return c.getDate()<10?"0"+c.getDate():c.getDate();}function d(){return c.getFullYear();}this.format=function(k){var h=k.toUpperCase().replace("MM",a());h=h.replace("DD",e());h=h.replace("YYYY",d());h=h.replace("YY",(d()%2000));return h;};};publishing.util.formattedDate=function(c,d,a){var b=new publishing.util.Date(a||new Date(),d);return b.format(c);};publishing.util.parseDate=function(d){var b={"mmddyy":{day:1,month:0,year:2},"ddmmyy":{day:0,month:1,year:2},"yymmdd":{day:2,month:1,year:0},"ddmmyyyy":{day:0,month:1,year:2}};function e(g){var h=g.split(publishing.DATE_SEPERATOR_REGEX);var k=b[publishing.NORMALIZED_DATE_FORMAT];if(k==undefined){return[];}var f={day:parseInt(h[k["day"]],10),month:parseInt(h[k["month"]],10),year:parseInt(h[k["year"]],10)};if(f.year<100){f.year=2000+f.year;}return f;}var a=e(d);var c=new Date(a.year,a.month-1,a.day);if(isNaN(c.getTime())){return null;}return c;};publishing.util.calendarDateFormat=function(c,a){var b={"mmddyy":"mm"+a+"dd"+a+"yy","ddmmyy":"dd"+a+"mm"+a+"yy","yymmdd":"yy"+a+"mm"+a+"dd","ddmmyyyy":"dd"+a+"mm"+a+"yyyy"};return b[c];};publishing.util.preserveValues=function(a,b){a.each(function(){var e=$(this);var d=publishing.wizard.canonicName(e);var c=publishing.wizard.canonicFieldValues[d];if(c==undefined){if(d=="destination"&&(b=="hotelOnly"||b=="flightAndHotel"||b=="flightHotelAndCar"||b=="hotelAndCar"||b=="activities")){d="regionName";}if(publishing.wizard.LSDATA&&publishing.wizard.LSDATA[d]){c=publishing.wizard.LSDATA[d];}}if(c!=undefined&&c!=""){if(e.attr("type")=="radio"&&d=="infantSeatPreference"){if(c==e.val()){e[0].checked=true;}else{e[0].checked=false;}}else{if(c!=e.val()){if(d=="regionName"||d=="destination"){e.val(c);}else{if(e.is("select")){e.children().each(function(f,g){if($(g).attr("value")==c){e.val(c).change();}});}else{e.val(c).change();}if(e.is("[data-type=date]")&&e.val()!=exp.core.date.CalendarControl.config.getDateFormat()){e.blur();}}}}}if(e[0].checkState){e[0].checkState();}});};var calConfig,DPDisplay,g_calendar,g_datepicker,g_dateUpdater;publishing.wizard.calInit=function(){if(exp.core.date.DatePickerDisplay){var c=ol=0;if(window.g_wizDesign!==undefined&&g_wizDesign=="tabbed"){ol=0;c=2;}var b="/static/default/default/html/calendar/v3.0.0/calendar.html";if((typeof publishWizardCalendarUrl!=="undefined")&&publishWizardCalendarUrl.length>0){b=publishWizardCalendarUrl;}calConfig=exp.core.date.CalendarControl.config=exp.core.date.CalendarControl.Config;DPDisplay=exp.core.date.datePickerDisplay=exp.core.date.DatePickerDisplay("CalFrame",b,ol,c);exp.core.date.CalendarControl.config.setFormatConfig(publishing.NORMALIZED_DATE_FORMAT,publishing.DATE_SEPERATOR);exp.core.date.CalendarControl.config.setUnitConfig(publishing.START_DAY_OF_WEEK,publishing.MONTHS,publishing.DAYS);exp.core.date.CalendarControl.config.setTextConfig(publishing.CLOSE_LINK);g_calendar=exp.core.date.calendar=exp.core.date.Calendar(exp.core.date.CalendarControl.config);g_datepicker=exp.core.date.datePicker=exp.core.date.DatePickerControl(exp.core.date.calendar,DPDisplay,2);g_dateUpdater=exp.core.date.dateUpdater=exp.core.date.DateUpdater(exp.core.date.calendar,exp.core.date.CalendarControl.config);function a(){return g_datepicker;}}};var publishSwitchForm;publishing.wizard.init=function(){publishing.wizard.calInit();function h(m){var n=$(m.target);if($("#widgetcatalogWizard").is(".horizontal-wizard")){$(".current-lob").removeClass("current-lob");n.parent().parent().addClass("current-lob");}switchForm(n.val(),true);f(n);}function d(p){var n=$(p.target);var m=$(".on.change-lob");if(n[0].nodeName!=="A"){n=n.parents(".change-lob");}var q=n.attr("data-lob");var o=m.attr("data-lob");$("#widgetcatalogWizard").removeClass("currLob-"+o);$("#widgetcatalogWizard").addClass("currLob-"+q);m.removeClass("on");n.addClass("on");switchForm(q,true);}publishSwitchForm=switchForm=function(r,q){var n=g.find("div.lobForm:visible");if(n.hasClass("lobForm-"+r)){return;}var u=g.find("div.lobForm-"+r);if(publishing.wizard.AJAX_LOB_FORMS&&u.length===0){c(r);return;}n.hide();u.show();var p="",o=u.find("input[name='rfrr']"),t=u.find("form."+r);if(typeof o=="object"&&o.length==0){p=n.find("input[name='rfrr']").clone();if(typeof t=="object"&&t.length>0&&typeof p=="object"&&p.length>0){p.appendTo(t);}}if(typeof uitk!=="undefined"){try{uitk.refreshPlaceholders();}catch(s){}}if(q){var m=publishing.wizard.canonicFields[u.find("form").attr("class")];publishing.util.preserveValues(m,r);}u.clearErrors();$("#widgetcatalogWizard").trigger("formSwitched");publishing.wizard.disableTabletKeyboard();publishing.wizard.disableCalendarClickPropagation();};function f(p){var o=p.attr("data-title");var n=p.attr("wizard-title");var m=l.attr("data-template");if(m!=undefined){if(n!=""){l.html(n);}else{l.html(m.replace("{lob}",$.trim(o)));}}}if(window["uitk"]&&uitk.subscribe){uitk.subscribe("calendar.selectDate",function(n,p){var q=p.element,m=p.date;var o=publishing.wizard.canonicName(q);publishing.wizard.canonicFieldValues[o]=q.val();setTimeout(function(){if(o=="fromDate"){publishing.wizard.canonicFieldValues["toDate"]=$("[data-canonic=toDate]:visible").val();}else{if(o=="toDate"){publishing.wizard.canonicFieldValues["fromDate"]=$("[data-canonic=fromDate]:visible").val();}}},1);});}function k(n){var m=n.find("[data-canonic]");m.change(function(){var p=$(this);var o=publishing.wizard.canonicName(p);publishing.wizard.canonicFieldValues[o]=p.val();if(this.id=="H-destination"&&$("#H-hotelId").val()!=""&&$("#H-hotelId").attr("timestamp")+1<=new Date().getTime()){$("#H-hotelId").val("");}});publishing.wizard.canonicFields[n.attr("class")]=m;}function e(){var m=$('<select name="CityId" data-canonic="destination">');$.each(publishing.wizard.hotelsForCities,function(n,o){options=$('<option value="'+o.cityId+'">'+o.cityName+"</option>");options.appendTo(m);});b.field("destination").each(function(o,n){my_select=m.clone();my_select.attr("class",$(n).attr("class"));$(n).replaceWith(my_select);});}function a(){var m=b.find("input[name=lob]:checked");if(m.length>0){f(m);switchForm(m.val(),false);}}function c(s){function u(){k(r.find("form"));t();switchForm(s,true);}function t(){r.find("input[type='submit']").each(function(){$(this).val($(this).val().toUpperCase());});}var r=$('<div class="lobForm lobForm-'+s+'"/>').hide().appendTo(g);var m=window["g_wizDesign"]?"/"+g_wizDesign:"";var n="";var o="";if(window["g_wizDesign"]){n=s=="hotelOnly"?"/0":"/1";o=s=="hotelOnly"?"/2":"/1";}var q="";if(window["g_packageTreatment"]){q="/"+g_packageTreatment;}var p="";if(window["g_isDomesticHotel"]){p="domestic";}r.load("/publishing/wizard-lob-form/"+p+s+m+n+o+q,u);
}var b=$(publishing.WIZARD_CONTAINER_ID);var l=b.find(".title h3");var g=b.find(".allLobForms");b.find("input[name=lob]").change(h);if(window.g_wizDesign!==undefined&&g_wizDesign=="responsive"){b.find(".change-lob").click(d);}publishing.wizard.BIASED_FOR_HOTELS_PER_CITY=!$.isEmptyObject(publishing.wizard.hotelsForCities);if(publishing.wizard.BIASED_FOR_HOTELS_PER_CITY){e(b);}a();b.find("form").each(function(){k($(this));});};publishing.wizard.numberOfRoomsListener=function(d,e,c){function a(f){var g=b(f);if(g.length!==0&&g.is(":hidden")){g.find(".error").removeClass("error");g.css("visibility","visible");g.show();}}function b(f){return $(d[f-1]);}return function(){var m=$(this).val();var g=9;if(m<g){var k=$("#H-searchButton");k.text(c.normalButtonText);$("#H-NumAdult1-label").show();$("#H-NumChild1-label").show();$("#hotelOnly-1-children-ages").show();for(var h=2;h<=e;h++){if(h<=m){a(h);}else{b(h).hide();}}}else{var k=$("#H-searchButton");if("small"==publishing.wizard.SIZE||"medium"==publishing.wizard.SIZE){k.text(c.normalButtonText);}else{k.text(c.ninePlusRoomsButtonText);}$("#H-NumAdult1-label").hide();$("#H-NumChild1-label").hide();$("#hotelOnly-1-children-ages").hide();for(var h=2;h<g;h++){b(h).hide();}a(g);}var l=$(this.form);var n=l.find("[data-canonic=childrenAge]:visible");var f=l.find(".section-infants-pref");publishing.wizard.common.flight.accompaniedInfantListener(n,f)();};};publishing.wizard.numberOfChildrenListener=function(a,b){return function(d,g){if(g===undefined){g=false;}var h=$(this);h.parents(".section-flight-age-group").find(".section-children-ages").toggle((h.val()>0));h.parents(".section-age-group").children(".section-children-ages").toggle((h.val()>0));h.parents(".room").children(".section-children-ages").toggle((h.val()>0));for(var e=1;e<=a;e++){var c=e<=$(this).val();var f=$(b[e-1]);f.closest("fieldset").toggle(c);f.closest("fieldset").toggleClass("hidden",!c);if(!c&&!g){f.val(publishing.UNDEFINED_CHILD_AGE);}}};};publishing.wizard.initRoom=function(e,b,g){var c=e.field("numChildren");var f=e.find(".number-of-travellers");var d=e.field("childrenAge");var a=c.find("option:last").val();c.bindAndTrigger(publishing.wizard.numberOfChildrenListener(a,d));if(g.totalNumberOfTravellersPerRoom!==undefined){b.push(new publishing.validation.TotalBetween(1,-1,f,g.totalNumberOfTravellersPerRoom));}d.each(function(){b.push(new publishing.validation.ValueNot(publishing.UNDEFINED_CHILD_AGE,$(this),g.childrenAge));});};publishing.wizard.initRooms=function(c,g,h,e,a){var f=c.field("numRooms");var b=f.find("option:last").val();f.bindAndTrigger(publishing.wizard.numberOfRoomsListener(g,b,a));g.each(function(n,o){publishing.wizard.initRoom($(o),h,e);});var d=c.find(".number-of-travellers");var k=c.find("[data-canonic='numAdults']");var m=c.find("[data-canonic='numSeniors']");var l=c.find("[data-canonic='numChildren']");h.push(new publishing.validation.ChildrenMustNotBeAlone(k,m,l,e.childrenMustNotBeAlone));if(a.hideShowRooms){a.hideShowRooms();}};publishing.wizard.common.flight.accompaniedInfantListener=function(c,a){function b(d){return $(d).is(":visible")&&($(d).val()=="0"||$(d).val()=="1");}return function(){a.toggle($.grep(c,b).length>0);};};publishing.wizard.lobforms.additionalOptions=function(a){var e=a.showAdditionalOptionsField;var d=a.additionalOptionsContainer;var f=a.hideAdditionalOptionsField;var c=a.infoLinkField;var g=a.infoContainer;e.click(b);f.click(b);if(c!==undefined){c.click(function(){$(g).toggle();});}function b(){var h=$(e).attr("name");e.parent().toggle(this.name!=h);e.parent().toggleClass("hidden",this.name==h);f.parent().toggle(this.name==h);f.parent().toggleClass("hidden",this.name!=h);d.toggle(this.name==h);}};publishing.wizard.canonicName=function(a){var c=a.attr("data-canonic");var b=a[0].name;if("childrenAge"==c){b=b.replace("Rm","").replace("Child","").replace("Age","");if(b.length==1){b="1"+b;}b="ChildAge"+b;c=b;}else{if("numAdults"==c){c=b;if("NumAdult"==c){c="NumAdult1";}}else{if("numSeniors"==c){c=b;if("NumSenior"==c){c="NumSenior1";}}else{if("numChildren"==c){c=b;if("NumChild"==c){c="NumChild1";}}}}}return c;};$(publishing.wizard.init);expNamespace("publishing.validation");publishing.validation.Validator=function(a,b){this.validate=function(){b.clearAll();var c=true;$.each(a,function(){var d=this.apply();if(!d.isValid){b.render(d.error);c=false;}});return c;};};publishing.validation.Error=function(a,b){this.fields=a;this.message=b;};publishing.validation.Result=function(b,a){this.isValid=b;this.error=a;};publishing.validation.ErrorRenderer=function(b,c){function a(d){return c.find(":contains("+d.message+")").length>0;}this.render=function(d){$(".ie7").children(".error").css("height","auto").css("margin-top","10px");if(!a(d)){c.append('<li><span class="icon"/>'+d.message+"</li>");}$.each(d.fields,function(){if(window.g_wizDesign!==undefined&&g_wizDesign=="responsive"){$(this).parent().addClass("invalid");b.find(".validation-msg").removeClass("hidden").addClass("error");}$(this).addClass("error");});};this.clearAll=function(){$(".ie7").children(".error").css("height","0px").css("margin-top","0px");c.empty();b.find(".error").removeClass("error");if(window.g_wizDesign!==undefined&&g_wizDesign=="responsive"){b.find(".invalid").removeClass("invalid");b.find(".validation-msg").addClass("hidden");}};};publishing.validation.Rule=function(c,a,b){if(a.jquery===undefined&&!$.isArray(a)){a=[a];}function d(){var e=false;$.each(a,function(){e=e||$(this).is(":hidden");});return e;}this.apply=function(){if(a.length==0||d()||c()){return new publishing.validation.Result(true);}else{var e=new publishing.validation.Error(a,b);return new publishing.validation.Result(false,e);}};};publishing.validation.NotEmpty=function(c,a){function b(){return !c.blank();}return new publishing.validation.Rule(b,c,a);};publishing.validation.IsEmailAddress=function(c,a){function b(){var d=new RegExp(/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/);return d.test(c.val());}return new publishing.validation.Rule(b,c,a);};publishing.validation.IsAlphabetOnly=function(c,a){function b(){var d=new RegExp(/^[A-Za-z]+$/);return d.test(c.val());}return new publishing.validation.Rule(b,c,a);};publishing.validation.NotSelect=function(c,a){function b(){return(c.val()!="Default");}return new publishing.validation.Rule(b,c,a);};publishing.validation.NotSelectCity=function(c,d,a){function b(){return !(c.val()!="Other"&&d.val()=="Default");}return new publishing.validation.Rule(b,d,a);};publishing.validation.CityBetween=function(a,d,b){function c(){if(a.blank()&&d.blank()){return true;}else{var e=a.val();var f=d.val();return e!=f;}}return new publishing.validation.Rule(c,[a,d],b);};publishing.validation.OptionalDate=function(f,c){function d(){return $.trim(f.val());}function b(){return !f.blank()&&(a!=d());}function e(){return d()==publishing.DATE_FORMAT||!b()||publishing.util.parseDate(f.val())!=null;}var a=d();return new publishing.validation.Rule(e,f,c);};publishing.validation.MandatoryDate=function(d,b){function a(){return d.val()!=""&&d.val()!=publishing.DATE_FORMAT;}function c(){return publishing.util.parseDate(d.val())!=null;}function e(){var f=false;$.each(d,function(){f=f||$(this).is(":hidden");});return f;}this.apply=function(){if(e()){return new publishing.validation.Result(true);}else{if(!a()){return new publishing.validation.Result(false,new publishing.validation.Error(d,b.mandatory));}else{if(!c()){return new publishing.validation.Result(false,new publishing.validation.Error(d,b.dateFormat));}else{return new publishing.validation.Result(true);}}}};return this;};publishing.validation.ConditionalDate=function(b,e,h,d){function f(){return $.trim(h.val());}function c(){return b==false&&!e.attr("checked");}function a(){return !h.blank()&&f()!=publishing.DATE_FORMAT;}function g(){if(!c()){return h.blank()||f()==publishing.DATE_FORMAT||publishing.util.parseDate(f())!=null;}else{return publishing.util.parseDate(f())!=null;}}this.apply=function(){if(c()&&!a()){return new publishing.validation.Result(false,new publishing.validation.Error(h,d.mandatory));
}else{if(!g()){return new publishing.validation.Result(false,new publishing.validation.Error(h,d.dateFormat));}else{return new publishing.validation.Result(true);}}};return this;};publishing.validation.DateRange=function(e,b,c,a){if(a===undefined){a=false;}function d(){var f=publishing.util.parseDate(e.val());var g=publishing.util.parseDate(b.val());return f==null||g==null||(a?(f<=g):(f<g));}return new publishing.validation.Rule(d,[e,b],c);};publishing.validation.DateBetween=function(d,a,e,b){function c(){var h=publishing.util.parseDate(a.val());var f=publishing.util.parseDate(e.val());var g=publishing.util.parseDate(d.val());return h==null||f==null||g==null||(g>=h&&g<=f);}return new publishing.validation.Rule(c,d,b);};publishing.validation.DatePastMaxPurchaseDate=function(b,a,c){function d(){var f=publishing.util.parseDate(a.val());var e=publishing.util.parseDate(b);return f==null||e==null||(e>f);}return new publishing.validation.Rule(d,[a],c);};publishing.validation.DateIsLessOrEqual=function(a,b,c){function d(){var f=publishing.util.parseDate(b.val());var e=publishing.util.parseDate(a);return f==null||e==null||(e>=f);}return new publishing.validation.Rule(d,[b],c);};publishing.validation.DatesNotToManyDaysAppart=function(a,d,e,b){function c(){if(!e||!b){return true;}var k=publishing.util.parseDate(a.val());var h=publishing.util.parseDate(d.val());var f=0;if(k&&h){var g=24*60*60*1000;var l=Math.abs(h.getTime()-k.getTime());f=Math.round(l/g);}return k==null||h==null||(f<=e);}return new publishing.validation.Rule(c,[a,d],b);};publishing.validation.DatePriorToAllowedDate=function(d,a,b){function c(){var f=publishing.util.parseDate(a);var e=publishing.util.parseDate(d.val());return e==null||e>=f;}return new publishing.validation.Rule(c,d,b);};publishing.validation.PickUpHrsBeforeDropOffHrs=function(a,f,e,c,b){function d(){if(a.val()==f.val()){return parseInt(e.val())<=parseInt(c.val())&&(parseInt(e.val())+120)<=parseInt(c.val())?true:false;}else{return true;}}return new publishing.validation.Rule(d,[e,c],b);};publishing.validation.ValueNot=function(b,d,a){function c(){return d.val()!=b;}return new publishing.validation.Rule(c,d,a);};publishing.validation.TotalBetween=function(c,b,a,d){this.apply=function(){var g=0;var h=a.filter(":visible");$.each(h,function(){g+=parseInt($(this).val(),10);});var e=g>=c;if(b!=-1){e=e&&g<=b;}if(h.length==0||e){return new publishing.validation.Result(true);}else{var f=new publishing.validation.Error(h,d);return new publishing.validation.Result(false,f);}};return this;};publishing.validation.ChildrenMustNotBeAlone=function(a,d,b,c){this.apply=function(){var m=false;var l=[];var g=a.filter(":visible");var k=d.filter(":visible");var h=b.filter(":visible");if(h.length>0){for(var f=0;f<h.length;f++){if(parseInt($(h[f]).val())>0&&parseInt($(g[f]).val())==0&&parseInt($(k[f]).val())==0){m=true;l.push(g[f]);l.push(k[f]);l.push(h[f]);}}}if(l.length==0||!m){return new publishing.validation.Result(true);}else{var e=new publishing.validation.Error(l,c);return new publishing.validation.Result(false,e);}};return this;};(function(b){var a={any:function(d,c){var f=this;if(arguments.length==1){c=d;}else{f=d;}var e=false;b.each(f,function(g,h){if(!e){e=e||c(g,h);}});return e;},all:function(e,d){var f=this;if(arguments.length==1){d=e;}else{f=e;}var c=true;b.each(f,function(g,h){c=c&&d(g,h);});return c;},blank:function(d,c){var e=this;if(c===undefined){c=d;}else{e=d;}return b.all(e,function(f,g){if(g.value!==undefined){g=g.value;}return b.trim(g)=="";});}};b.extend(b,a);b.extend(b.fn,a);b.extend(b.fn,{field:function(c){return this.find("[data-canonic='"+c+"']");},toggleSection:function(c){return this.bindAndTrigger(function(){if(b(this).attr("checked")){c.show();}else{c.hide();}});},initLobForm:function(f,e,k){var d=b(this);b(document).ajaxSuccess(h);function h(){if(!publishing.wizard.TAinstance){publishing.wizard.TAinstance=b('[data-provide="typeahead"]').data("typeahead");}}var c=this;c.find("input[type=text],select").focus(function(){b(this).parent().parent().addClass("fieldFocus");});c.find("input[type=text],select").blur(function(){b(this).parent().parent().removeClass("fieldFocus");});c.find("input[data-type='date']").attachCalendar(f).each(function(){if(this.value==""){this.value=publishing.DATE_FORMAT;}var l=b(this);});var g=c.attr("class");if(publishing.wizard.checkForChrome23OrAbove()){if((g==="hotelOnly")||(g==="flightOnly")){c.find(".xp-b-submit2").mousedown(function(l){publishing.wizard.handleMouseDown(c);});}}this.submit(function(Z){if(f.interstitial){publishing.wizard.turnOnInterstitial(c.find("button"),f);}publishing.wizard.addPackageLobFields(c.attr("class"),c);c.find("input[data-type='date']").each(function(){if(this.value==publishing.DATE_FORMAT){this.value="";}});c.find("input[data-default]").each(function(){if(this.value==b(this).attr("data-default")){this.value="";}});var D=e===undefined?true:e.validate();c.find("input[data-type='date']").each(function(){var aq=c.find("input[data-canonic='enableDateless']");if(aq.length>0&&aq[0].checked){if(b(this).attr("data-canonic")=="fromDate"){b("input[name='storedCheckinField']").val(this.value);}if(b(this).attr("data-canonic")=="toDate"){b("input[name='storedCheckoutField']").val(this.value);}this.value="";}});if(D){if(k!=undefined){k();}c.find(".ignore-hidden-fields").find(":input").filter("[class!=Do-Not-Remove]").filter(":hidden").remove();}else{var ao=c.find("input[data-canonic='enableDateless']");if(ao.length>0){ao[0].checked=false;}}if(D){var s,ap=b('[name="lob"]'),x,p=b(),F={flightOnly:"flight",flightAndHotel:"flightHotel",flightHotelAndCar:"flightHotelCar",flightAndCar:"flightCar",hotelOnly:"hotel",carOnly:"car",hotelAndCar:"hotelCar",activities:"activity"};if(ap.length){x=b('[name="lob"]').filter(":checked").attr("value");p=b("."+x);}else{p=b('[type="submit"]:visible').closest("form");x=p.attr("class");}x=F[x]?F[x]:x;var I=b("#trainAndHotel-tab").hasClass("on");var ak=b("#activities-tab").hasClass("on")||d.closest("form").hasClass("activities");var af=b("#cruise-tab").hasClass("on")||c.hasClass("cruise");var ae=(b("#carOnly-tab").hasClass("on")||c.hasClass("carOnly"))&&c.field("hasDiscode").val()!="0";var ac=(b("#vacationPackage").attr("checked")==="checked");var v=publishing.isMobile&&(x==="hotel");if((!ak&&!I&&!af&&!ac&&!ae&&publishing.isNewValidationLogicEnabled)||v){Z.preventDefault();var n={},E,l={"fromDate":"startDate","toDate":"endDate","numAdults":"adults","fromAirport2":"origin","date2":"departing","toAirport2":"destination","fromAirport3":"origin","date3":"departing","toAirport3":"destination","fromAirport4":"origin","date4":"departing","toAirport4":"destination","fromAirport5":"origin","date5":"departing","toAirport5":"destination","numRooms":"rooms","numChildren":"children","numAdults":"adults","specialEquipment-S":"skirack","specialEquipment-I":"infantseat","specialEquipment-T":"toddlerseat","specialEquipment-W":"chains","specialEquipment-L":"lefthand","specialEquipment-R":"righthand","specialEquipment-N":"navigation","carType":"type","RentalCompany":"vendor","destination":"pickup","dropOffLocation":"dropoff","hotelClass":"star","accommodationType":"lodging","fromTime":"startTime","toTime":"endTime","refundableFlightsOnly":"noPenalty","directFlightsOnly":"nonStop","airlinePreference":"carrier","partialHotelBooking":"isPartialStay","flexibleFromDate":"checkin","flexibleToDate":"checkout"},N={"flightHotelCar":"FHC","flightHotel":"FH","flightCar":"FC","hotelCar":"HC"},J={"1":"hotel","5":"bedBreakfast","16":"apartment","7":"condo","8":"allInclusive"},S={"NoPreference":"1","Economy":"2","Compact":"5","Midsize":"3","Standard":"6","FullSize":"4","Premium":"9","Luxury":"7",},P={"AIRPORT":1,"PLACE":4,"USADDRESS":2},R=b('[name="TripType"]'),Y;function t(aq,ar,at){at=at?at:":visible";aq.find("[data-canonic]").filter(at).each(function(){var au=b(this).data("canonic");if(au){au=l[au]?l[au]:au;if(b(this).attr("type")==="checkbox"){ar[au]=b(this).prop("checked");}else{ar[au]=b(this).val();
}}});ar.destination=ar.destination||ar.pickup;}function ai(aq,ar){var at=[];if(b("#H-NumRoom").val()==="9"){ar.isNinePlusRoomRequest=true;}b(".rooms").find(".room").filter(":visible").each(function(){var au={};t(b(this),au);au.children=an(b(this),au);at.push(au);});ar.rooms=at;}function O(aq,ar){p.find('[name="InfantInSeat"]').each(function(){if(b(this).prop("checked")){var at=(b(this).val()==="2");if(at){ar.lapSeat="lap";ar.isChildInLap=true;}else{ar.lapSeat="seat";ar.isChildInLap=false;}}});}function an(aq,at){var ar=[];aq.find('[data-canonic="childrenAge"]:visible').each(function(au){ar.push(parseInt(b(this).val()));});return ar;}t(p,n);function W(at,aq){var ar=at.find(".additionalOptionsLink");t(ar,aq);}function ag(ar){ar=parseInt(ar);var aq=""+(ar%60);if(aq.length===1){aq="0"+aq;}if(ar<60){if(ar===1){return"1200AM";}else{return"1230AM";}}else{if(ar===720){return"1200PM";}else{if(ar===750){return"1230PM";}else{if(ar<780){return""+Math.floor(ar/60)+aq+"AM";}else{return""+(Math.floor(ar/60)-12)+aq+"PM";}}}}}switch(x){case"flight":n.originTLA=publishing.wizard.TLA&&publishing.wizard.TLA["F-origin"]?publishing.wizard.TLA["F-origin"]:null;n.destinationTLA=publishing.wizard.TLA&&publishing.wizard.TLA["F-destination"]?publishing.wizard.TLA["F-destination"]:null;R.each(function(){if(b(this).prop("checked")){Y=b(this).attr("value");}switch(Y){case"RoundTrip":n.isRoundtrip=true;n.flighttype="roundtrip";break;case"Multicity":n.isMultiDest=true;n.multidest=[];n.flighttype="multi";n.origin=p.find('[data-canonic="origin"]:visible').val();b("#multiDestinationsDiv").find(".section").each(function(){var aq={};t(b(this),aq);if(aq.origin&&aq.destination&&(aq.departing||aq.start)){n.multidest.push(aq);}});break;case"OneWay":n.flighttype="oneway";break;}O(p,n);n.ages=an(p,n);});break;case"hotel":n.isHotelOnly=true;if(publishing.wizard.BIASED_FOR_HOTELS_PER_CITY){var M=c.field("destination").val();var ab=b.grep(publishing.wizard.hotelsForCities,function(ar,aq){return ar.cityId==M;})[0];n.group=ab.hotelIds.join(",");n.regionId=ab.cityId;n.destination=c.field("destination").find(":selected").text();}ai(p,n);break;case"car":n.car=n.car||{};t(p,n.car,"*");n.car.searchType=P[n.car.searchType];n.car.type=S[n.car.type];n.startTime=ag(n.startTime);n.endTime=ag(n.endTime);break;case"flightHotelCar":n.startTime=362;n.endTime=362;case"flightHotel":case"flightCar":n.startTime=362;n.endTime=362;case"hotelCar":n.packageType=N[x];n.isPackage=true;O(p,n);ai(p,n);break;}if(publishing.isMobile){n.isMobileDevice=true;}if(n.cabinClass){n.cabinClassLegacy=n.cabinClass;switch(n.cabinClass){case"1":n.cabinClass="first";break;case"2":n.cabinClass="business";break;case"5":n.cabinClass="premium";break;case"3":n.cabinClass="economy";break;default:n.cabinClass="economy";break;}}var aa=new b.Deferred();if(n.isMobileDevice&&x==="flight"&&n.flighttype!=="multi"){var y=new b.Deferred(),al=new b.Deferred(),z=b("#F-origin"),u=b("#F-destination");var Q=publishing.wizard.TAinstance;if(!Q){var aj=window.TA;Q={};}else{var X=Q.callback;}if(!n.originTLA&&z.val()){Q.callback=function(aq){n.originTLA=(aq&&aq.r&&aq.r[0]&&aq.r[0].a)||(aq&&aq[0]&&aq[0].a);y.resolve();};if(aj){aj.getData(z.val(),Q.callback);}else{Q.request(z.val());}}else{y.resolve();}if(!n.destinationTLA&&u.val()){Q.callback=function(aq){n.destinationTLA=(aq&&aq.r&&aq.r[0]&&aq.r[0].a)||(aq&&aq[0]&&aq[0].a);al.resolve();};if(aj){aj.getData(u.val(),Q.callback);}else{Q.request(u.val());}}else{al.resolve();}b.when(al,y).then(function(){aa.resolve();if(!aj){Q.callback=X;}});}else{aa.resolve();}if(v){n.isHashlessURLneeded=true;}var K=function(){E=!b.isEmptyObject(n)&&corewizard&&corewizard.search&&corewizard.search.getSearchUrl&&typeof corewizard.search.getSearchUrl==="function"&&corewizard.search.getSearchUrl(n,x);if(E){if(p.find(".additionalOptionsLink").length&&!n.isMobileDevice){if(n.lodging){E+="&lodging="+J[n.lodging];}if(n.star&&n.star!=="0"){E+="&star="+n.star;}if(n.hotelName){E+="&hotelName="+n.hotelName;}}if(b('[name="hotelChainId"]').length){E+="&chain="+b('[name="hotelChainId"]').val();}if(x==="flightCar"){E+="&NumRoom=1";if(n.children){E+="&NumChild1="+n.children;var ar=an(b(".section-children-ages"));b.each(ar,function(at){E+="&Rm1Child"+(at+1)+"Age="+this;});}if(n.adults){E+="&NumAdult1="+n.adults;}if(n.numSeniors){E+="&NumSenior1="+n.numSeniors;}}var aq=x.toLowerCase();if(aq.indexOf("car")>0){E+="&FromTime="+n.startTime+"&ToTime="+n.endTime;}if(n.numSeniors){E=E.replace(/seniors:0/,"seniors:"+n.numSeniors);}window.location=E;}};b.when(aa).then(K);return false;}c.find("select[data-default]").each(function(){if(this.value==b(this).attr("data-default")){if("true"==b(this).attr("hiddenWhenDefaultValue")){b(this).attr("name","");}}});if(b("input[name='CityId']").length&&(c.attr("class")=="hotelOnly")&&publishing.wizard.packageLobData.regionId){c.field("destination")[0].disabled=true;}}if(D){if(k!=undefined){k();}c.find(".ignore-hidden-fields").find(":input").filter("[class!=Do-Not-Remove]").filter(":hidden").remove();}else{var ao=c.find("input[data-canonic='enableDateless']");if(ao.length>0){ao[0].checked=false;}}if(D&&publishing.wizard.ON_FORM_SUBMIT!==undefined){D=publishing.wizard.ON_FORM_SUBMIT(Z,f);}if((publishing.wizard.TA_POPUNDER)&&(publishing.wizard.siteId)){var r=c.attr("class");var U=(r=="flightOnly"||r=="hotelOnly");if(typeof(PopUnder)!="undefined"&&U){PopUnder.initialize(b(Z.target).attr("class"),publishing.wizard.siteId);}}var q;if(D){var H=c.find("[name=InfantInSeat][value=2]");if(H!=null&&H.is(":checked")){H.attr("name","");H.attr("value","");}var B=c.find("input[name=SearchArea]");var ad=c.find("#H-destination").val();var m=window["TA"]?TA.getInstance("H-destination"):false;if(B&&ad&&m&&m.On&&!m.selectedItem){D=(c.gotData)?true:false;if(!D){TA.getData(ad,function(ar){var aq="CITY";if(ar&&ar.length==1){aq=ar[0].t;}B.val(aq);c.gotData=true;c.submit();});q=setTimeout(function(){B.val("CITY");c.gotData=true;c.submit();},3000);}}var L={"flightOnly":"Flight","hotelOnly":"Hotel","flightAndHotel":"FH","flightAndCar":"FC","hotelAndCar":"HC","flightHotelAndCar":"FHC","carOnly":"Car","activities":"Activities","cruise":"Cruise","threePP":"ThreePP","threePPTravelPackages":"ThreePPTravelPackages","trainAndHotel":"TH"};var T=c.attr("class");if(window["TA"]&&"flightAndHotel"==T||"flightAndCar"==T||"flightHotelAndCar"==T||"hotelAndCar"==T){if(m&&m.On){var A=m.selectedItem;if(A&&A.id!=""&&A.tla!=""){var w=A.id+":"+A.tla;b("<input>").attr({type:"hidden",name:"DestID",value:w}).appendTo(c);}}typeaheadO=TA.getInstance(L[T]+"-origin");if(typeaheadO&&typeaheadO.On){var A=typeaheadO.selectedItem;if(A&&A.id!=""&&A.tla!=""){var C=A.tla;c.find("input[name=FrAirport]").attr("name","");b("<input>").attr({type:"hidden",name:"FrAirport",value:C}).appendTo(c);}}}}if(!D&&f.interstitial){publishing.wizard.turnOffInterstitial(c.find("button"),f);}var V={"flightOnly":"FltTab.","hotelOnly":"HotTab.","package":"PckgTab.","flightAndHotel":"PckgTab."};var o="";var ah="";var G=V[c.attr("class")];if(window["g_packageTreatment"]){if(g_packageTreatment=="Radio"){o="2";}else{if(g_packageTreatment=="Checkbox"){o="3";if(V[b(".current-lob").attr("data-lob")]){ah=V[b(".current-lob").attr("data-lob")];}}else{if(g_packageTreatment=="RadioAndCheckbox"){o="4";if(V[b(".current-lob").attr("data-lob")]){ah=V[b(".current-lob").attr("data-lob")];}}}}}else{if(window["g_wizHorizontalRadio"]){o=5;}else{if(window["g_wizHorizontalTab"]){o=6;}}}try{trackClick(this,"a",document.getElementById("pageId").value+".SrchWzd."+ah+G+o);}catch(am){}clearTimeout(q);return D;});},attachCalendar:function(c){return this.each(function(k,g){var d=b(g);var l=d.attr("data-end-date");var o=d.attr("data-start-date");var h;var m;var e;if(l){h=d.parents("form").field(l);}else{if(o){m=true;h=d.parents("form").field(o);}}if(h){h=h[0];}if(d.attr("data-canonic")=="fromDate"){e=c.startDateCalCallback;}var f=f||{};if(g_datepicker){if(c.maxDepartureDate&&true!==m){g_datepicker.register(g,g,DPDisplay,c.minPurchaseDate,c.maxDepartureDate,null,h,c.maxDateRange,m,e);
}else{g_datepicker.register(g,g,DPDisplay,c.minPurchaseDate,c.maxPurchaseDate,null,h,c.maxDateRange,m,e);}}var p=d.parents("#multiDestinationsDiv");var n=c.defaultDurationDays;if(p&&p.length&&!isNaN(c.multiDestinationsDurationDays)){n=c.multiDestinationsDurationDays;}if(g_dateUpdater&&l&&h){g_dateUpdater.register(g,h,n,true);}});},triggerDatePicker:function(d,c){if(typeof d!="undefined"){if(c==true||d.blank()||d.val()==publishing.DATE_FORMAT){g_datepicker.pick(d[0]);}}},bindAndTrigger:function(c){return this.change(c).trigger("change",[true]);},clearErrors:function(){var c=b(this);c.find(".errors").each(function(){b(this).html("");});c.find(".error").each(function(){b(this).removeClass("error");});if(window.g_wizDesign!==undefined&&g_wizDesign=="responsive"){c.find(".invalid").removeClass("invalid");c.find(".validation-msg").addClass("hidden");}}});})(jQuery);expNamespace("publishing.validation");expNamespace("publishing.wizard.lobforms");publishing.wizard.lobforms.activities=function(a){var g=a.errorMessages;var d=$(publishing.WIZARD_CONTAINER_ID+" form.activities");var h=a.taConfig;var b=d.field("destination");var n=d.field("fromDate");var e=d.field("toDate");var l=a.isTypeAheadActivityUSOn;var k=a.newDesign;var o=14;if(k){n.change(function(){var q=publishing.util.parseDate(n.val());if(q){e.val(publishing.util.formattedDate(publishing.DATE_FORMAT,o,q));}});}var m=[new publishing.validation.NotEmpty(b,g.destination),new publishing.validation.OptionalDate(n,g.startDate),new publishing.validation.OptionalDate(e,g.endDate),new publishing.validation.DateRange(n,e,g.bookingDateRange,true),new publishing.validation.DatePriorToAllowedDate(n,a.minPurchaseDate,g.startPriorToCurrentDate),new publishing.validation.DatePriorToAllowedDate(e,a.minPurchaseDate,g.endPriorToCurrentDate)];var f=new publishing.validation.ErrorRenderer(d,d.find("ul.errors"));var c=new publishing.validation.Validator(m,f);if(h){h.itemClickedEvent=publishing.wizard.preserveTA;}function p(q){d.triggerDatePicker(n,false);}d.initLobForm(a,c);if(publishing.wizard.TYPEAHEAD_ENABLED&&l=="1"){publishing.wizard.typeahead(b,h,p);}};publishing.wizard.lobforms.insurance=function(a){var f=a.errorMessages;var c=$(publishing.WIZARD_CONTAINER_ID+" form.insurance");var g=a.taConfig;var l=c.field("fromDate");var d=c.field("toDate");var h=a.newDesign;var n=14;if(h){l.change(function(){var o=publishing.util.parseDate(l.val());if(o){d.val(publishing.util.formattedDate(publishing.DATE_FORMAT,n,o));}});}var k=[new publishing.validation.OptionalDate(l,f.startDate),new publishing.validation.OptionalDate(d,f.endDate),new publishing.validation.DateRange(l,d,f.bookingDateRange,true),new publishing.validation.DatePriorToAllowedDate(l,a.minPurchaseDate,f.startPriorToCurrentDate),new publishing.validation.DatePriorToAllowedDate(d,a.minPurchaseDate,f.endPriorToCurrentDate)];var e=new publishing.validation.ErrorRenderer(c,c.find("ul.errors"));var b=new publishing.validation.Validator(k,e);function m(){if(l.blank()||l.val()==publishing.DATE_FORMAT){$(l).click();}}c.initLobForm(a,b);};expNamespace("publishing.wizard.lobforms");publishing.wizard.lobforms.tgInsurance=function(q){var A=B("fname").substring(0,20);var s=B("lname").substring(0,20);var k=B("mail").substring(0,64);var g=q.errorMessages;var d=$(publishing.WIZARD_CONTAINER_ID+" form.insurance");var t=d.field("departureDate");var x=d.field("returnDate");var C=t.val();var e=q.defaultDurationDays;var o=d.field("applicantFirstName");var c=d.field("applicantLastName");var b=d.field("applicantEmail");var y=d.field("insurerFirstName");var n=d.field("insurerLastName");var l=d.field("insurerGender");var r=$("#insurance-InsurerDOB");var p=$("#InsurerDOB-Year");var m=$("#InsurerDOB-Month");var z=$("#InsurerDOB-Day");if(A!==""){o.val(A);y.val(A);}if(s!==""){c.val(s);n.val(s);}if(k!==""){b.val(k);}t.attr("maxlength",8);x.attr("maxlength",8);o.attr("maxlength",20);c.attr("maxlength",20);b.attr("maxlength",64);y.attr("maxlength",20);n.attr("maxlength",20);p.bind({change:function(){w();}});m.bind({change:function(){w();}});z.bind({change:function(){w();}});var u=q.dateFormat;function w(){var D=p.val()+m.val()+z.val();r.val(D);}var a=[new publishing.validation.NotEmpty(o,g.applicantFirstNameIsBlank),new publishing.validation.IsAlphabetOnly(o,g.applicantNameIsAlphabetOnly),new publishing.validation.NotEmpty(c,g.applicantLastNameIsBlank),new publishing.validation.IsAlphabetOnly(c,g.applicantNameIsAlphabetOnly),new publishing.validation.NotEmpty(b,g.applicantEmailIsBlank),new publishing.validation.NotEmpty(y,g.insurerFirstNamesBlank),new publishing.validation.IsAlphabetOnly(y,g.insurerNameIsAlphabetOnly),new publishing.validation.NotEmpty(n,g.insurerLastNameIsBlank),new publishing.validation.IsAlphabetOnly(n,g.insurerNameIsAlphabetOnly),new publishing.validation.NotEmpty(p,g.dobIsNotCorrect),new publishing.validation.NotEmpty(m,g.dobIsNotCorrect),new publishing.validation.NotEmpty(z,g.dobIsNotCorrect),new publishing.validation.NotEmpty(l,g.genderIsNotSelected),new publishing.validation.IsEmailAddress(b,g.isNotCorrectEmailAddress),new publishing.validation.MandatoryDate(t,g.departureDate),new publishing.validation.DateRange(t,x,g.departureDateAndReturnDatesTooFarApart,true),new publishing.validation.DatePriorToAllowedDate(t,q.minPurchaseDate,g.departurePriorToCurrentDate),new publishing.validation.DatePriorToAllowedDate(x,q.minPurchaseDate,g.departurePriorToCurrentDate),new publishing.validation.DatesNotToManyDaysAppart(t,x,q.maxDateRange,g.departureDateAndReturnDatesTooFarApart)];var v=new publishing.validation.ErrorRenderer(d,d.find("ul.errors"));var f=new publishing.validation.Validator(a,v);d.initLobForm(q,f,this.onSuccess);function h(E){var F=E.otadata;var D=F.applicant;var H=F.insurer;var G='<?xml version="1.0" encoding="utf-8" ?><otadata><p>'+F.p+"</p><homepage>"+F.homepage+"</homepage>";G+="<hoken_siki>";G+=F.departureDate;G+="</hoken_siki>";G+="<hoken_shuki>";G+=F.returnDate;G+="</hoken_shuki>";G+="<keiyaku>";G+="<sei>";G+=D.lastName;G+="</sei>";G+="<mei>";G+=D.firstName;G+="</mei>";G+="<email>";G+=D.email;G+="</email>";G+="</keiyaku>";G+="<hihoken>";G+="<sei>";G+=H.lastName;G+="</sei>";G+="<mei>";G+=H.firstName;G+="</mei>";G+="<sex>";G+=H.sex;G+="</sex>";G+="<birth>";G+=H.birth;G+="</birth>";G+="</hihoken>";G+="</otadata>";return G;}$("#tg-insurance-form").submit(function(){var D=f===undefined?true:f.validate();var E={"otadata":{"p":q.bootvalue,"homepage":q.homepage,"departureDate":t.val().replace(/\//g,""),"returnDate":x.val().replace(/\//g,""),"applicant":{"lastName":c.val(),"firstName":o.val(),"email":b.val()},"insurer":{"lastName":n.val(),"firstName":y.val(),"sex":$("input[name=InsurerGender]:radio:checked").val(),"birth":r.val()}}};var H=h(E);var G=encodeURI(H);if(D){var F=jQuery("<form>",{"action":q.actionURL,"method":"POST","target":"_blank"}).append(jQuery("<input>",{"name":"linkData","value":G,"type":"hidden"}));F.appendTo(document.body).submit();}return false;});function B(D){D=D.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var F=new RegExp("[\\?&]"+D+"=([^&#]*)"),E=F.exec(location.search);return E==null?"":decodeURIComponent(E[1].replace(/\+/g," "));}};expNamespace("publishing.wizard.lobforms");publishing.wizard.lobforms.tuneInsurance=function(k){var e=k.errorMessages;var c=$(publishing.WIZARD_CONTAINER_ID+" form.insurance");var m=c.field("departureDate");var s=m.val();var t=c.find("select[name=Destination]");var q=c.field("coverage");var r=c.field("planType");var d=k.defaultDurationDays;var l=k.annualDuration;var p=c.field("returnDate");var n=k.dateFormat;var a=[new publishing.validation.NotEmpty(t,e.destinationIsBlank),new publishing.validation.NotEmpty(q,e.coverageIsBlank),new publishing.validation.NotEmpty(r,e.typeOfPlanIsBlank),new publishing.validation.MandatoryDate(m,e.departureDate),new publishing.validation.DateRange(m,p,e.departurePriorToCurrentDate,true),new publishing.validation.DatePriorToAllowedDate(m,k.minPurchaseDate,e.departurePriorToCurrentDate),new publishing.validation.DatePriorToAllowedDate(p,k.minPurchaseDate,e.departurePriorToCurrentDate),new publishing.validation.DatesNotToManyDaysAppart(m,p,k.maxDateRange,e.checkInAndOutDatesTooFarApart)];
var o=new publishing.validation.ErrorRenderer(c,c.find("ul.errors"));var f=new publishing.validation.Validator(a,o);function b(){g(t);g(q);g(r);var v=r.find(":selected");if(v[0].value=="INSB"){r.change();}}m.change(function(){h();});t.bind({click:function(){var y=t.position();var x=30;var v=y.left+t.width()+25;var w=y.top-x+"px";v+="px";u(t,w,v);return false;},change:function(){$("#PopUp").fadeOut();g(t);}});q.bind({change:function(){g(q);}});r.bind({change:function(){g(r);var v=r.find(":selected");if(v[0].value=="INSB"){h();$("#insurance-returnDate-label").parent().parent().hide();}else{h();$("#insurance-returnDate-label").parent().parent().show();}}});$("#Question").css({"cursor":"pointer"}).click(function(){var y=$("#Question").position();var x=30;var v=y.left+$("#Question img").width()+$("#Question span").width()+25;var w=y.top-x+"px";v+="px";u($("#Question"),w,v);return false;});function g(y){var v=y.find(":selected");var x=y.parent().next();var w=x.find(":first-child");w.text(y.find(":selected").text()).parent().addClass("changed");}function h(){var w=publishing.util.parseDate(m.val());if(w){var v=r.find(":selected");var x=d;if(v[0].value=="INSB"){x=l;}p.val(publishing.util.formattedDate(n,x,w));}}function u(v,w,x){jQuery(document).one("click",function(){jQuery("#PopUp").fadeOut();});$("#PopUp").css({"display":"block","top":w,"left":x}).click(function(){return false;});$(".Close").css({"cursor":"pointer"}).click(function(){$("#PopUp").fadeOut();});}b();c.initLobForm(k,f,this.onSuccess);};expNamespace("publishing.validation");expNamespace("publishing.wizard.lobforms");publishing.wizard.lobforms.cruise=function(e){var f=e.errorMessages;var d=$(publishing.WIZARD_CONTAINER_ID+" form.cruise");var c=d.field("destination");var a=[new publishing.validation.NotEmpty(c,f.destination)];var g=new publishing.validation.ErrorRenderer(d,d.find("ul.errors"));var b=new publishing.validation.Validator(a,g);d.initLobForm(e,b);};expNamespace("publishing.wizard.lobforms");publishing.wizard.lobforms.carOnly=function(s){var k=s.errorMessages;var e=$(publishing.WIZARD_CONTAINER_ID+" form.carOnly");var E=new publishing.wizard.lobforms.carOnly.AdditionalOptions(e);var r=s.taConfig;var l=e.field("street");var x=e.field("city");var F=e.field("state");var h=e.field("zip");var m=e.field("destination");var d=e.field("dropOffLocation");var A=e.field("fromDate");var w=e.field("toDate");var b=e.field("fromTime");var B=e.field("toTime");var c=e.find("select[name=SearchType]");var o=e.field("distance");var t=e.find("input[name=DiffDropLoc]");var y=d.attr("data-default");var n=$("#carsDropOff");var C=$("#showHideDropOff");var z=$("#carOnly-hideSpecialEquipment");var q=$("#carOnly-showSpecialEquipment");var D=$("#carOnly-specialEquipment");if(window.g_wizDesign!==undefined&&g_wizDesign=="tabbed"){C.change(function(){if(C.is(":checked")){n.show();}else{n.hide();}});z.click(function(){z.hide();q.show();D.hide();});q.click(function(){z.show();q.hide();D.show();});}var a=[new publishing.validation.NotEmpty(l,k.street),new publishing.validation.NotEmpty(x,k.city),new publishing.validation.NotEmpty(F,k.state),new publishing.validation.NotEmpty(h,k.zip),new publishing.validation.NotEmpty(m,k.pickUpLocation),new publishing.validation.MandatoryDate(A,k.pickUpDate),new publishing.validation.MandatoryDate(w,k.dropOffDate),new publishing.validation.DateRange(A,w,k.bookingDateRange,true),new publishing.validation.DatePriorToAllowedDate(A,s.minPurchaseDate,k.pickUpPriorToCurrentDate),new publishing.validation.DatePriorToAllowedDate(w,s.minPurchaseDate,k.dropOffPriorToCurrentDate),new publishing.validation.PickUpHrsBeforeDropOffHrs(A,w,b,B,k.Time2HrDiffMessage)];var v=new publishing.validation.ErrorRenderer(e,e.find("ul.errors"));var g=new publishing.validation.Validator(a,v);e.initLobForm(s,g,function(){E.populateChosenSpecialEquipment();if(y==d.val()){d.val("");}});function f(){var I=$(this).val();var G=I=="AIRPORT";var J=I=="PLACE";var H=I=="USADDRESS";l.parents("fieldset").toggle(H);x.parents("fieldset").toggle(H);F.parents("fieldset").toggle(H);h.parents("fieldset").toggle(H);m.parents("fieldset").toggle(!H);o.parents("fieldset").toggle(J);d.parents("fieldset").toggle(G);t.val(G?"1":"0");}function p(G){$("#C-SearchType").val("PLACE");if(G.type==null||G.type!="AIRPORT"){if($("#C-dropOffLocation")!=null){$("#C-dropOffLocation").val(s.sameAsPickup);}if($("#C-dropOffLocation-label")!=null){$("#C-dropOffLocation-label").hide();}if($("#showHideDropOff")!=null){$("#showHideDropOff").hide();}if($(".showHideDropOffText")!=null){$(".showHideDropOffText").hide();}}else{$("#C-SearchType").val("AIRPORT");if($("#C-dropOffLocation-label")!=null){$("#C-dropOffLocation-label").show();}if($("#showHideDropOff")!=null){$("#showHideDropOff").show();}if($(".showHideDropOffText")!=null){$(".showHideDropOffText").show();}}}function u(){var J=document.getElementById("C-SearchType");var I=document.getElementById("C-SearchType-label");var G=document.getElementById("C-Distance");var H=document.getElementById("C-Distance-label");if(J!=null){J.style.display="none";}if(I!=null){I.style.display="none";}if(G!=null){G.style.display="none";}if(H!=null){H.style.display="none";}$("#C-destination").val("");$("#C-dropOffLocation").val(s.sameAsPickup);}if(r){r.itemClickedEvent=publishing.wizard.preserveTA;}c.bindAndTrigger(f);if(publishing.wizard.TYPEAHEAD_ENABLED&&s.taConfigO!=undefined&&s.taConfigD!=undefined){publishing.wizard.typeahead(e.field("destination"),s.taConfigO,p);publishing.wizard.typeahead(e.field("dropOffLocation"),s.taConfigD);u();}};publishing.wizard.lobforms.carOnly.AdditionalOptions=function(f){var b=f.find("#carOnly-additionalOptions");var a=f.find("a[name=carOnly-showAdditionalOptions]");var e=f.find("a[name=carOnly-hideAdditionalOptions]");var c=f.find("input[name=Equipment]");var d=f.find(".availabilityAndCostInfoLink");var g=f.find(".availabilityAndCostInfoContent");this.populateChosenSpecialEquipment=function(){var h=b.find("input[type=checkbox]").filter(":checked");var k=$.map(h,function(m,l){return m.value;});c.val(k.join(""));};publishing.wizard.lobforms.additionalOptions({showAdditionalOptionsField:a,additionalOptionsContainer:b,hideAdditionalOptionsField:e,infoLinkField:d,infoContainer:g});};expNamespace("publishing.wizard.lobforms");publishing.wizard.lobforms.flightAndCar=function(p){var d=$(publishing.WIZARD_CONTAINER_ID+" form.flightAndCar");var h=p.errorMessages;var l=d.field("origin");var b=d.field("destination");var k=d.field("fromDate");var s=d.field("toDate");var e=d.field("numChildren");var r=d.find(".section-flight-age-group");var m=r.field("childrenAge");var u=r.find(".number-of-travellers");var n=d.find(".section-infants-pref");var x=d.find("[data-canonic='numAdults']");var v=d.find("[data-canonic='numSeniors']");var q=d.find("[data-canonic='numChildren']");var o=p.taConfig;var g=d.find("input[name=addFlightPackage]");var w=d.find("input[name=addHotelPackage]");var c=d.find("input[name=addCarPackage]");publishing.wizard.setUpPackageCheckboxes(g,w,c);var a=[new publishing.validation.NotEmpty(l,h.departureCity),new publishing.validation.NotEmpty(b,h.destinationCity),new publishing.validation.CityBetween(l,b,h.sameCity),new publishing.validation.MandatoryDate(k,h.departureDate),new publishing.validation.MandatoryDate(s,h.returnDate),new publishing.validation.DateRange(k,s,h.bookingDateRange,true),new publishing.validation.DatePriorToAllowedDate(k,p.minPurchaseDate,h.departurePriorToCurrentDate),new publishing.validation.DatePriorToAllowedDate(s,p.minPurchaseDate,h.returnPriorToCurrentDate),new publishing.validation.ChildrenMustNotBeAlone(x,v,q,h.childrenMustNotBeAlone),new publishing.validation.TotalBetween(1,6,u,h.totalNumberOfTravellers)];var t=new publishing.validation.ErrorRenderer(d,d.find("ul.errors"));var f=new publishing.validation.Validator(a,t);d.initLobForm(p,f);publishing.wizard.initRoom(r,a,p.errorMessages);m.add(e).bindAndTrigger(publishing.wizard.common.flight.accompaniedInfantListener(m,n));
if(o){o.itemClickedEvent=function(z){if(z&&z.On){var y=z.selectedItem;if(y&&y.data&&y.id=="FC-destination"){publishing.wizard.packageLobData.TLA=y.data.a;publishing.wizard.packageLobData.MultiCity=y.data.amc;}}publishing.wizard.preserveTA(z);};}publishing.wizard.setupPackageRadioButtons(d);};expNamespace("publishing.wizard.lobforms");expNamespace("publishing.wizard.lobforms.common");publishing.wizard.lobforms.flightHotelAndCar=function(b){var a=$(publishing.WIZARD_CONTAINER_ID+" form.flightHotelAndCar");publishing.wizard.lobforms.common.flightHotelAndCar(a,b);};publishing.wizard.lobforms.flightAndHotel=function(b){var a=$(publishing.WIZARD_CONTAINER_ID+" form.flightAndHotel");publishing.wizard.lobforms.common.flightHotelAndCar(a,b);};publishing.wizard.lobforms.trainAndHotel=function(b){var a=$(publishing.WIZARD_CONTAINER_ID+" form.trainAndHotel");publishing.wizard.lobforms.common.flightHotelAndCar(a,b);};publishing.wizard.lobforms.common.flightHotelAndCar=function(f,v){var n=v.errorMessages;var z=v.diableCkiPopout||false;var a=v.taConfigO;var q=v.taConfigD;var r=f.field("origin");var d=f.field("destination");var b=f.field("dest-region");var w=f.field("dest-city");var o=f.field("fromDate");var y=f.field("toDate");var p=f.field("partialHotelBooking");var C=f.field("flexibleFromDate");var s=f.field("flexibleToDate");var E=f.find(".rooms .room");var k=f.field("numRooms");var B=E.find(".number-of-travellers");var g=E.field("numChildren");var t=f.find(".section-children-ages select");var u=f.find(".section-infants-pref");var x=f.find(".section-partial-hotel-booking-date");var m=f.find("input[name=addFlightPackage]");var D=f.find("input[name=addHotelPackage]");var e=f.find("input[name=addCarPackage]");publishing.wizard.setUpPackageCheckboxes(m,D,e);publishing.wizard.lobforms.common.flightHotelAndCar_ValidationRules=[new publishing.validation.NotEmpty(r,n.departureCity),new publishing.validation.NotEmpty(d,n.destinationCity),new publishing.validation.CityBetween(r,d,n.sameCity),new publishing.validation.NotSelect(b,n.destinationCity),new publishing.validation.NotSelectCity(b,w,n.destinationCity),new publishing.validation.OptionalDate(o,n.departureDate),new publishing.validation.OptionalDate(y,n.returnDate),new publishing.validation.MandatoryDate(C,n.flexibleFromDate),new publishing.validation.MandatoryDate(s,n.flexibleToDate),new publishing.validation.DateRange(o,y,n.bookingDateRange),new publishing.validation.DateRange(C,s,n.bookingDateRange),new publishing.validation.DatePriorToAllowedDate(o,v.minPurchaseDate,n.departurePriorToCurrentDate),new publishing.validation.DatePriorToAllowedDate(y,v.minPurchaseDate,n.returnPriorToCurrentDate),new publishing.validation.DateBetween(C,o,y,n.partialBookingDateSequenceMessage),new publishing.validation.DateBetween(s,o,y,n.partialBookingDateSequenceMessage),new publishing.validation.TotalBetween(1,6,B,n.totalNumberOfTravellers),new publishing.validation.DatesNotToManyDaysAppart(o,y,v.maxDateRange,n.checkInAndOutDatesTooFarApart),new publishing.validation.DatePastMaxPurchaseDate(v.maxPurchaseDate,o,n.datePastMaxDate),new publishing.validation.DatePastMaxPurchaseDate(v.maxPurchaseDate,y,n.datePastMaxDate)];publishing.wizard.setupPackageRadioButtons(f);publishing.wizard.setUpAddRoomLinks(f);function c(){if(!publishing.wizard.BIASED_FOR_HOTELS_PER_CITY){return;}var G=f.field("destination").val();var F=$.grep(publishing.wizard.hotelsForCities,function(I,H){return I.cityId==G;})[0];f.append($('<input type="hidden" name="HotelIDs" value="'+F.hotelIds.join()+'" />'));}var A=new publishing.validation.ErrorRenderer(f,f.find("ul.errors"));var l=new publishing.validation.Validator(publishing.wizard.lobforms.common.flightHotelAndCar_ValidationRules,A);publishing.wizard.lobforms.flightHotel_DatesChanged=function(){f.triggerDatePicker(y,true);};f.initLobForm(v,l,c);publishing.wizard.initRooms(f,E,publishing.wizard.lobforms.common.flightHotelAndCar_ValidationRules,n,v);t.add(g).bindAndTrigger(publishing.wizard.common.flight.accompaniedInfantListener(t,u));p.toggleSection(x);if(a){a.itemClickedEvent=publishing.wizard.preserveTA;}if(q){q.itemClickedEvent=publishing.wizard.preserveTA;}function h(F){if(z==false){f.triggerDatePicker(o,false);}}if(publishing.wizard.TYPEAHEAD_ENABLED){if(publishing.wizard.FLIGHT_AND_HOTEL_DESTINATION_IS_VISIBLE){publishing.wizard.typeahead(f.field("origin"),a);publishing.wizard.typeahead(f.field("destination"),q,h);}else{publishing.wizard.typeahead(f.field("origin"),a,h);publishing.wizard.typeahead(f.field("destination"),q);}}publishing.wizard.fillCheckInDateAuto(p,v);};expNamespace("publishing.wizard.lobforms");expNamespace("publishing.wizard.lobforms.flightOnly");expNamespace("publishing.wizard.lobforms.flightOnly.jp");publishing.wizard.lobforms.flightOnly.jp.validationRules=function(k,l){var g=l.errorMessages;var u=k.find(".multipleDestinations").find("[dataField='origin']");var m=k.find(".multipleDestinations").find("[dataField='destination']");var a=k.find(".multipleDestinations").field("fromDate");if(a.length==0){a=k.find(".multipleDestinations").field("date1");}var B=k.find(".oneWayOrReturn").find("[dataField='origin']");var h=k.find(".oneWayOrReturn").find("[dataField='destination']");var y=k.find(".oneWayOrReturn").field("fromDate");var s=k.field("toDate");var r=k.find(".section-flight-age-group");var w=r.find(".number-of-travellers");var A=r.find("[data-canonic='numAdults']");var x=r.find("[data-canonic='numSeniors']");var p=r.find("[data-canonic='numChildren']");var n=k.find(".oneWayOrReturn").find("[dataField='deptRegion']");var b=k.find(".oneWayOrReturn").find("[dataField='destRegion']");var d=k.find(".oneWayOrReturn").find("[dataField='stopOverRegion']");var e=k.find(".oneWayOrReturn").find("[dataField='deptDestination']");var f=k.find(".oneWayOrReturn").find("[dataField='destDestination']");var c=k.find(".oneWayOrReturn").find("[dataField='stopOverDestination']");var t=k.find(".multipleDestinations").find("select[dataField='region']");var z=k.find(".multipleDestinations").find("select[dataField='destination']");var o=k.find(".stopOverField").find("[dataField='stopOverSearchField']");var q=k.find(".stopOverField").field("stopOverFromDate");var v=k.find(".stopOverField").field("stopOverToDate");return[new publishing.validation.NotSelect(n,g.selectError),new publishing.validation.NotSelect(b,g.selectError),new publishing.validation.NotSelect(d,g.selectError),new publishing.validation.NotSelectCity(n,e,g.selectError),new publishing.validation.NotSelectCity(b,f,g.selectError),new publishing.validation.NotSelectCity(d,c,g.selectError),new publishing.validation.NotEmpty(o,g.keyWordError),new publishing.validation.MandatoryDate(v,g.returnDate),new publishing.validation.DateRange(s,v,g.bookingDateRange,true),new publishing.validation.DatePriorToAllowedDate(v,l.minPurchaseDate,g.returnPriorToCurrentDate),new publishing.validation.DatePastMaxPurchaseDate(l.maxPurchaseDate,v,g.datePastMaxDate),new publishing.validation.MandatoryDate(q,g.departureDate),new publishing.validation.DateRange(q,s,g.bookingDateRange,true),new publishing.validation.DatePriorToAllowedDate(q,l.minPurchaseDate,g.departurePriorToCurrentDate),new publishing.validation.DatePastMaxPurchaseDate(l.maxPurchaseDate,q,g.datePastMaxDate),new publishing.validation.DateRange(y,q,g.priorToDeptDate),new publishing.validation.NotSelect(t,g.selectError),new publishing.validation.NotSelect(z,g.selectError),new publishing.validation.NotEmpty(u,g.departureCity),new publishing.validation.NotEmpty(m,g.destinationCity),new publishing.validation.CityBetween(u,m,g.sameCity),new publishing.validation.MandatoryDate(a,g.departureDate),new publishing.validation.DatePriorToAllowedDate(a,l.minPurchaseDate,g.departurePriorToCurrentDate),new publishing.validation.NotEmpty(B,g.departureCity),new publishing.validation.NotEmpty(h,g.destinationCity),new publishing.validation.CityBetween(B,h,g.sameCity),new publishing.validation.MandatoryDate(y,g.departureDate),new publishing.validation.MandatoryDate(s,g.returnDate),new publishing.validation.DateRange(y,s,g.bookingDateRange,true),new publishing.validation.DatePriorToAllowedDate(y,l.minPurchaseDate,g.departurePriorToCurrentDate),new publishing.validation.DatePriorToAllowedDate(s,l.minPurchaseDate,g.returnPriorToCurrentDate),new publishing.validation.TotalBetween(1,l.maximumNumberOfTravellersAllowed,w,g.totalNumberOfTravellers),new publishing.validation.DatePastMaxPurchaseDate(l.maxPurchaseDate,y,g.datePastMaxDate),new publishing.validation.DatePastMaxPurchaseDate(l.maxPurchaseDate,s,g.datePastMaxDate),new publishing.validation.ChildrenMustNotBeAlone(A,x,p,g.childrenMustNotBeAlone)];
};publishing.validation.MultiDestLegNotEmpty=function(b,f,e,a){function c(){return !b.blank();}function d(){var g=false;$.each(b,function(){g=g||$(this).is(":hidden");});return g;}this.apply=function(){var g=((f.length==0||f.val()=="City or airport"||f.val()==""||f.val()==undefined)&&(e.length==0||e.val()=="City or airport"||e.val()==""||e.val()==undefined));if(g){return new publishing.validation.Result(true);}if(d()||c()){return new publishing.validation.Result(true);}else{var h=new publishing.validation.Error(b,a);return new publishing.validation.Result(false,h);}};return this;};publishing.validation.MultiDestLegMandatoryDate=function(d,b,g,f){function a(){return d.val()!=""&&d.val()!=publishing.DATE_FORMAT;}function c(){return publishing.util.parseDate(d.val())!=null;}function e(){var h=false;$.each(d,function(){h=h||$(this).is(":hidden");});return h;}this.apply=function(){var h=((g.val()=="City or airport"||g.val()==""||g.val()==undefined)&&(f.val()=="City or airport"||f.val()==""||f.val()==undefined));if(h){return new publishing.validation.Result(true);}if(e()){return new publishing.validation.Result(true);}else{if(!a()){return new publishing.validation.Result(false,new publishing.validation.Error(d,b.mandatory));}else{if(!c()){return new publishing.validation.Result(false,new publishing.validation.Error(d,b.dateFormat));}else{return new publishing.validation.Result(true);}}}};return this;};publishing.wizard.lobforms.flightOnly.validationRules=function(f,g){var d=g.errorMessages;var p=f.find(".multipleDestinations").field("origin");var k=f.find(".multipleDestinations").field("destination");var b=f.find(".multipleDestinations").field("fromDate");if(b.length==0){b=f.find(".multipleDestinations").field("date1");}var w=f.find(".oneWayOrReturn").field("origin");var e=f.find(".oneWayOrReturn").field("destination");var u=f.find(".oneWayOrReturn").field("fromDate");var n=f.field("toDate");var m=f.find(".section-flight-age-group");var q=m.find(".number-of-travellers");var v=m.find("[data-canonic='numAdults']");var s=m.find("[data-canonic='numSeniors']");var l=m.find("[data-canonic='numChildren']");var a=[new publishing.validation.NotEmpty(p,d.departureCity),new publishing.validation.NotEmpty(k,d.destinationCity),new publishing.validation.CityBetween(p,k,d.sameCity),new publishing.validation.MandatoryDate(b,d.departureDate),new publishing.validation.DatePriorToAllowedDate(b,g.minPurchaseDate,d.departurePriorToCurrentDate),new publishing.validation.NotEmpty(w,d.departureCity),new publishing.validation.NotEmpty(e,d.destinationCity),new publishing.validation.CityBetween(w,e,d.sameCity),new publishing.validation.MandatoryDate(u,d.departureDate),new publishing.validation.MandatoryDate(n,d.returnDate),new publishing.validation.DateRange(u,n,d.bookingDateRange,true),new publishing.validation.DatePriorToAllowedDate(u,g.minPurchaseDate,d.departurePriorToCurrentDate),new publishing.validation.DatePriorToAllowedDate(n,g.minPurchaseDate,d.returnPriorToCurrentDate),new publishing.validation.TotalBetween(1,g.maximumNumberOfTravellersAllowed,q,d.totalNumberOfTravellers),new publishing.validation.DatePastMaxPurchaseDate(g.maxPurchaseDate,u,d.datePastMaxDate),new publishing.validation.DatePastMaxPurchaseDate(g.maxPurchaseDate,n,d.datePastMaxDate),new publishing.validation.ChildrenMustNotBeAlone(v,s,l,d.childrenMustNotBeAlone)];var r=2;while(r<=$(".multipleDestinations .section").length){var h=f.find(".multipleDestinations .section:nth-child("+r+")");var o=h.field("fromAirport"+r);var c=h.field("toAirport"+r);var t=h.field("date"+r);a.push(new publishing.validation.MultiDestLegNotEmpty(o,o,c,d.departureCity),new publishing.validation.MultiDestLegNotEmpty(c,o,c,d.destinationCity),new publishing.validation.CityBetween(o,c,d.sameCity),new publishing.validation.MultiDestLegMandatoryDate(t,d.departureDate,o,c),new publishing.validation.DatePriorToAllowedDate(t,g.minPurchaseDate,d.departurePriorToCurrentDate));r++;}return a;};publishing.wizard.lobforms.flightOnly.addChangeListener=function(c){var b="F-fromAirport"+c+"-"+c,a="hidden-tla-F-fromAirport"+c+"-"+c,d="F-toAirport"+c+"-"+c,e="hidden-tla-F-toAirport"+c+"-"+c;jQuery("#"+a).attr("value",urlHandler.parseAirportCode(jQuery("#"+b).attr("value"),true));jQuery("#"+b).bind("change",function(){jQuery("#"+a).attr("value","");});jQuery("#"+e).attr("value",urlHandler.parseAirportCode(jQuery("#"+d).attr("value"),true));jQuery("#"+d).bind("change",function(){jQuery("#"+e).attr("value","");});};function publishingWizardPackageTypeAheadOriginCallback(a){publishingWizardCommonTypeAheadCallback(a,"FH-origin");}function publishingWizardPackageTypeAheadDestinationCallback(a){publishingWizardCommonTypeAheadCallback(a,"FH-destination");}function publishingWizardFlightOnlyTypeAheadOriginCallback(a){publishingWizardCommonTypeAheadCallback(a,"F-origin");}function publishingWizardFlightOnlyTypeAheadDestinationCallback(a){var b=JSON.parse(a.attr("data-data"));if(b){publishing.wizard.packageLobData.TLA=b.a;publishing.wizard.packageLobData.MultiCity=b.amc;}publishingWizardCommonTypeAheadCallback(a,"F-destination");}function publishingWizardHotelOnlyTypeAheadDestinationCallback(a){publishingWizardCommonTypeAheadCallback(a,"H-destination");}function publishingWizardCommonTypeAheadCallback(a,b){publishing.wizard.TLA=publishing.wizard.TLA||{};publishing.wizard.TLA[b]=a.data("data").a;a.inputId=b;publishing.wizard.preserveTA(a);}publishing.wizard.lobforms.flightOnly.init=function(k,w,b,y){var J=k.find("#flightOnly-additionalOptions");var a=k.find("a[name=flightOnly-showAdditionalOptions]");var o=k.find("a[name=flightOnly-hideAdditionalOptions]");var p=k.find(".moreInfoLink");var d=k.find(".moreInfoContent");var v=w.taConfig;var z=w.diableCkiPopout||false;var e=k.find("input[name=TripType]");var A=k.find("#flightPassengers");var H=k.find("#multiFlightPassengers");var c=k.find("[name=TripType][value=RoundTrip]");var h=k.find("[name=TripType][value=Multicity]");var n=k.find(".section-returning-time-details");var E=k.find(".section-going-details");var D=k.find(".oneWayOrReturn");var r=k.find(".multipleDestinations");var u=k.find(".section-infants-pref");var l=k.field("numChildren");var g=k.find(".LOBCheckBoxes");var G=k.find(".multipleDestinations .datetime");var x=k.find(".section-flight-age-group");var t=x.field("childrenAge");var B=new publishing.validation.ErrorRenderer(k,k.find("ul.errors"));var m=new publishing.validation.Validator(b,B);var I=k.find("input[name=addHotelPackage]");var f=k.find("input[name=addCarPackage]");if(I&&f){I.click(function(){publishing.wizard.addPackageToFlight(f,I,this);});f.click(function(){publishing.wizard.addPackageToFlight(f,I,this);});}if(v){v.itemClickedEvent=function(L){if(L&&L.On){var K=L.selectedItem;if(K&&K.data&&L.inputId=="F-destination"){publishing.wizard.packageLobData.TLA=K.data.a;publishing.wizard.packageLobData.MultiCity=K.data.amc;}}publishing.wizard.preserveTA(L);tlaSelector.selectedTypeAhead(L.inputId,"hidden-tla-"+L.inputId,L);};}function s(L){if(h.is(":checked")){var K=k.find("div.internationalFlightFieldsContainer").find(".multipleDestinations").field("fromDate");if(z==false){k.triggerDatePicker(K,false);}}else{var M=k.find("div.internationalFlightFieldsContainer").find(".oneWayOrReturn").field("fromDate");if(z==false){k.triggerDatePicker(M,false);}}}publishing.wizard.lobforms.flightOnly_DatesChanged=function(){if(c.is(":checked")){var K=k.find("div.internationalFlightFieldsContainer").find(".oneWayOrReturn").field("toDate");k.triggerDatePicker(K,true);}};k.initLobForm(w,m,y);publishing.wizard.initRoom(x,b,w.errorMessages);publishing.wizard.lobforms.additionalOptions({showAdditionalOptionsField:a,additionalOptionsContainer:J,hideAdditionalOptionsField:o,infoLinkField:p,infoContainer:d});function q(){var K=null;var M=function(){var N=h.is(":checked");r.toggle(N);D.toggle(!N);n.toggle(c.is(":checked"));if(N){A.addClass("hidden");H.removeClass("hidden");D.before(r);publishing.util.preserveValues(r.find("[data-canonic]"));
}else{if(K!=null&&K.value=="Multicity"){r.before(D);publishing.util.preserveValues(D.find("[data-canonic]"));}}if(!N){A.removeClass("hidden");H.addClass("hidden");}B.clearAll();K=e.filter(":checked")[0];};var L=function(){var N=h.is(":checked");r.toggle(N);D.toggle(!N);if(c.is(":checked")){E.removeClass("variable-width");E.addClass("largehalfWidth");$("#flightAndHotelSearch").show();}else{E.removeClass("largehalfWidth");E.addClass("variable-width");$("#flightAndHotelSearch").hide();}n.toggle(c.is(":checked"));g.toggle(c.is(":checked"));if(N){A.addClass("hidden");H.removeClass("hidden");D.before(r);publishing.util.preserveValues(r.find("[data-canonic]"));}else{if(K!=null&&K.value=="Multicity"){r.before(D);publishing.util.preserveValues(D.find("[data-canonic]"));}}if(!N){A.removeClass("hidden");H.addClass("hidden");}B.clearAll();K=e.filter(":checked")[0];};e.bindAndTrigger(L);}q();t.add(l).bindAndTrigger(publishing.wizard.common.flight.accompaniedInfantListener(t,u));if(publishing.wizard.TYPEAHEAD_ENABLED){publishing.wizard.typeahead(k.field("origin"),v,s);publishing.wizard.typeahead(k.field("destination"),v);jQuery("#hidden-tla-F-origin").attr("value",urlHandler.parseAirportCode(jQuery("#F-origin").attr("value"),true));jQuery("#F-origin").bind("change",function(){jQuery("#hidden-tla-F-origin").attr("value","");});jQuery("#hidden-tla-F-destination").attr("value",urlHandler.parseAirportCode(jQuery("#F-destination").attr("value"),true));jQuery("#F-destination").bind("change",function(){jQuery("#hidden-tla-F-destination").attr("value","");});jQuery("#hidden-tla-F-origin-1").attr("value",urlHandler.parseAirportCode(jQuery("#F-origin-1").attr("value"),true));jQuery("#F-origin-1").bind("change",function(){jQuery("#hidden-tla-F-origin-1").attr("value","");});jQuery("#hidden-tla-F-destination-1").attr("value",urlHandler.parseAirportCode(jQuery("#F-destination-1").attr("value"),true));jQuery("#F-destination-1").bind("change",function(){jQuery("#hidden-tla-F-destination-1").attr("value","");});var F=jQuery("#F-origin-1, input[id^=F-fromAirport]").length;for(var C=2;C<=F;C++){publishing.wizard.typeahead(k.field("fromAirport"+C),v);publishing.wizard.typeahead(k.field("toAirport"+C),v);publishing.wizard.lobforms.flightOnly.addChangeListener(C);}}};publishing.wizard.lobforms.flightOnly.stopOverSearch=function(l){var e=$(l).find("[name=TripType][value=RoundTrip]");var p=$(l).find("[name=TripType][value=OneWay]");var m=$(l).find(".stopOverField").field("stopOverFlightType");var a=$(l).find(".stopOverField").find("[name=stopOverDestination]");var c=$(l).find(".oneWayOrReturn").find("[name=FrAirport]");var o=$(l).find(".oneWayOrReturn").find("[name=ToAirport]");var s=$(l).find("input[name=FromDate]");var r=$(l).find("select[name=FromTime]");if(e!=null&&e.is(":checked")){var f=$(l).find("input[name=TripType]");f.val("Multicity");var k=$(l).find("input[name=ToDate]");var h=$(l).find("select[name=ToTime]");if("Outbound"==m.val()){var g=$(l).find(".stopOverField").field("stopOverFromDate");var n=$(l).find(".stopOverField").field("stopOverFromTime");$("<input>").attr({type:"hidden",name:"frAirport2",value:a.val()}).appendTo(l);$("<input>").attr({type:"hidden",name:"toAirport2",value:o.val()}).appendTo(l);$("<input>").attr({type:"hidden",name:"frAirport3",value:o.val()}).appendTo(l);$("<input>").attr({type:"hidden",name:"toAirport3",value:c.val()}).appendTo(l);$("<input>").attr({type:"hidden",name:"Date2",value:g.val()}).appendTo(l);$("<input>").attr({type:"hidden",name:"Time2",value:n.val()}).appendTo(l);$("<input>").attr({type:"hidden",name:"Date3",value:k.val()}).appendTo(l);$("<input>").attr({type:"hidden",name:"Time3",value:h.val()}).appendTo(l);d(o,"");d(a,"ToAirport");d(k,"");d(h,"");}else{var q=$(l).find(".stopOverField").field("stopOverToDate");var b=$(l).find(".stopOverField").field("stopOverToTime");$("<input>").attr({type:"hidden",name:"frAirport2",value:o.val()}).appendTo(l);$("<input>").attr({type:"hidden",name:"toAirport2",value:a.val()}).appendTo(l);$("<input>").attr({type:"hidden",name:"Date2",value:k.val()}).appendTo(l);$("<input>").attr({type:"hidden",name:"Time2",value:h.val()}).appendTo(l);$("<input>").attr({type:"hidden",name:"frAirport3",value:a.val()}).appendTo(l);$("<input>").attr({type:"hidden",name:"toAirport3",value:c.val()}).appendTo(l);$("<input>").attr({type:"hidden",name:"Date3",value:q.val()}).appendTo(l);$("<input>").attr({type:"hidden",name:"Time3",value:b.val()}).appendTo(l);d(k,"");d(h,"");}}else{if(p!=null&&p.is(":checked")){var f=$(l).find("input[name=TripType]");f.val("Multicity");var g=$(l).find(".stopOverField").field("stopOverFromDate");var n=$(l).find(".stopOverField").field("stopOverFromTime");$("<input>").attr({type:"hidden",name:"frAirport2",value:a.val()}).appendTo(l);$("<input>").attr({type:"hidden",name:"toAirport2",value:o.val()}).appendTo(l);$("<input>").attr({type:"hidden",name:"Date2",value:g.val()}).appendTo(l);$("<input>").attr({type:"hidden",name:"Time2",value:n.val()}).appendTo(l);d(o,"");d(a,"ToAirport");}}function d(u,t){u.attr("name",t);}};publishing.wizard.lobforms.flightOnly.jp.allFlights=function(e){var d=$(publishing.WIZARD_CONTAINER_ID+" form.flightOnly");var g=d.find("div.internationalFlightFieldsContainer").find(".multipleDestinations").field("origin");var a=d.find("div.internationalFlightFieldsContainer").find(".multipleDestinations").field("destination");var c=d.find("div.internationalFlightFieldsContainer").find(".oneWayOrReturn").field("origin");var f=d.find("div.internationalFlightFieldsContainer").find(".oneWayOrReturn").field("destination");var b=publishing.wizard.lobforms.flightOnly.jp.validationRules(d.find("div.internationalFlightFieldsContainer"),e);publishing.wizard.lobforms.flightOnly.init(d,e,b);};publishing.wizard.lobforms.flightOnly.allFlights=function(e){var d=$(publishing.WIZARD_CONTAINER_ID+" form.flightOnly");var g=d.find("div.internationalFlightFieldsContainer").find(".multipleDestinations").field("origin");var a=d.find("div.internationalFlightFieldsContainer").find(".multipleDestinations").field("destination");var c=d.find("div.internationalFlightFieldsContainer").find(".oneWayOrReturn").field("origin");var f=d.find("div.internationalFlightFieldsContainer").find(".oneWayOrReturn").field("destination");var b=publishing.wizard.lobforms.flightOnly.validationRules(d.find("div.internationalFlightFieldsContainer"),e);publishing.wizard.lobforms.flightOnly.init(d,e,b);};expNamespace("publishing.wizard.lobforms");publishing.wizard.lobforms.hotelAndCar=function(a){var c=$(publishing.WIZARD_CONTAINER_ID+" form.hotelAndCar");var e=a.errorMessages;var g=a.taConfig;var o=c.field("destination");var n=c.field("fromDate");var f=c.field("toDate");var h=c.find(".rooms .room");var l=h.find(".number-of-travellers");var q=c.find("input[name=addFlightPackage]");var m=c.find("input[name=addHotelPackage]");var p=c.find("input[name=addCarPackage]");publishing.wizard.setUpPackageCheckboxes(q,m,p);if(g){g.itemClickedEvent=function(s){if(s&&s.On){var r=s.selectedItem;if(r&&r.data&&s.inputId=="HC-destination"){publishing.wizard.packageLobData.TLA=r.data.a;publishing.wizard.packageLobData.MultiCity=r.data.amc;}}publishing.wizard.preserveTA(s);};}var k=[new publishing.validation.NotEmpty(o,e.departureCity),new publishing.validation.OptionalDate(n,e.departureDate),new publishing.validation.OptionalDate(f,e.returnDate),new publishing.validation.DateRange(n,f,e.bookingDateRange),new publishing.validation.DatePriorToAllowedDate(n,a.minPurchaseDate,e.departurePriorToCurrentDate),new publishing.validation.DatePriorToAllowedDate(f,a.minPurchaseDate,e.returnPriorToCurrentDate),new publishing.validation.TotalBetween(1,6,l,e.totalNumberOfTravellers)];var d=new publishing.validation.ErrorRenderer(c,c.find("ul.errors"));var b=new publishing.validation.Validator(k,d);c.initLobForm(a,b);publishing.wizard.initRooms(c,h,k,e,a);publishing.wizard.setupPackageRadioButtons(c);publishing.wizard.setUpAddRoomLinks(c);};expNamespace("publishing.wizard.lobforms");
publishing.wizard.lobforms.hotelOnly=function(z){var o=z.errorMessages;var f=$(publishing.WIZARD_CONTAINER_ID+" form.hotelOnly");var H=f.find("#hotelOnly-additionalOptions");var y=z.taConfig;var G=f.find(".rooms .room");var F=f.field("destination");var b=f.field("dest-region");var A=f.field("dest-city");var w=f.field("fromDate");var u=f.field("toDate");var a=f.find("a[name=hotelOnly-showAdditionalOptions]");var q=f.find("a[name=hotelOnly-hideAdditionalOptions]");var e=f.find("input[name='SearchType']");var B=f.find("input[name='SearchArea']");var k=f.find("input[name='storedCheckinField']");var s=f.find("input[name='storedCheckoutField']");var g=$('<input type="hidden" name="CityId"/>');var v=z.datelessSearch!=false?true:false;var t=z.ninePlusRoomsURL;var l=f.field("numRooms");var h;if(v==false){h=f.field("enableDateless");}var n=f.find("input[name=addFlightPackage]");var d=f.find("input[name=addCarPackage]");publishing.wizard.setUpPackageCheckboxes(n,null,d);publishing.wizard.lobforms.hotelOnly_ValidationRules=[new publishing.validation.NotEmpty(F,o.city),new publishing.validation.NotSelect(b,o.city),new publishing.validation.NotSelectCity(b,A,o.city),new publishing.validation.ConditionalDate(v,h,w,o.checkinDate),new publishing.validation.ConditionalDate(v,h,u,o.checkoutDate),new publishing.validation.DatePriorToAllowedDate(w,z.minPurchaseDate,o.checkinPriorToCurrentDate),new publishing.validation.DatePriorToAllowedDate(u,z.minPurchaseDate,o.checkoutPriorToCurrentDate),new publishing.validation.DateRange(w,u,o.bookingDateRange),new publishing.validation.DatesNotToManyDaysAppart(w,u,z.maxDateRange,o.checkInAndOutDatesTooFarApart),new publishing.validation.DatePastMaxPurchaseDate(z.maxPurchaseDate,w,o.datePastMaxDate),new publishing.validation.DatePastMaxPurchaseDate(z.maxPurchaseDate,u,o.datePastMaxDate)];publishing.wizard.setUpAddRoomLinks(f);$("#handle9RoomsLink").click(p);function p(){var I=z.ninePlusRoomsURL;var J=$("#H-destination");if(J.val()!=J.attr("data-default")){I=I+"&City="+encodeURIComponent(J.val());}I=I+"&InDate="+encodeURIComponent(publishing.wizard.formatDateForGroupForm9PlusRoomsService($("#H-fromDate").val()))+"&OutDate="+encodeURIComponent(publishing.wizard.formatDateForGroupForm9PlusRoomsService($("#H-toDate").val()));window.location=I;return true;}if(y){y.itemClickedEvent=function(){var J=TA.getInstance("H-destination");if(J&&J.On){var I=J.selectedItem;if(I&&I.data&&J.inputId=="H-destination"){if(I.data.t=="HOTEL"){publishing.wizard.packageLobData.HotelId=I.data.id;}publishing.wizard.packageLobData.regionId=I.data.id;publishing.wizard.packageLobData.TLA=I.data.a;publishing.wizard.packageLobData.MultiCity=I.data.amc;}}publishing.wizard.preserveTA(J);};}function x(I){if(I!=undefined){B.val(I.type);if(I.hotelId!=null){$("#H-hotelId").val(I.hotelId);$("#H-hotelId").attr("timestamp",new Date().getTime());}}f.triggerDatePicker(w,false);}function c(){if(!publishing.wizard.BIASED_FOR_HOTELS_PER_CITY){return;}f.find("input[name='GOTO']").val("HOTGROUP");B.remove();var J=f.field("destination").val();var I=$.grep(publishing.wizard.hotelsForCities,function(M,L){return M.cityId==J;})[0];var K=[];$.each(I.hotelIds,function(M,L){K.push($('<input type="hidden" name="HotelID'+M+'" value="'+L+'" />'));});K.push($('<input type="hidden" name="GroupName" value="'+I.cityName+'" />'));$.each(K,function(L,M){f.append(M);});}var C={CITY:"CITY",ADDRESS:"ADDRESS"};function r(){var I=$(this).val();switch(I){case (C.CITY):$("#hotelSearchSectionAddress").toggle(false);$("#hotelSearchSectionCity").toggle(true);break;case (C.ADDRESS):$("#hotelSearchSectionCity").toggle(false);$("#hotelSearchSectionAddress").toggle(true);break;}}function E(){if((w.blank()||w.val()==publishing.DATE_FORMAT)&&publishing.util.parseDate(k.val())!=null){w.val(k.val());}if((u.blank()||u.val()==publishing.DATE_FORMAT)&&publishing.util.parseDate(s.val())!=null){u.val(s.val());}}publishing.wizard.lobforms.hotelOnly_DatesChanged=function(){var I=f.find("input[data-canonic='enableDateless']");if(I.length>0){I[0].checked=false;}f.triggerDatePicker(u,true);};z.startDateCalCallback=publishing.wizard.lobforms.hotelOnly_DatesChanged;var D=new publishing.validation.ErrorRenderer(f,f.find("ul.errors"));var m=new publishing.validation.Validator(publishing.wizard.lobforms.hotelOnly_ValidationRules,D);f.initLobForm(z,m,c);if(publishing.wizard.TYPEAHEAD_ENABLED&&!publishing.wizard.BIASED_FOR_HOTELS_PER_CITY){publishing.wizard.typeahead(F,y,x);}publishing.wizard.initRooms(f,G,publishing.wizard.lobforms.hotelOnly_ValidationRules,o,z);publishing.wizard.lobforms.additionalOptions({showAdditionalOptionsField:a,additionalOptionsContainer:H,hideAdditionalOptionsField:q});e.bindAndTrigger(r);E();};publishing.wizard.lobforms.constructRoomPackageInfoUrl=function(){var g="";var f=parseInt($("#FH-NumRoom").val());g+="&numberOfRooms="+f;for(var e=1;e<=f;e++){var d=parseInt($("#FH-NumAdult"+e).val());g+="&adultsPerRoom["+e+"]="+d;var b=parseInt($("#FH-NumChild"+e).val());g+="&childrenPerRoom["+e+"]="+b;for(var c=1;c<=b;c++){var a=parseInt($("#FH-Rm"+e+"Child"+c+"Age").val());g+="&childAges["+e+"]["+c+"]="+a;}g+="&";}return g;};publishing.wizard.lobforms.constructHotelInfoUrl=function(k){var d="chkin="+escape(k["InDate"].value)+"&chkout="+escape(k["OutDate"].value)+"&";var h=parseInt($("#H-NumRoom").val());for(var g=1;g<=h;g++){d+="rm"+g+"=";var e=parseInt($("#H-NumAdult"+g).val());d+="a"+e;var b=parseInt($("#H-NumChild"+g).val());for(var c=1;c<=b;c++){var a=parseInt($("#H-Rm"+g+"Child"+c+"Age").val());d+=":c"+a;}d+="&";}return d;};publishing.wizard.lobforms.hotelOnly.constructHotelInfoUrl=function(b){var a="chkin="+escape(b["InDate"].value)+"&chkout="+escape(b["OutDate"].value)+"&";a+=publishing.wizard.lobforms.constructHotelInfoUrl(b);return a;};publishing.wizard.lobforms.hotelOnly.constructFlightAndHotelInfoUrl=function(b){var a="packageType=2&origin="+escape(b["FrAirport"].value)+"&ttla="+publishing.wizard.packageLobData.TLA+"&fromDate="+escape(b["FromDate"].value)+"&toDate="+escape(b["ToDate"].value)+"&";a+=publishing.wizard.lobforms.constructRoomPackageInfoUrl();return a;};publishing.wizard.lobforms.hotelOnly.gotoHotelInfo=function(d,c){if($("#H-hotelId").val()!=""&&$("#H-NumRoom").val()!=9){var a=["/h",$("#H-hotelId").val(),".Hotel-Information?",publishing.wizard.lobforms.hotelOnly.constructHotelInfoUrl(d)];var b=a.join("");window.location=b;return true;}return false;};publishing.wizard.lobforms.hotelOnly.gotoPackageInfo=function(d,c){if(publishing.wizard.packageLobData.HotelId){var a=["/h",$("#H-hotelId").val(),".Hotel-Information?",publishing.wizard.lobforms.hotelOnly.constructFlightAndHotelInfoUrl(d)];var b=a.join("");window.location=b;return true;}return false;};publishing.wizard.lobforms.hotelOnly.handleNinePlusRooms=function(g,e){if($("#H-NumRoom").val()==9){var a=e.ninePlusRoomsURL;var c=[["City","PlaceName"],["InDate","InDate"],["OutDate","OutDate"]];for(var b=0;b<c.length;b++){var d=c[b];if(d[0]=="InDate"||d[0]=="OutDate"){a=a+"&"+d[0]+"="+encodeURIComponent(publishing.wizard.formatDateForGroupForm9PlusRoomsService(g[d[1]].value));}else{a=a+"&"+d[0]+"="+encodeURIComponent(g[d[1]].value);}}window.location=a;return true;}return false;};expNamespace("publishing.wizard.lobforms");expNamespace("publishing.wizard.lobforms.flightOnly");publishing.wizard.lobforms.flightOnly.InternationalFlightForm=function(){this.container=function(){return $(publishing.WIZARD_CONTAINER_ID+" form.flightOnly");};this.defaultFlightType=function(){return"International";};this.flightFieldsContainer=function(){return this.container().find("div.internationalFlightFieldsContainer");};};publishing.wizard.lobforms.flightOnly.DomesticFlightForm=function(){this.container=function(){return $(publishing.WIZARD_CONTAINER_ID+" form.domesticFlightOnly");};this.defaultFlightType=function(){return"Domestic";};this.flightFieldsContainer=function(){return this.container().find("div.domesticFlightFieldsContainer");};};publishing.wizard.lobforms.flightOnly.internationalFlights=function(a){publishing.wizard.lobforms.flightOnly.initializeForIndiaSite(new publishing.wizard.lobforms.flightOnly.InternationalFlightForm(),new publishing.wizard.lobforms.flightOnly.DomesticFlightForm(),a);
};publishing.wizard.lobforms.flightOnly.submitFormTarget=null;publishing.wizard.lobforms.flightOnly.setSubmitFormTarget=function(a){publishing.wizard.lobforms.flightOnly.submitFormTarget=a;};publishing.wizard.lobforms.flightOnly.searchFlightAndHotel=function(){var d=$(publishing.WIZARD_CONTAINER_ID+" form.flightOnly");var c=$(publishing.WIZARD_CONTAINER_ID+" form.flightAndHotel");d.find(":input").filter(":visible").each(function(){var e=$(this).attr("data-canonic");if(e&&e!="childrenAge"&&c.field(e)){c.field(e).val($(this).val());if($(this).is("select")&&"FrAirport"==$(this).attr("name")){c.field(e).trigger("change");}}});if($("#jpFLPFltPkgSearchFlag").length>0){if(c.find("select[name=FrAirport]").length>0){c.find("select[name=FrAirport]").attr("name","");}if(c.find("select[name=DestName]").length>0){c.find("select[name=DestName]").attr("name","");}}if(d.field("numChildren").val()>0){for(i=1;i<=d.field("numChildren").val();i++){c.find("select[name=Rm1Child"+i+"Age]").val(d.find("select[name=Age"+i+"]").val());}}if(c.find("[data-canonic=fromDate]").val()==c.find("[data-canonic=toDate]").val()){var a=c.find("[data-canonic=toDate]");var b=a.datepicker("getDate","+1d");b.setDate(b.getDate()+1);a.datepicker("setDate",b);}c.find("[data-canonic=flexibleFromDate]").remove();c.find("[data-canonic=flexibleToDate]").remove();};publishing.wizard.lobforms.flightOnly.domesticFlightsOnly=function(a){var m=new publishing.wizard.lobforms.flightOnly.DomesticFlightForm();var l=m.container();function b(q,p){return"&"+q+"="+p;}function d(p){var q=l.field(p).filter(":visible");if(q.length==0){return"";}return q[0].value;}function g(q,p){return b(q,d(p));}function k(q){var p=parseInt(q);if(p==362){return"0";}else{if(p<241){return"1";}else{if(p<481){return"2";}else{if(p<721){return"3";}else{if(p<961){return"4";}else{if(p<1201){return"5";}else{return 6;}}}}}}}function o(q,p){return b(q,k(d(p)));}function h(){var s=0;var t=0;var r=l.field("numChildren").val();for(var q=1;q<=parseInt(r);q++){var p=l.find("select[name=Age"+q+"]").filter(":visible")[0].value;if(parseInt(p)<2){s++;}else{t++;}}return b("childs",t)+b("infants",s);}function f(){var p="";switch(n()){case"Multicity":p=b("multicity","true");break;case"OneWay":p=b("rnd_one","O");break;case"RoundTrip":p=b("rnd_one","R");break;}return p;}function n(){return l.find("input[name=TripType]").filter(":checked")[0].value;}function c(){var q=n();if(q=="Multicity"){var p=g("from1","origin")+g("depart_date_1","date1")+o("dpt_time_1","fromTime")+g("to1","destination");var u=g("from2","fromAirport2")+g("depart_date_2","date2")+o("dpt_time_2","time2")+g("to2","toAirport2");var t=g("from3","fromAirport3")+g("depart_date_3","date3")+o("dpt_time_3","time3")+g("to3","toAirport3");var s=g("from4","fromAirport4")+g("depart_date_4","date4")+o("dpt_time_4","time4")+g("to4","toAirport4");var r=g("from5","fromAirport5")+g("depart_date_5","date5")+o("dpt_time_5","time5")+g("to5","toAirport5");return p+u+t+s+r;}else{return g("from","origin")+g("depart_date","fromDate")+o("dep_time","fromTime")+g("to","destination")+g("return_date","toDate")+o("ret_time","toTime");}}this.onSuccessHandler=function(){var q=g("adults","numAdults");var p=g("class","cabinClass");var r=g("carrier","airlinePreference");var s=a.domesticFlightFormUrl+f()+c()+q+h()+p+r;l.attr("action",s);};this.onSuccessHandlerForIndiaSite=function(){var s=parseInt(d("numAdults"))+parseInt(d("numSeniors"));var q=b("adults",s);var p=g("class","cabinClass");var r=g("carrier","airlinePreference");var t=a.domesticFlightFormUrl+f()+c()+q+h()+p+r;l.attr("action",t);};function e(){l.find(".section-infants-pref").html("");}publishing.wizard.lobforms.flightOnly.initializeForIndiaSite(m,new publishing.wizard.lobforms.flightOnly.InternationalFlightForm(),a,this.onSuccessHandlerForIndiaSite);e();};publishing.wizard.lobforms.flightOnly.initializeForIndiaSite=function(n,e,b,f){var l=n.container();var a=e.container();var h=l.find("select[name=flightType]");var k=a.find("select[name=flightType]");var c=new publishing.validation.ErrorRenderer(l,l.find("ul.errors"));var g=publishing.wizard.lobforms.flightOnly.validationRules(n.flightFieldsContainer(),b);publishing.wizard.lobforms.flightOnly.init(l,b,g,f);function d(){l.toggle(h.val()==n.defaultFlightType());a.toggle(h.val()==e.defaultFlightType());k.val(e.defaultFlightType());c.clearAll();m(l,a);}function m(p,o){if(p.is(":visible")){o.before(p);}if(o.is(":visible")){p.before(o);}}h.bindAndTrigger(d);};expNamespace("publishing.wizard.lobforms");publishing.wizard.lobforms.ukThreePP=function(f){var g=f.errorMessages;var e=$(publishing.WIZARD_CONTAINER_ID+" form.threePP");var d=e.find("input[name=FromDate]");var a=d.val();var b=[new publishing.validation.OptionalDate(d,g.departureDate),new publishing.validation.DatePriorToAllowedDate(d,f.minPurchaseDate,g.departurePriorToCurrentDate),new publishing.validation.DateIsLessOrEqual(f.maxPurchaseDate,d,g.datePastMaxDate)];var h=new publishing.validation.ErrorRenderer(e,e.find("ul.errors"));var c=new publishing.validation.Validator(b,h);this.onSuccess=function(){if(a==d.val()){d.val("");}};e.initLobForm(f,c,this.onSuccess);};publishing.wizard.lobforms.deThreePP=function(c){var b=$(publishing.WIZARD_CONTAINER_ID+" form."+c.form);var a=b.find("input[name=termin]");var d=b.find("input[name=ruecktermin]");b.initLobForm(c,undefined);};publishing.wizard.lobforms.atThreePP=function(c){var b=$(publishing.WIZARD_CONTAINER_ID+" form."+c.form);var a=b.find("input[name=termin]");var d=b.find("input[name=ruecktermin]");b.initLobForm(c,undefined);};publishing.wizard.lobforms.frThreePP=function(a){var b=$(publishing.WIZARD_CONTAINER_ID+" form.threePP");var e=b.find("input[name=termin]");var d=b.find("input[name=personen]");var k=b.find("select[id=threePP-Adults]");var c=b.find("select[id=threePP-ChildAge1]");var g=b.find("select[id=threePP-ChildAge2]");var l=b.find("select[id=threePP-ChildAge3]");var m=c.val();var h=e.val();function f(n){var o=n.val();return o==m?"":";"+o;}this.onSuccess=function(){var n=h==e.val()?publishing.util.formattedDate("dd.mm.yyyy",0,new Date()):e.val().replace(/\//g,".");e.val(n);d.val(k.val()+f(c)+f(g)+f(l));};b.initLobForm(a,undefined,this.onSuccess);};publishing.wizard.lobforms.itThreePP=function(a){var l=a.errorMessages;var d=$(publishing.WIZARD_CONTAINER_ID+" form.threePP");var f=d.find("input[name=depDateFrom]");var k=d.find("input[name=depDateTo]");var m=d.find("select[name=depFrom]");var n=m.val();var h=[new publishing.validation.OptionalDate(f,l.fromDate),new publishing.validation.DatePriorToAllowedDate(f,a.minPurchaseDate,l.fromPriorToCurrentDate),new publishing.validation.OptionalDate(k,l.toDate),new publishing.validation.DatePriorToAllowedDate(k,a.minPurchaseDate,l.toPriorToCurrentDate)];var g=new publishing.validation.ErrorRenderer(d,d.find("ul.errors"));var b=new publishing.validation.Validator(h,g);function c(o){return o.val()!=n;}function e(p,q){var o=c(p)?p.val():publishing.util.formattedDate("dd/mm/yyyy",q,new Date());return p.attr("name")+"="+o+"&";}this.onSuccess=function(){var r=e(f,0);var p=e(k,60);var q="";if(m.blank()){q=a.formActionWithNoDepartFrom.replace("formParameters",r+p);}else{var o="depFrom="+m.val()+"&";q=a.formActionWithDepartFrom.replace("formParameters",o+r+p);}d.attr("action",q);};d.initLobForm(a,b,this.onSuccess);};publishing.wizard.lobforms.caThreePP=function(a){var f=a.errorMessages;var d=$(publishing.WIZARD_CONTAINER_ID+" form.threePP");var b=d.find("select[name=fcy]"),h=d.find("input[name=fdt]"),l=d.find(".traveller-details"),k=d.find("select[data-canonic=childrenAge]");var g=[new publishing.validation.NotEmpty(b,f.mandatory),new publishing.validation.MandatoryDate(h,f.departureDate),new publishing.validation.DatePriorToAllowedDate(h,a.minPurchaseDate,f.departureDatePriorToCurrentDate),new publishing.validation.ChildrenAgeRequired(k,f.childrenAge)];var e=new publishing.validation.ErrorRenderer(d,d.find("ul.errors"));var c=new publishing.validation.Validator(g,e);
d.initLobForm(a,c);publishing.wizard.initRoom(l,g,a.errorMessages);};publishing.validation.ChildrenAgeRequired=function(a,b){this.apply=function(){var f=[];var e=a.filter(":visible");if(e.length>0){for(var d=0;d<e.length;d++){if(parseInt(e[d].value)<0||parseInt(e[d].value)>17){f.push(e[d]);}}}if(f.length==0){return new publishing.validation.Result(true);}else{var c=new publishing.validation.Error(f,b);return new publishing.validation.Result(false,c);}};return this;};publishing.wizard.typeahead=function(e,c,b){function a(h,f){var g={};g.serviceRequestMask=f.serviceRequestMask;g.id=h;g.On=f.On;g.MinChar=f.MinChar;g.MaxItems=f.MaxItems;g.Path=f.Path;g.lob=f.lob;g.Locale=f.Locale;g.abTest=f.abTest;g.version=f.version;g.closeText=f.closeText;g.contiueText=f.contiueText;g.itemClickedEvent=f.itemClickedEvent;g.trigger=b;g.category=f.category;g.dest=f.dest;TA.setup(g);TA.init(h);}if(window["TA"]){if(e.length>0&&c!=undefined){for(var d=0;d<e.length;d++){if(e[d].nodeName.toUpperCase()=="INPUT"&&e[d].getAttribute("type")=="text"){a(e[d].id,c);}}}}};publishing.wizard.lobforms.vacationPackage=function(){var b=$(publishing.WIZARD_CONTAINER_ID+" div.lobForm-vacationPackage");var d=$(publishing.WIZARD_CONTAINER_ID+" form.vacationPackage");var a=d.find("select[name=PackageType]");function c(){var e=a.val();var g=b.find("div.packageType:visible");if(g.hasClass("packageType-"+e)){return;}var f=b.find("div.packageType-"+e);g.hide();f.show();}a.bindAndTrigger(c);};publishing.wizard.preserveTA=function(b){var c=$("#"+b.inputId);var a=publishing.wizard.canonicName(c);publishing.wizard.canonicFieldValues[a]=c.val();};publishing.wizard.recentlyViewedHotels=function(f){var a=$(publishing.WIZARD_CONTAINER_ID+" form.hotelOnly");var m=a.find("#rvFieldset");var n=a.find("#rvSelect");var g=$("input[data-canonic='destination']");var e=$("input[data-canonic='fromDate']");var o=$("input[data-canonic='toDate']");var d=a.find(".rooms .room");var c=a.field("numRooms");var p=function(q){return function(){var r=$(this).val();g.val(q[r].city);g.change();e.val(q[r].checkInDate);e.change();o.val(q[r].checkOutDate);o.change();c.val(q[r].travelerUnits.length);c.change();for(i in q[r].travelerUnits){var v=$(d[i]).field("numAdults");var t=$(d[i]).field("numChildren");var u=$(d[i]).field("childrenAge");v.val(q[r].travelerUnits[i].numberOfAdults);t.val(q[r].travelerUnits[i].childAges.length);t.change();for(num in q[r].travelerUnits[i].childAges){var s=$(u[num]);s.val(q[r].travelerUnits[i].childAges[num]);}}$("#mcicid").val("Hotel.LP.RVSelect");};};function b(q,r){if(q==null||r==null){return false;}else{if(q.city.indexOf(r.city)==-1){return false;}else{if(q.checkInDate.indexOf(r.checkInDate)==-1){return false;}else{if(q.checkOutDate.indexOf(r.checkOutDate)==-1){return false;}}}}return true;}function h(s){var q=false;if(s.length>1){for(i in s){for(var r=parseInt(i)+1;r<s.length;r++){if(b(s[i],s[r])){s[r]=null;q=true;}}}}if(q){var t=new Array();var r=0;for(i in s){if(s[i]!=null){t[r]=s[i];r++;}}return t;}return s;}function k(r){var q="";for(i in r){q+='<option value="'+i+'">'+r[i].city+" "+r[i].checkInDateView+r[i].checkOutDateView+"</option>";}n.append(q);}function l(q){var r=h(q);if(r!=null&&r.length>1){k(r);m.show();n.change(p(r));}}l(f);};publishing.wizard.recentlySearchedPackages=function(b){var a=$(publishing.WIZARD_CONTAINER_ID+" form.flightAndHotel");var f=a.find("#rspField");var g=a.find("#rspSelect");var s=a.field("origin");var u=a.field("destination");var d=a.field("fromDate");var n=a.field("toDate");var e=a.field("partialHotelBooking");var o=a.field("flexibleFromDate");var h=a.field("flexibleToDate");var t=a.find(".rooms .room");var c=a.field("numRooms");var m=a.find(".section-partial-hotel-booking-date");var k=a.find(".section-infants-pref");var p=a.field("infantSeatPreference");var q=function(v){return function(){var x=$(this).val();s.val(v[x].originCity);s.change();u.val(v[x].destinationCity);u.change();d.val(v[x].departureDate);d.change();n.val(v[x].returnDate);n.change();if(v[x].checkInDate!=""&&v[x].checkOutDate!=""){e.attr("checked",true);m.show();o.val(v[x].checkInDate);h.val(v[x].checkOutDate);}else{e.attr("checked",false);m.hide();o.val("mm/dd/yy");h.val("mm/dd/yy");}e.unbind();e.bind("click",function(){if(this.checked==true){m.show();}else{m.hide();}});c.val(v[x].travelerUnits.length);c.change();var w=false;var B=false;for(i in v[x].travelerUnits){var D=$(t[i]).field("numAdults");var z=$(t[i]).field("numSeniors");var A=$(t[i]).field("numChildren");var C=$(t[i]).field("childrenAge");if(v[x].travelerUnits[i].infantsInSeats){w=true;}D.val(v[x].travelerUnits[i].numberOfAdults);z.val(v[x].travelerUnits[i].numberOfSeniors);A.val(v[x].travelerUnits[i].childAges.length);A.change();for(num in v[x].travelerUnits[i].childAges){var y=$(C[num]);y.val(v[x].travelerUnits[i].childAges[num]);y.change();if(v[x].travelerUnits[i].childAges[num]==0){B=true;}}}if(B){k.show();if(p&&p.length>1){if(w){p[1].checked=true;}else{p[0].checked=true;}}}else{k.hide();}$("#mcicid").val("PKG.LP.RVSelect");};};function l(v){rsOptions="";for(i in v){rsOptions+='<option value="'+i+'">'+v[i].originCityView+"-"+v[i].destinationCityView+" "+v[i].departureDateView+v[i].returnDateView+"</option>";}g.append(rsOptions);}function r(v){if(v!=null&&v.length>0){l(v);f.show();g.change(q(v));}}r(b);};var s_prop34="";publishing.wizard.setABValue=function(c,a){var b=c+"_"+a;if(s_prop34==""){s_prop34=b;}else{if(s_prop34.indexOf(b)==(-1)){s_prop34=s_prop34+"|"+b;}}};publishing.wizard.fillCheckInDateAuto=function(b,a){b.click(function(){if(a.fillCheckInDateAutoFieldPrefix!=null&&a.fillCheckInDateAutoFieldPrefix!="undefined"){if($(this).attr("checked")=="checked"){$("#"+a.fillCheckInDateAutoFieldPrefix+"-flexibleFromDate").val($("#"+a.fillCheckInDateAutoFieldPrefix+"-fromDate").val());}}});};}
/*!  generated on 2014-06-05 19:01:23.280 PDT(-0700) in 110 ms  */

/*!  served in 0 ms  */
